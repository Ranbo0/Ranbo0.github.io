[{"title":"仙剑奇侠传五代码分析（一） -- 恢复/辅助类物品","url":"/2022/01/08/PAL5/","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><h1 id=\"物品回血回蓝\">物品回血回蓝</h1>\r\n<figure class=\"highlight lua\"><table><tr><td class=\"code\"><pre><span class=\"line\">id = player.GetTargetPlayer() <span class=\"comment\">-- 获取角色id</span></span><br><span class=\"line\">player.ChangeHP(arg1, arg2, id, val) <span class=\"comment\">-- 回血</span></span><br><span class=\"line\">player.ChangeMP(arg1, arg2, id, val) <span class=\"comment\">-- 回蓝</span></span><br><span class=\"line\"><span class=\"comment\">-- arg1: 恢复类型；1: 按比例恢复 0: 按数值恢复</span></span><br><span class=\"line\"><span class=\"comment\">-- arg2: 恢复范围；1: 全体恢复   0: 单体恢复</span></span><br><span class=\"line\"><span class=\"comment\">-- val: 恢复量</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- WARNING: 不要设置arg1/arg2为01以外的其他值，否则可能会造成未定义行为</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 例1：</span></span><br><span class=\"line\">player.ChangeHP(<span class=\"number\">0</span>, <span class=\"number\">0</span>, id, <span class=\"number\">300</span>) <span class=\"comment\">-- 单体回复300点血</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 例2：</span></span><br><span class=\"line\">player.ChangeMP(<span class=\"number\">0</span>, <span class=\"number\">1</span>, id, <span class=\"number\">20</span>)  <span class=\"comment\">-- 全体回复20点蓝</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 例3：</span></span><br><span class=\"line\">player.ChangeHP(<span class=\"number\">1</span>, <span class=\"number\">1</span>, id, <span class=\"number\">-25</span>) <span class=\"comment\">-- 全体受到生命上限20%的伤害</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- WARINING: 在伤害型物品中，最好不要对敌人产生减蓝的操作</span></span><br><span class=\"line\"><span class=\"comment\">-- 因为PAL5/PAL5前传不像PAL4一样敌人有蓝，要对敌人产生减蓝可能产生未定义行为</span></span><br><span class=\"line\"><span class=\"comment\">-- 在修改代码时，务必考虑清楚该代码产生的行为是否可以使游戏保持一致性</span></span><br></pre></td></tr></table></figure>\r\n<span id=\"more\"></span>\r\n<h1 id=\"物品移除状态\">物品移除状态</h1>\r\n<figure class=\"highlight lua\"><table><tr><td class=\"code\"><pre><span class=\"line\">id = player.GetTargetPlayer() <span class=\"comment\">-- 获取角色id</span></span><br><span class=\"line\">player.RemoveStat(<span class=\"built_in\">arg</span>, id, stat) <span class=\"comment\">-- 移除状态</span></span><br><span class=\"line\"><span class=\"comment\">-- arg: 恢复范围；1: 全体恢复   0: 单体恢复</span></span><br><span class=\"line\"><span class=\"comment\">-- stat: 状态</span></span><br><span class=\"line\">    <span class=\"comment\">-- 0. 冻结; 1. 中毒; 2. 混乱; 3. 脱力; 4. 沉默;</span></span><br><span class=\"line\">    <span class=\"comment\">-- 5. 昏睡; 6. 异变; 7. 麻痹; 8. 消极; 9. 污浊。</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- WARNING: 不要设置stat为0-9以外的其他值，否则可能会造成未定义行为</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 例1：</span></span><br><span class=\"line\">player.RemoveStat(<span class=\"number\">0</span>, id, <span class=\"number\">0</span>) <span class=\"comment\">-- 单体解除冻结状态</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 例2：</span></span><br><span class=\"line\">player.RemoveStat(<span class=\"number\">1</span>, id, <span class=\"number\">3</span>) <span class=\"comment\">-- 全体解除脱力状态</span></span><br></pre></td></tr></table></figure>\r\n<h1 id=\"复活\">复活</h1>\r\n<figure class=\"highlight lua\"><table><tr><td class=\"code\"><pre><span class=\"line\">id = player.GetTargetPlayer() <span class=\"comment\">-- 获取角色id</span></span><br><span class=\"line\">player.Relive(id) <span class=\"comment\">-- 复活</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- WARNING: 使用player的Relive方法时必须恢复一定的血量，否则会造成未知错误</span></span><br><span class=\"line\"><span class=\"comment\">-- 本人没有试过会出现什么错误，但是复活后保持0血量肯定是未定义（非法）状态</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 例1：</span></span><br><span class=\"line\"><span class=\"comment\">-- 选定角色复活，并保持300点血量</span></span><br><span class=\"line\">player.Relive(id)</span><br><span class=\"line\">player.ChangeHP(<span class=\"number\">0</span>, <span class=\"number\">0</span>, id, <span class=\"number\">300</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 例2：</span></span><br><span class=\"line\"><span class=\"comment\">-- 选定角色复活，并恢复所有角色所有生命值</span></span><br><span class=\"line\">player.Relive(id)</span><br><span class=\"line\">player.ChangeHP(<span class=\"number\">1</span>, <span class=\"number\">1</span>, id, <span class=\"number\">100</span>)</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"回气\">回气</h1>\r\n<figure class=\"highlight lua\"><table><tr><td class=\"code\"><pre><span class=\"line\">id = player.GetTargetPlayer() <span class=\"comment\">-- 获取角色id</span></span><br><span class=\"line\">player.ChangeDP(<span class=\"built_in\">arg</span>, id, val) <span class=\"comment\">-- 回气</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- arg: 恢复范围；1: 全体恢复   0: 单体恢复</span></span><br><span class=\"line\"><span class=\"comment\">-- val: 恢复量</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 例1：</span></span><br><span class=\"line\">player.ChangeDP(<span class=\"number\">0</span>, id, <span class=\"number\">20</span>) <span class=\"comment\">-- 单体恢复20点气</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 例2：</span></span><br><span class=\"line\">player.ChangeDP(<span class=\"number\">0</span>, id, <span class=\"number\">-100</span>) <span class=\"comment\">-- 单体气清空</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- WARINING: 在伤害型物品中，最好不要对敌人产生减气的操作</span></span><br><span class=\"line\"><span class=\"comment\">-- 因为PAL5/PAL5前传不像PAL4一样敌人有气，要对敌人产生减蓝可能产生未定义行为</span></span><br></pre></td></tr></table></figure>\r\n<h1 id=\"永久增加属性\">永久增加属性</h1>\r\n<figure class=\"highlight lua\"><table><tr><td class=\"code\"><pre><span class=\"line\">id = player.GetTargetPlayer() <span class=\"comment\">-- 获取角色id</span></span><br><span class=\"line\">player.AddProperty(id, prop, val) <span class=\"comment\">-- 增加指定属性</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- prop: 增加的属性种类</span></span><br><span class=\"line\">    <span class=\"comment\">-- 1. 力; 2. 体; 3. 速; 4. 术; 5. 运</span></span><br><span class=\"line\"><span class=\"comment\">-- val: 增量</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 例1:</span></span><br><span class=\"line\">player.AddProperty(id, <span class=\"number\">1</span>, <span class=\"number\">1</span>) <span class=\"comment\">-- 增加1点力</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 例2:</span></span><br><span class=\"line\">player.AddProperty(id, <span class=\"number\">1</span>, <span class=\"number\">-5</span>) <span class=\"comment\">-- 减少5点力</span></span><br></pre></td></tr></table></figure>\r\n<h1 id=\"添加状态\">添加状态</h1>\r\n<h2 id=\"添加基础状态\">添加基础状态</h2>\r\n<figure class=\"highlight lua\"><table><tr><td class=\"code\"><pre><span class=\"line\">id = player.GetTargetPlayer() <span class=\"comment\">-- 获取角色id</span></span><br><span class=\"line\">player.AddStat(<span class=\"built_in\">arg</span>, id, pro, stat, turns) <span class=\"comment\">-- 添加状态</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- arg: 使用范围；1: 全体   0: 单体</span></span><br><span class=\"line\"><span class=\"comment\">-- pro: 添加状态成功率</span></span><br><span class=\"line\"><span class=\"comment\">-- stat: 状态</span></span><br><span class=\"line\">    <span class=\"comment\">-- 10: 强袭; 11: 坚盾; 12: 神行; 13: 法障</span></span><br><span class=\"line\"><span class=\"comment\">-- turns: 状态保持回合数</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- WARNING: 不要设置turns/pro为负值，否则可能会造成未定义行为</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 例1:</span></span><br><span class=\"line\">player.AddStat(<span class=\"number\">0</span>, id, <span class=\"number\">100</span>, <span class=\"number\">10</span>, <span class=\"number\">5</span>) <span class=\"comment\">-- 单体施加强袭状态5回合</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 例2：</span></span><br><span class=\"line\">player.AddStat(<span class=\"number\">0</span>, id, <span class=\"number\">50</span>, <span class=\"number\">10</span>, <span class=\"number\">1</span>) <span class=\"comment\">-- 单体施加强袭状态1回合，50%失手</span></span><br></pre></td></tr></table></figure>\r\n<h2 id=\"添加屏类状态\">添加屏类状态</h2>\r\n<figure class=\"highlight lua\"><table><tr><td class=\"code\"><pre><span class=\"line\">id = player.GetTargetPlayer() <span class=\"comment\">-- 获取角色id</span></span><br><span class=\"line\">player.AddStat(<span class=\"built_in\">arg</span>, id, pro, stat, turns) <span class=\"comment\">-- 添加状态</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- arg: 使用范围；1: 全体   0: 单体</span></span><br><span class=\"line\"><span class=\"comment\">-- pro: 添加状态成功率</span></span><br><span class=\"line\"><span class=\"comment\">-- stat: 状态</span></span><br><span class=\"line\">    <span class=\"comment\">-- 14: 火屏; 15: 水屏; 16: 雷屏; 17: 土屏; 18: 风屏</span></span><br><span class=\"line\"><span class=\"comment\">-- turns: 状态保持回合数</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 使用方法同上</span></span><br></pre></td></tr></table></figure>\r\n<h2 id=\"添加高级状态\">添加高级状态</h2>\r\n<figure class=\"highlight lua\"><table><tr><td class=\"code\"><pre><span class=\"line\">id = player.GetTargetPlayer() <span class=\"comment\">-- 获取角色id</span></span><br><span class=\"line\">player.AddStat(<span class=\"built_in\">arg</span>, id, pro, stat, turns) <span class=\"comment\">-- 添加状态</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- arg: 使用范围；1: 全体   0: 单体</span></span><br><span class=\"line\"><span class=\"comment\">-- pro: 添加状态成功率</span></span><br><span class=\"line\"><span class=\"comment\">-- stat: 状态</span></span><br><span class=\"line\">    <span class=\"comment\">-- 28: 隐形; 36: 武爆; 37: 魔免</span></span><br><span class=\"line\"><span class=\"comment\">-- turns: 状态保持回合数</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 使用方法同上</span></span><br></pre></td></tr></table></figure>\r\n","categories":["PAL"],"tags":["PAL"]},{"title":"my first blog","url":"/2021/11/09/first%20blog/","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><p>我的第一个博客。</p>\r\n<span id=\"more\"></span>\r\n<p>一些帮助链接：</p>\r\n<p><a href=\"https://hexo.io/\">Hexo</a></p>\r\n<p><a href=\"https://hexo.io/docs/\">documentation</a></p>\r\n<p><a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a></p>\r\n<p><a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a></p>\r\n<h2 id=\"quick-start\">Quick Start</h2>\r\n<h3 id=\"create-a-new-post\">Create a new post</h3>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>\r\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\r\n<h3 id=\"run-server\">Run server</h3>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\r\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\r\n<h3 id=\"generate-static-files\">Generate static files</h3>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\r\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\r\n<h3 id=\"deploy-to-remote-sites\">Deploy to remote sites</h3>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\r\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\r\n","tags":["test"]},{"title":"用github搭建博客巨无敌详细教程","url":"/2021/11/09/blog/","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><h1 id=\"一-环境准备\">一、 环境准备</h1>\r\n<h2 id=\"git\">1. <code>git</code></h2>\r\n<p><span class=\"math inline\">\\(\\text{link:}\\)</span></p>\r\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">https://git-scm.com/</span><br></pre></td></tr></table></figure>\r\n<span id=\"more\"></span>\r\n<h2 id=\"node\">2. <code>node</code></h2>\r\n<p><span class=\"math inline\">\\(\\text{link: }\\)</span></p>\r\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">https://nodejs.org/en/download/</span><br></pre></td></tr></table></figure>\r\n<p>安装完成后输入 <code>node -v</code></p>\r\n<p><img src=\"2.png\" /></p>\r\n<p>输出版本号就安装完成了。</p>\r\n<h2 id=\"hexo\">3. <code>hexo</code></h2>\r\n<p><code>npm install hexo -g</code></p>\r\n<p>安装完成后输入 <code>hexo -v</code></p>\r\n<p><img src=\"1.png\" /></p>\r\n<p>输出 <code>hexo</code> 以及 <code>hexo</code> 的部分依赖的版本号即安装完成。</p>\r\n<p>安装 <code>hexo</code> 依赖：</p>\r\n<p><code>npm install --save hexo-deployer-git</code></p>\r\n<h1 id=\"二-配置-ssh-key-可选\">二、 配置 <code>ssh-key</code> （可选）</h1>\r\n<h2 id=\"配置-ssh\">1. 配置 <code>ssh</code></h2>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C &lt;your-email-address&gt;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"添加-ssh-key\">2. 添加 <code>ssh-key</code></h2>\r\n<p>在 <code>github</code> 主页，在左侧的 <code>SSH and GPG keys</code> 中，新建 <code>SSH-key</code>，自定义一个标题，将 <code>id_rsa.pub</code> 复制的内容粘贴到 <code>key</code> 中即可。</p>\r\n<figure>\r\n<img src=\"3.png\" alt=\"pic3\" /><figcaption aria-hidden=\"true\">pic3</figcaption>\r\n</figure>\r\n<h2 id=\"配置账号和密码\">3. 配置账号和密码</h2>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">git config --global user.name &lt;your-user-name&gt;</span><br><span class=\"line\">$ git config --global user.email &lt;your-email-address&gt;</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"三-搭建博客\">三、 搭建博客</h1>\r\n<h2 id=\"在-github-新建仓库\">1. 在 <code>github</code> 新建仓库</h2>\r\n<p><img src=\"4.png\" /></p>\r\n<p>仓库名称格式： <code>用户名.github.io</code></p>\r\n<p>例如我的用户名是 <code>Ranbo0</code>，那么我的仓库名就要设置成 <code>Ranbo0.github.io</code></p>\r\n<p><img src=\"5.png\" /></p>\r\n<p>因为我已经创建过了，所以这里显示已存在。</p>\r\n<h2 id=\"修改配置文件\">2. 修改配置文件</h2>\r\n<p>在 <code>hexo</code> 根目录下有个配置文件 <code>_config.yml</code> ，修改其中的 <code>deploy</code> ，表示每次更新博客时上传的仓库。</p>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">deploy:</span><br><span class=\"line\">  <span class=\"built_in\">type</span>: git</span><br><span class=\"line\">  repository: git@github.com:Ranbo0/Ranbo0.github.io.git</span><br><span class=\"line\">  branch: main</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"6.png\" /></p>\r\n<p>其中 <code>repository</code> 和 <code>branch</code> 根据自己的仓库设置。</p>\r\n<h2 id=\"hexo-基本命令\">3. <code>hexo</code> 基本命令</h2>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">hexo new <span class=\"string\">&quot;&lt;blog-name&gt;&quot;</span> <span class=\"comment\">#新建文章</span></span><br><span class=\"line\">hexo new page <span class=\"string\">&quot;&lt;page-name&gt;&quot;</span> <span class=\"comment\">#新建页面</span></span><br><span class=\"line\">hexo generate <span class=\"comment\">#生成静态页面至public目录</span></span><br><span class=\"line\">hexo g <span class=\"comment\">#生成静态页面至public目录</span></span><br><span class=\"line\">hexo server <span class=\"comment\">#开启预览访问端口（默认端口4000，&#x27;ctrl + c&#x27;关闭server）</span></span><br><span class=\"line\">hexo s <span class=\"comment\">#开启预览访问端口（默认端口4000，&#x27;ctrl + c&#x27;关闭server）</span></span><br><span class=\"line\">hexo deploy <span class=\"comment\">#部署到GitHub</span></span><br><span class=\"line\">hexo d <span class=\"comment\">#部署到GitHub</span></span><br><span class=\"line\">hexo <span class=\"built_in\">help</span>  <span class=\"comment\"># 查看帮助</span></span><br><span class=\"line\">hexo h  <span class=\"comment\"># 查看帮助</span></span><br><span class=\"line\">hexo version  <span class=\"comment\">#查看Hexo的版本</span></span><br><span class=\"line\">hexo v  <span class=\"comment\">#查看Hexo的版本</span></span><br></pre></td></tr></table></figure>\r\n<h2 id=\"创建第一篇博客\">4. 创建第一篇博客</h2>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">hexo new <span class=\"string\">&quot;my first blog&quot;</span></span><br></pre></td></tr></table></figure>\r\n<p><img src=\"8.png\" /></p>\r\n<p>然后会在 <code>source/_posts</code> 下创建一个名为 <code>my-first-blog.md</code> 的文件，修改该文件后即可将文件上传到自己的博客上了。</p>\r\n<p><img src=\"9.png\" /></p>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">hexo g</span><br><span class=\"line\">hexo s</span><br></pre></td></tr></table></figure>\r\n<p><img src=\"7.png\" /></p>\r\n<p>其中的 <code>http://localhost:4000</code> 是预览页面，可以在达到自己的效果之后再提交到 <code>github</code> 上。</p>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">hexo d</span><br></pre></td></tr></table></figure>\r\n<p>每次提交之前可以先 <code>hexo clean</code> ，然后再执行 <code>hexo g</code> 和 <code>hexo d</code> 。</p>\r\n<p><img src=\"10.png\" /></p>\r\n<p>如图所示，即成功上传。</p>\r\n<ul>\r\n<li><p>当执行 <code>hexo d</code> 时出现 <code>ERROR Deployer not found: git</code> 的报错信息时，再次安装<code>hexo-deployer-git</code>：</p>\r\n<figure class=\"highlight sh\"><table><tr><td class=\"code\"><pre><span class=\"line\">npm install --save hexo-deployer-git</span><br></pre></td></tr></table></figure></li>\r\n</ul>\r\n<p>以上即是搭建自己的博客的教程。</p>\r\n<hr />\r\n<p>下面介绍如何渲染自己的博客。首先要安装 <code>nexT</code> ：</p>\r\n<h1 id=\"四-安装主题\">四、 安装主题</h1>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/theme-next/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"五-启用主题及相关配置\">五、 启用主题及相关配置</h1>\r\n<h2 id=\"启用主题\">1. 启用主题</h2>\r\n<p>打开 <code>hexo</code> 的 <code>_config.yml</code> 文件，找到 <code>theme</code> 字段，并将其值更改为 <code>next</code>。</p>\r\n<p><img src=\"11.png\" /></p>\r\n<h2 id=\"验证主题安装成功\">2. 验证主题安装成功</h2>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">hexo s --debug</span><br></pre></td></tr></table></figure>\r\n<p>此时即可使用浏览器访问 <code>http://localhost:4000</code>，检查站点是否正确运行。</p>\r\n<p>若此时的界面与未安装 <code>next</code> 时的界面相同，或者全部是纯文本则表示主题安装失败，需要重新安装。</p>\r\n<h2 id=\"主题设置\">3. 主题设置</h2>\r\n<p><code>Scheme</code> 是 <code>NexT</code>提供的一种特性，借助于 <code>Scheme</code>，<code>NexT</code>为你提供多种不同的外观。同时，几乎所有的配置都可以 在 <code>Scheme</code>之间共用。目前 <code>NexT</code>支持三种 <code>Scheme</code>，分别是：</p>\r\n<ul>\r\n<li><code>Muse</code>- 默认 <code>Scheme</code>，这是 <code>NexT</code>最初的版本，黑白主调，大量留白</li>\r\n<li><code>Mist</code> - <code>Muse</code>的紧凑版本，整洁有序的单栏外观</li>\r\n<li><code>Pisces</code> - 双栏 <code>Scheme</code></li>\r\n<li><code>Gemini</code> - 分栏</li>\r\n</ul>\r\n<p>要修改主题，打开 <code>nexT</code> 中的 <code>_config.yml</code> 文件，找到 <code>Schemes</code> ，将想要设置的主题取消注释即可。</p>\r\n<p><img src=\"12.png\" /></p>\r\n<h2 id=\"设置语言\">4. 设置语言</h2>\r\n<p>打开 <code>hexo</code> 的 <code>_config.yml</code> 文件，找到 <code>language</code> 字段，修改为 <code>zh-CN</code> 即为简体中文， <code>zh-hk</code> 即为繁体中文， <code>en</code> 为英文等。</p>\r\n<h2 id=\"其他\">5. 其他</h2>\r\n<p>其他的设置可以根据<a href=\"http://theme-next.iissnan.com/getting-started.html\">开始使用 - NexT 使用文档 (iissnan.com)</a> 进行。</p>\r\n","tags":["教程"]},{"title":"JErasure库的相关介绍","url":"/2021/11/10/galois/","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><p>JErasure库提供一般的RS码和CRS码两种编码方式，是基于C的纠删码的类库。</p>\r\n<span id=\"more\"></span>\r\n<h1 id=\"一galois-field\">一、Galois Field</h1>\r\n<h2 id=\"一基本概念\">（一）基本概念</h2>\r\n<h3 id=\"域field\">1.1.1 域（field）</h3>\r\n<p>域代表一组元素和元素间的四则运算的集合。其中，域内元素的四则运算必须满足封闭性，也就是说域内元素进行四则运算后得到的结果仍为域内元素。</p>\r\n<h3 id=\"有限域finite-field\">1.1.2 有限域（finite field）</h3>\r\n<p>有限域即为仅含有有限个元素的域。有限域又称作伽罗华域(Galois Field)。记为<span class=\"math inline\">\\(GF\\)</span>。例如，<span class=\"math inline\">\\(GF(7)\\)</span>的元素为0~6.</p>\r\n<p>有限域中必须含有加法单位元和乘法单位元。加法单位元即域中的<strong>零元</strong>，即存在元素<span class=\"math inline\">\\(e\\)</span>，使得域中任一元素<span class=\"math inline\">\\(a\\)</span>，有<span class=\"math inline\">\\(e+a = a\\)</span>。乘法单位元即域中的<strong>幺元</strong>，即存在元素e，使得域中任一元素<span class=\"math inline\">\\(a\\)</span>，有<span class=\"math inline\">\\(e*a = a\\)</span>。<span class=\"math inline\">\\(GF(p)\\)</span>的加法单位元和乘法单位元分别为0和1.</p>\r\n<p>此外，有限域中的每个元素还应有对应的逆元。乘法逆元与我们常见的倒数类似。即存在元素b，使得<span class=\"math inline\">\\(b*a = e\\)</span>，则<span class=\"math inline\">\\(b\\)</span>为<span class=\"math inline\">\\(a\\)</span>的乘法逆元。其中<span class=\"math inline\">\\(e\\)</span>为乘法单位元。加法逆元与我们常见的相反数类似。即存在元素<span class=\"math inline\">\\(b\\)</span>，使得<span class=\"math inline\">\\(b+a = e\\)</span>，则<span class=\"math inline\">\\(b\\)</span>为<span class=\"math inline\">\\(a\\)</span>的加法逆元。其中<span class=\"math inline\">\\(e\\)</span>为加法单位元。</p>\r\n<p>有限域中的减法和除法即为加法和乘法的逆过程。<span class=\"math inline\">\\(GF(p)\\)</span>的加法和乘法与实数域内的加法和乘法相似，只不过最后要模<span class=\"math inline\">\\(p\\)</span>。即<span class=\"math inline\">\\(GF(a+b) = (a+b) \\mod p， GF(a×b) = (a×b) \\mod p\\)</span>。</p>\r\n<p>一般而言，<span class=\"math inline\">\\(p\\)</span>应为质数，因为如果<span class=\"math inline\">\\(p\\)</span>非质数，则可能有一些元素找不到乘法逆元。例如<span class=\"math inline\">\\(GF(9)\\)</span>中，元素3找不到<span class=\"math inline\">\\(GF(9)\\)</span>中的一个元素<span class=\"math inline\">\\(a\\)</span>使<span class=\"math inline\">\\(3\\times a \\mod p = 1\\)</span>，即3没有乘法逆元。</p>\r\n<h2 id=\"二gf2w\">（二）<span class=\"math inline\">\\(GF(2^w)\\)</span></h2>\r\n<h3 id=\"gf2w\">1.2.1 <span class=\"math inline\">\\(GF(2^w)\\)</span></h3>\r\n<p><span class=\"math inline\">\\(GF(2^w)\\)</span>上的加法运算和乘法运算不使用一般的加法和乘法，而是使用多项式的计算。</p>\r\n<h3 id=\"多项式计算\">1.2.2 多项式计算</h3>\r\n<p><span class=\"math inline\">\\(GF(2^w)\\)</span>上的多项式计算中，多项式的系数为1或0，即只能取<span class=\"math inline\">\\(GF(2)\\)</span>上的元素；当进行加法运算时，合并同类项时，不是一般的系数相加，而是进行异或计算，且加法和减法的操作一致。例如： <span class=\"math display\">\\[\r\n(x^3+x^2)+(x^4+x^2)=x^4+x^3\r\n\\]</span></p>\r\n<p><span class=\"math inline\">\\(GF(2^w)\\)</span>上的多项式的最高次不超过<span class=\"math inline\">\\(w\\)</span>。例如，在<span class=\"math inline\">\\(GF(2^3)\\)</span>中，<span class=\"math inline\">\\(f_1(x)=x^2+1\\)</span>为<span class=\"math inline\">\\(GF(2^3)\\)</span>的多项式，<span class=\"math inline\">\\(f_2(x)=x^3+x^2+1\\)</span>则不是<span class=\"math inline\">\\(GF(2^3)\\)</span>的多项式。</p>\r\n<p>但是，多项式的加法计算后的结果一定仍为域中多项式，而对于多项式乘法，若直接按一般的多项式乘法计算的计算结果则可能不再是域中的多项式。与<span class=\"math inline\">\\(GF(p)\\)</span>类似，需要找到一个多项式对其取模，使之仍然为域中多项式。因此，提出本原多项式的概念。</p>\r\n<h3 id=\"本原多项式质多项式textprimitive-polynomial\">1.2.3 本原多项式/质多项式(<span class=\"math inline\">\\(\\text{primitive polynomial}\\)</span>)</h3>\r\n<p>质多项式与质数的概念类似，质多项式即为不能表示成除幺元对应的多项式与该多项式以外的其他多项式的乘积，即<strong>不能再进行因式分解的多项式</strong>。例如，在<span class=\"math inline\">\\(GF(2^4)\\)</span>中，<span class=\"math inline\">\\(f(x) = x^4 + 1\\)</span>不是<span class=\"math inline\">\\(GF(2^4)\\)</span>上的质多项式，因为<span class=\"math inline\">\\(f(x) = (x^2 + 1) × (x^2 + 1)\\)</span>。<span class=\"math inline\">\\(g(x) = x^4 + x + 1\\)</span>是<span class=\"math inline\">\\(GF(2^4)\\)</span>上的质多项式，因为它不可再分解。</p>\r\n<p>以<span class=\"math inline\">\\(GF(2^3)\\)</span>为例，指数小于3的多项式一共有8个，分别是<span class=\"math inline\">\\(0，1，x，x+1，x^2，x^2+1，x^2+x，x^2+x+1\\)</span>，一共有8个多项式。其对应的系数分别可以表示为<code>000</code>，<code>001</code>，<code>010</code>，<code>011</code>，<code>100</code>，<code>101</code>，<code>110</code>，<code>111</code>，若用十进制表示，则正好为<code>0</code>，<code>1</code>，<code>2</code>，<code>3</code>，<code>4</code>，<code>5</code>，<code>6</code>，<code>7</code>。这说明0~7与8个多项式之间有着必然的映射关系，每个多项式会对应一个值。对于<span class=\"math inline\">\\(GF(2^3)\\)</span>，取素多项式<span class=\"math inline\">\\(f(x) = x^3+x+1\\)</span>，则<span class=\"math inline\">\\(x+1\\)</span>的乘法逆元为<span class=\"math inline\">\\(x^2+x\\)</span>，因为<span class=\"math inline\">\\(((x+1) × (x^2+x) mod (x^3+x+1) = 1)\\)</span>，也就是说即使<span class=\"math inline\">\\(\\mod 8\\)</span>不能构成一个有限域，但是由质多项式仍然可以为域中每个元素找到一个乘法逆元。 此时，多项式的乘法即可得到解决。例如，在<span class=\"math inline\">\\(GF(2^3)\\)</span>内： <span class=\"math display\">\\[\r\nx\\times (x^2+1)=x\\times (x^2+1)\\mod (x^3+x+1)=(x^3+x)\\mod (x^3+x+1)=1\r\n\\]</span></p>\r\n<p>对于多项式除法，根据<span class=\"math display\">\\[r(x) = q(x)t(x) + s(x)\\]</span>，其中<span class=\"math inline\">\\(r(x),q(x),t(x),s(x)\\)</span>均为<span class=\"math inline\">\\(GF(2^w)\\)</span>上的多项式，<span class=\"math inline\">\\(q(x)\\)</span>表示<span class=\"math inline\">\\(GF(2^w)\\)</span>上的质多项式。易知<span class=\"math inline\">\\(r(x) \\mod q(x) = s(x)\\)</span>，且显然有<span class=\"math inline\">\\(dim\\ s(x) &lt; dim\\ q(x)\\)</span>。（<span class=\"math inline\">\\(dim\\ f(x)\\)</span>表示的是<span class=\"math inline\">\\(f(x)\\)</span>的最高次的次数）。</p>\r\n<p>根据上述理论，即可根据质多项式来得到<span class=\"math inline\">\\(GF(2^w)\\)</span>的所有元素。<span class=\"math inline\">\\(GF(2^w)\\)</span>中元素的生成过程如下：</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1.</span> 给定一个初始集合&#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, x&#125;;</span><br><span class=\"line\"><span class=\"number\">2.</span> 将这个集合的最后一个元素乘以x。如果得到的结果的度(dim) ≥ w，则将结果 <span class=\"function\">mod <span class=\"title\">q</span><span class=\"params\">(x)</span>，将结果加入集合中</span>;</span><br><span class=\"line\"><span class=\"number\">3.</span> 重复<span class=\"number\">2</span>，直到集合中有<span class=\"number\">2</span>^w个元素。此时最后的一个元素乘以x再 <span class=\"function\">mod <span class=\"title\">q</span><span class=\"params\">(x)</span>的值必定为1.</span></span><br></pre></td></tr></table></figure>\r\n<p>举个栗子： <span class=\"math inline\">\\(w = 2\\)</span>时，<span class=\"math inline\">\\(q(x) = x^2 + x + 1\\)</span>，初始集合为<span class=\"math inline\">\\(\\{0, 1, x\\}\\)</span>，</p>\r\n<p>最后一个元素为<span class=\"math inline\">\\(x\\)</span>，乘以<span class=\"math inline\">\\(x\\)</span>后为<span class=\"math inline\">\\(x^2\\)</span>，<span class=\"math inline\">\\(dim\\ (x^2) = 2\\)</span>，因此要对<span class=\"math inline\">\\(q(x)\\)</span>取模，得<span class=\"math inline\">\\((x^2) \\mod (x^2 + x + 1) = x + 1\\)</span>；此时集合更新为<span class=\"math inline\">\\(\\{0, 1, x, x+1\\}\\)</span>；</p>\r\n<p>再将最后一个元素乘以<span class=\"math inline\">\\(x\\)</span>，为<span class=\"math inline\">\\(x^2 + x\\)</span>,仍需要对<span class=\"math inline\">\\(q(x)\\)</span>取模，得<span class=\"math inline\">\\((x^2 + x) mod (x^2 + x + 1) = 1\\)</span>,结束上述过程。即<span class=\"math inline\">\\(GF(2^2) = \\{0, 1, x, x+1\\}\\)</span>。</p>\r\n<p>也就是说，只需要找到对应<span class=\"math inline\">\\(GF(2^w)\\)</span>上的本原多项式<span class=\"math inline\">\\(q(x)\\)</span>即可通过<span class=\"math inline\">\\(x\\)</span>代换得到<span class=\"math inline\">\\(GF(2^w)\\)</span>，即： <span class=\"math display\">\\[\r\nGF(2^w) = GF(2)[x]/q(x)\r\n\\]</span></p>\r\n<p>常用的本原多项式有：</p>\r\n<pre><code>w = 4:   x^4 + x + 1\r\nw = 8:   x^8 + x^4 + x^3 + x^2 + 1\r\nw = 16:  x^16 + x^12 + x^3 + x + 1\r\nw = 32:  x^32 + x^22 + x^2 + x + 1\r\nw = 64:  x^64 + x^4 + x^3 + x + 1</code></pre>\r\n<p>例如，<span class=\"math inline\">\\(GF(2^4)\\)</span>的元素生成：(<span class=\"math inline\">\\(P(x) = x^4 + x + 1\\)</span>) <img src=\"https://img-blog.csdnimg.cn/20201113002057855.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjg2ODg0OQ==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"GF(2^4)的元素生成过程\" /></p>\r\n<p>由上述计算结果，可以构建以下两个表（正表和反表)：</p>\r\n<table>\r\n<thead>\r\n<tr class=\"header\">\r\n<th style=\"text-align: center;\"><strong>i</strong></th>\r\n<th style=\"text-align: center;\"><strong>0</strong></th>\r\n<th style=\"text-align: center;\"><strong>1</strong></th>\r\n<th style=\"text-align: center;\"><strong>2</strong></th>\r\n<th style=\"text-align: center;\"><strong>3</strong></th>\r\n<th style=\"text-align: center;\"><strong>4</strong></th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n<tr class=\"odd\">\r\n<td style=\"text-align: center;\">gflog[i]</td>\r\n<td style=\"text-align: center;\">-</td>\r\n<td style=\"text-align: center;\">0</td>\r\n<td style=\"text-align: center;\">1</td>\r\n<td style=\"text-align: center;\">4</td>\r\n<td style=\"text-align: center;\">2</td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td style=\"text-align: center;\">gfilog[i]</td>\r\n<td style=\"text-align: center;\">1</td>\r\n<td style=\"text-align: center;\">2</td>\r\n<td style=\"text-align: center;\">4</td>\r\n<td style=\"text-align: center;\">8</td>\r\n<td style=\"text-align: center;\">3</td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td style=\"text-align: center;\"><strong>5</strong></td>\r\n<td style=\"text-align: center;\"><strong>6</strong></td>\r\n<td style=\"text-align: center;\"><strong>7</strong></td>\r\n<td style=\"text-align: center;\"><strong>8</strong></td>\r\n<td style=\"text-align: center;\"><strong>9</strong></td>\r\n<td style=\"text-align: center;\"><strong>10</strong></td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td style=\"text-align: center;\">8</td>\r\n<td style=\"text-align: center;\">5</td>\r\n<td style=\"text-align: center;\">10</td>\r\n<td style=\"text-align: center;\">3</td>\r\n<td style=\"text-align: center;\">14</td>\r\n<td style=\"text-align: center;\">9</td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td style=\"text-align: center;\">6</td>\r\n<td style=\"text-align: center;\">12</td>\r\n<td style=\"text-align: center;\">11</td>\r\n<td style=\"text-align: center;\">5</td>\r\n<td style=\"text-align: center;\">19</td>\r\n<td style=\"text-align: center;\">7</td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td style=\"text-align: center;\"><strong>11</strong></td>\r\n<td style=\"text-align: center;\"><strong>12</strong></td>\r\n<td style=\"text-align: center;\"><strong>13</strong></td>\r\n<td style=\"text-align: center;\"><strong>14</strong></td>\r\n<td style=\"text-align: center;\"><strong>15</strong></td>\r\n<td style=\"text-align: center;\"></td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td style=\"text-align: center;\">7</td>\r\n<td style=\"text-align: center;\">6</td>\r\n<td style=\"text-align: center;\">13</td>\r\n<td style=\"text-align: center;\">11</td>\r\n<td style=\"text-align: center;\">12</td>\r\n<td style=\"text-align: center;\"></td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td style=\"text-align: center;\">14</td>\r\n<td style=\"text-align: center;\">15</td>\r\n<td style=\"text-align: center;\">13</td>\r\n<td style=\"text-align: center;\">9</td>\r\n<td style=\"text-align: center;\">-</td>\r\n<td style=\"text-align: center;\"></td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>其中，<code>gflog[i]</code>表（反表）是将二进制映射成多项式，例如将5映射成多项式，即<span class=\"math inline\">\\(gflog[5] = 8\\)</span>,即<span class=\"math inline\">\\(x^8 = 5\\)</span>；<code>gfilog[i]</code>表（正表）是将多项式映射成二进制(值),例如将5(即<span class=\"math inline\">\\(x^5\\)</span>)映射成值，即<span class=\"math inline\">\\(gfilog[5] = 6\\)</span>,即<span class=\"math inline\">\\(x^5 = 6\\)</span>.</p>\r\n<p>对于乘法和除法，可以由如下方式进行： <span class=\"math display\">\\[\r\nx^a\\times x^b=x^{a+b};\\\\\r\nx^a/x^b=x^{a-b}.\r\n\\]</span></p>\r\n<p>因此，我们在计算可以<span class=\"math inline\">\\(a×b\\)</span>时，可以先得到<span class=\"math inline\">\\(a = x^m, b = x^n\\)</span>; 则<span class=\"math inline\">\\(a\\times b = x^{m + n}, a/b = x^{m - n}\\)</span>.</p>\r\n<p>即：先将<span class=\"math inline\">\\(a，b\\)</span>查找反表（gflog[i]）得到<span class=\"math inline\">\\(m，n\\)</span>；计算<span class=\"math inline\">\\(m + n\\)</span>或者<span class=\"math inline\">\\(m - n\\)</span>，然后基于结果查找正表（gfilog[i]）得到乘法和除法的结果。需要注意的是，在计算<span class=\"math inline\">\\(m + n\\)</span>和<span class=\"math inline\">\\(m - n\\)</span>时，若结果大于等于15或小于0，则需要对15(<span class=\"math inline\">\\(2^w - 1\\)</span>)取模。因为0是单独存在的，在<span class=\"math inline\">\\(GF(2^w)\\)</span>中没有哪个元素的任意次方等于0.</p>\r\n<p>再举个栗子：</p>\r\n<p>7 × 9 = gfilog[gflog[7] + gflog[9]] = gfilog[10 + 14] = gfilog[9] = 10</p>\r\n<p>(<span class=\"math inline\">\\(7 × 9 = x^{10} × x^{14} = x^{10 + 14} = x^{24 \\mod 15} = x^9 = 10\\)</span>)</p>\r\n<p>13 / 11 = gfilog[gflog[13] - gflog[11]] = gfilog[13 - 7] = gfilog[6] = 12</p>\r\n<p>(<span class=\"math inline\">\\(13 / 11 = x^{13} / x^7 = x^{13-7} = x^6 = 12\\)</span>)</p>\r\n<p>因此，构造正反表之后，可以大大简化乘法和除法的计算，可以直接通过加法和查表得到结果，而不需要再进行繁琐的取模等运算。</p>\r\n<h1 id=\"二crs码\">二、CRS码</h1>\r\n<h2 id=\"一rs码简介\">（一）RS码简介</h2>\r\n<p>介绍CRS码之前先要弄明白RS码是什么。RS码就是Reed-Solomon码，是一种<strong>MDS码</strong>。编码时将k个数据块通过一定方式编码成m个校验块，我一般把它写成<strong>RS(k, m)</strong>，<strong>最多可以容忍m个数据块失效</strong>。解码时通过m个幸存块来恢复所有的数据块。那么RS码是通过什么方式来编码和解码的呢？ RS码通过构造生成矩阵来编码数据块。前k×k为单位阵，后m×k为生成矩阵。编码过程即为生成矩阵与数据块进行矩阵的乘法，即得到k个数据块和m个校验块。 <img src=\"https://img-blog.csdnimg.cn/20201113104722746.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjg2ODg0OQ==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"Encoding\" /> 当有<strong>不多于m个块失效</strong>时，为了恢复数据块，则取出k个幸存块对应的生成矩阵的行构成一个矩阵，对该矩阵的逆与对应的幸存块相乘即可恢复出数据块。 例如，数据块<span class=\"math inline\">\\(D_2，D_3\\)</span>和校验块<span class=\"math inline\">\\(P_1\\)</span>丢失，取出k个幸存块对应的生成矩阵的行，例如取出<span class=\"math inline\">\\(D_1，D_4， ...，D_k，P_2，P_3\\)</span>，一共<span class=\"math inline\">\\(k\\)</span>个数据块，有： <img src=\"https://img-blog.csdnimg.cn/2020111310581920.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjg2ODg0OQ==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"Decoding_1\" /> 再将左边的子矩阵的逆乘到右侧，即有： <img src=\"https://img-blog.csdnimg.cn/20201113110151141.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjg2ODg0OQ==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"Decoding_2\" /> 此时，所有的数据块就被恢复出来了。再要恢复校验块，很简单，再进行一次编码操作即可得到所有正确的校验块了。 然后问题来了，RS码的编解码步骤已经清楚了，现在就只有一个待解决的问题了，那就是得找到一个合适的生成矩阵，使得该生成矩阵的任意k行都线性无关，也就是说任意k行组成的矩阵的行列式不为0，此时即可保证任意k行组成的子矩阵必定可逆。因此，在RS码中，我们一般采用 <strong>范德蒙德矩阵（Vandermonde Matrix）</strong> 作为生成矩阵，此时该矩阵的任意k行组成的子矩阵一定可逆。 用范德蒙德矩阵进行编码的时间复杂度为<code>O(mk)</code>，解码的时间复杂度为<code>O(k^3)</code>。 在利用范德蒙德矩阵编码的时候，我们可以采用对数/反对数表的方法将乘法运算转换成加法运算，并且在迦罗华域中，加法运算转换成了XOR运算。 显然，这种方法要比直接复制副本存储的空间开销小得多，但是解码时花费的时间有点多了。所以，基于Reed-Solomon码，又有另一种纠删码被提出 -- <strong>Cauchy Reed-Solomon Code</strong>。</p>\r\n<h2 id=\"二crs-code简介\">（二）CRS Code简介</h2>\r\n<h3 id=\"cauchy-matrix\">2.2.1 Cauchy Matrix</h3>\r\n<p>Cauchy矩阵是由两个交集为空的集合构成的矩阵。具体为：</p>\r\n<p>令C = [c<sub>ij</sub>]<sub>m<span class=\"math inline\">\\(\\times\\)</span>n</sub>，有集合X = {<span class=\"math inline\">\\(x_1, x_2, \\cdots, x_m\\)</span>}，Y = {<span class=\"math inline\">\\(y_1, y_2, \\cdots, y_n\\)</span>}，且X∩Y = ∅。矩阵C中的元素<span class=\"math inline\">\\(c_{ij}\\)</span>满足 <span class=\"math display\">\\[\r\nc_{ij} = \\frac{1}{x_i + y_j}\r\n\\]</span> 则矩阵C为Cauchy矩阵。</p>\r\n<p>Cauchy矩阵有一个很重要的性质，即Cauchy矩阵的任意一个子方阵必定可逆。且求逆的时间复杂度为O(<span class=\"math inline\">\\(n^2\\)</span>)，<span class=\"math inline\">\\(n\\)</span>为子方阵的维数。 例如，对于<span class=\"math inline\">\\(X = \\{1, 2\\}\\)</span>，<span class=\"math inline\">\\(Y = \\{0, 3, 4, 5, 6\\}\\)</span>，其编解码过程如下： <img src=\"https://img-blog.csdnimg.cn/20201113112600996.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjg2ODg0OQ==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"Cauchy matrix‘s encoding and decoding\" /> 从编解码过程来看，柯西编解码最大的运算量是乘法和加法运算。柯西编解码为了降低乘法复杂度，采用了有限域上的元素都可以使用二进制矩阵表示的原理，将乘法运算和加法运算转换成了迦罗华域“<strong>与运算</strong>”和“<strong>XOR逻辑运算</strong>”，提高了编解码效率。</p>\r\n<p>从数学的角度来看，在迦罗华有限域中，任何一个GF(<span class=\"math inline\">\\(2^w\\)</span>)域上的元素都可以映射到GF(2)二进制域，并且采用一个二进制矩阵的方式表示GF（<span class=\"math inline\">\\(2^w\\)</span>）中的元素。例如，GF（<span class=\"math inline\">\\(2^3\\)</span>）域中的元素可以表示成GF（2）域中的二进制矩阵： <img src=\"https://img-blog.csdnimg.cn/20201113113320150.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjg2ODg0OQ==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"GF(2^3) to GF(2)\" /> 其中，<span class=\"math inline\">\\(M(e)\\)</span>的第<span class=\"math inline\">\\(i\\)</span>列为<span class=\"math inline\">\\(V(e * 2^{i-1})\\)</span>.其中<span class=\"math inline\">\\(e*2^{i-1}\\)</span>为<span class=\"math inline\">\\(GF(2^3)\\)</span>上的乘法。通过以上规则，可以得到： <span class=\"math display\">\\[\r\nM(e_1) * V(e_2) = V(e_1e_2)，\\\\ M(e_1) * M(e_2) = M(e_1e_2) \\\\ \r\n\\]</span> . 举个栗子：</p>\r\n<p><img src=\"https://img-blog.csdnimg.cn/20201113113607895.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjg2ODg0OQ==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"GF(2^3)的乘法转化为GF(2)的乘法\" /> 根据上述理论，将Cauchy matrix的每个元素(<span class=\"math inline\">\\(e\\)</span>)全部替换成<span class=\"math inline\">\\(M(e)\\)</span>，以此替换即可将计算从<span class=\"math inline\">\\(GF(2^w)\\)</span>上的计算变为<span class=\"math inline\">\\(GF(2)\\)</span>的计算(位运算)。为了可以使两矩阵能进行乘法计算，将每个数据块并没有划分为<span class=\"math inline\">\\(2^w\\)</span>大小，而是划分为<span class=\"math inline\">\\(w\\)</span>，即将每个数据块分为<span class=\"math inline\">\\(w\\)</span>块。例如，对前文所述的Cauchy matrix和<span class=\"math inline\">\\(GF(2^3)\\)</span>，有： <img src=\"https://img-blog.csdnimg.cn/2020111311384323.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjg2ODg0OQ==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"convert Cauchy matrix to bitmatrix\" /> ### 2.2.2 相关证明 上述结论可以证明。证明过程如下：</p>\r\n<p>令<span class=\"math inline\">\\(P(x)\\)</span>为<span class=\"math inline\">\\(GF(2)[x]\\)</span>中的<span class=\"math inline\">\\(L\\)</span>次本原多项式。由前文介绍的Galois Field中的理论，可以得知<span class=\"math inline\">\\(GF(2^L)\\)</span>中的元素可以由<span class=\"math inline\">\\(f(x) = \\sum_{i = 0}^{L-1}f_ix^i\\)</span>表出，其中<span class=\"math inline\">\\(f_i\\in GF(2)\\)</span>。记列向量<span class=\"math display\">\\[(f_1, f_2, \\cdots, f_{L-1})\\]</span>为<span class=\"math inline\">\\(f(x)\\)</span>的系数向量（coefficient vector）。</p>\r\n<p>对属于<span class=\"math inline\">\\(GF(2^L)\\)</span>的任意多项式<span class=\"math inline\">\\(f(x)\\)</span>，令<span class=\"math inline\">\\(\\tau(f)\\)</span>为系数向量的矩阵，其中<span class=\"math inline\">\\(\\tau(f)\\)</span>的第<span class=\"math inline\">\\(i\\)</span>列为<span class=\"math display\">\\[x^{i-1}f(x) \\pmod {P(x)}\\]</span>的系数向量。 根据以上定义，有以下引理：</p>\r\n<p>（1）<span class=\"math inline\">\\(\\tau(0)\\)</span>是零矩阵；</p>\r\n<p>（2）<span class=\"math inline\">\\(\\tau(1)\\)</span>是单位矩阵；</p>\r\n<p>（3）<span class=\"math inline\">\\(\\tau\\)</span>是单射；</p>\r\n<p>（4）<span class=\"math inline\">\\(\\tau(f) + \\tau(g) = \\tau(f+g)\\)</span>；<span class=\"math inline\">\\(f\\)</span>和<span class=\"math inline\">\\(g\\)</span>是<span class=\"math inline\">\\(GF(2^L)\\)</span>的多项式；</p>\r\n<p>（5）<span class=\"math inline\">\\(\\tau(f)\\tau(g) = \\tau(fg)\\)</span>；<span class=\"math inline\">\\(f\\)</span>和<span class=\"math inline\">\\(g\\)</span>是<span class=\"math inline\">\\(GF(2^L)\\)</span>的多项式</p>\r\n<p>其中(1)到(3)很容易证明，这里只证明(4)和(5): <span class=\"math display\">\\[\r\nx^i(f+g) = x^if + x^ig \\pmod {P(x)}\r\n\\]</span> 其中<span class=\"math inline\">\\(x^i(f + g)\\)</span>表示以<span class=\"math inline\">\\(\\tau(f + g)\\)</span>的第<span class=\"math inline\">\\(i\\)</span>列为系数的多项式，<span class=\"math inline\">\\(x^if\\)</span>和<span class=\"math inline\">\\(x^ig\\)</span>表示以<span class=\"math inline\">\\(\\tau(f)\\)</span>和<span class=\"math inline\">\\(\\tau(g)\\)</span>的第<span class=\"math inline\">\\(i\\)</span>列为系数的多项式。显然，(4)得证。 令<span class=\"math inline\">\\(f^{(i)}\\)</span>表示<span class=\"math inline\">\\(\\tau(f)\\)</span>的第<span class=\"math inline\">\\(i\\)</span>列; 令<span class=\"math inline\">\\(\\{g_0^{(j)}, g_1^{(j)}, \\cdots, g_{L-1}^{(j)}\\}^T\\)</span>为<span class=\"math inline\">\\(\\tau(g)\\)</span>的第<span class=\"math inline\">\\(j\\)</span>列。则有： <span class=\"math display\">\\[\r\n\\sum_{i=0}^{L-1}g_i^{(j)}x^i = x^{j-1}g \\mod p(x)\r\n\\]</span> (其中<span class=\"math inline\">\\(p(x)\\)</span>为<span class=\"math inline\">\\(GF(2^L)\\)</span>上的质多项式，<span class=\"math inline\">\\(g = g_0^{(1)}+g_1^{(1)}x + g_2^{(1)}x^2 + \\cdots + g_{L-1}^{(1)}x^{L-1}\\)</span>)</p>\r\n<p>因<span class=\"math inline\">\\(\\tau(f)\\tau(g)\\)</span>的第<span class=\"math inline\">\\(j\\)</span>列为： <span class=\"math display\">\\[\r\n\\begin{bmatrix}\r\nf^{(1)} &amp; f^{(2)} &amp; \\cdots &amp; f^{(L)}\r\n\\end{bmatrix}\r\n\\begin{bmatrix}\r\n\\cdots &amp; g_0^{(j)} &amp; \\cdots \\\\\r\n\\cdots &amp; g_1^{(j)} &amp; \\cdots \\\\\r\n\\vdots &amp; \\vdots &amp; \\vdots \\\\\r\n\\cdots &amp; g_{L-1}^{(j)} &amp; \\cdots \\\\\r\n\\end{bmatrix}\r\n\\]</span> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n &amp;= g_0^{(j)}f^{(1)}+g_1^{(j)}f^{(2)}+ \\cdots +g_{L-1}^{(j)}f^{(L)}\\\\\r\n&amp;= \\sum_{i=0}^{L-1}g_i^{(j)}f^{(i+1)}\r\n\\end{aligned}\r\n\\]</span></p>\r\n<p>这就是下面这个的多项式的系数向量： <span class=\"math display\">\\[\r\n\\sum_{i=0}^{L-1}g_i^{(j)}(x^if) = f\\sum_{i=0}^{L-1}g_i^{(j)}x^i = x^{j-1}fg \\mod p(x)\r\n\\]</span> 即：<span class=\"math inline\">\\(\\tau(f)\\tau(g)\\)</span>的第j列与<span class=\"math inline\">\\(\\tau(fg)\\)</span>的第j列相同</p>\r\n<p>即：<span class=\"math inline\">\\(\\tau(f)\\tau(g)=\\tau(fg)\\)</span></p>\r\n<p>也就是说，将<span class=\"math inline\">\\(GF(2^w)\\)</span>映射成<span class=\"math inline\">\\(\\tau(GF(2^w))\\)</span>后，仍然有加法和乘法的不变性，即: <span class=\"math display\">\\[\r\nM(e_1) * M(e_2) = M(e_1e_2)\r\n\\]</span></p>\r\n<p>若将<span class=\"math inline\">\\(M(e_2)\\)</span>的第一列提取出来，即为： <span class=\"math display\">\\[\r\nM(e_1) * V(e_2) = V(e_1e_2)\r\n\\]</span></p>\r\n<p>至此，前面的理论已完全证毕。</p>\r\n<p>现在再来证明Cauchy matrix的求逆过程可以在<span class=\"math inline\">\\(O(n^2)\\)</span>的时间复杂度内完成。</p>\r\n<p>对于Cauchy矩阵的任意一个子方阵<span class=\"math inline\">\\(C = [c_{ij}]_{n\\times n}\\)</span>: <span class=\"math display\">\\[\r\n\\begin{bmatrix}\r\n\\frac{1}{x_1+y_1} &amp; \\frac{1}{x_1+y_2} &amp; \\cdots &amp; \\frac{1}{x_1+y_n}  \\\\[10pt]\r\n\\frac{1}{x_2+y_1} &amp; \\frac{1}{x_2+y_2} &amp; \\cdots &amp; \\frac{1}{x_2+y_n} \\\\[10pt]\r\n\\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\[10pt]\r\n\\frac{1}{x_n+y_1} &amp; \\frac{1}{x_n+y_2} &amp; \\cdots &amp; \\frac{1}{x_n+y_n} \r\n\\end{bmatrix}\r\n\\]</span> 其行列式 <span class=\"math display\">\\[\r\n\\det C = \\frac{\\prod_{i&lt;j}(x_i-x_j)\\prod_{i&lt;j}(y_i-y_j)}{\\prod_{i,j = 1}^n(x_i+y_j)}\r\n\\]</span> 令<span class=\"math inline\">\\(C^{-1} = [d_{ij}]\\)</span>，则有</p>\r\n<p><span class=\"math display\">\\[\r\nd_{ij} = (-1)^{i+j}\\frac{\\det C_{ji}}{\\det C_j}\r\n\\]</span> 其中<span class=\"math inline\">\\(c_{ji}\\)</span>表示删除了第<span class=\"math inline\">\\(j\\)</span>行和第<span class=\"math inline\">\\(i\\)</span>列的矩阵<span class=\"math inline\">\\(C\\)</span>。令 <span class=\"math display\">\\[\r\n\\begin{align}\r\na_k &amp;= \\prod_{i&lt;k}(x_i-x_k)\\prod_{k&lt;j}(x_k-x_j)\\\\\r\nb_k &amp;= \\prod_{i&lt;k}(y_i-y_k)\\prod_{k&lt;j}(y_j-y_k)\\\\\r\nc_k &amp;= \\prod_{i=1}^n(x_k+y_i)\\\\\r\nf_k &amp;= \\prod_{i=1}^n(y_k+x_i)\r\n\\end{align}\r\n\\]</span> 因此，有：</p>\r\n<p><span class=\"math display\">\\[\r\n\\begin{align}\r\n\\det C &amp;= \\frac{\\prod_{k=1}^na_kb_k}{\\prod_{k=1}^ne_kf_k}\\\\\r\n\\det C_{ji} &amp;= \\frac{\\det C e_jf_i}{a_jb_i(x_j+y_i)}\r\n\\end{align}\r\n\\]</span> 因此：</p>\r\n<p><span class=\"math display\">\\[\r\nd_{ij} = (-1)^{i+j}\\frac{e_jf_i}{a_jb_i(x_j+y_i)}\r\n\\]</span> 所以<span class=\"math inline\">\\(4n\\)</span>个未知量<span class=\"math inline\">\\(a_k, b_k, c_k, f_k\\)</span>可以在<span class=\"math inline\">\\(O(n^2)\\)</span>的时间复杂度内被解出，而<span class=\"math inline\">\\(d_{ij}\\)</span>则可由上述公式在<span class=\"math inline\">\\(O(1)\\)</span>的时间复杂度得到，因此，Cauchy矩阵的求逆过程可以在<span class=\"math inline\">\\(O(n^2)\\)</span>的时间复杂度内得到。</p>\r\n<h1 id=\"三jerasure库源码分析\">三、JErasure库源码分析</h1>\r\n<h2 id=\"一galois.cgalois.h\">（一）Galois.c/Galois.h</h2>\r\n<p>这两个文件中定义的函数比较简单。首先：</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">int</span> prim_poly[<span class=\"number\">33</span>]; <span class=\"comment\">//对应的w的各个质多项式</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">int</span> mult_type[<span class=\"number\">33</span>]; <span class=\"comment\">//对于不同的w采用不同的乘法计算</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">int</span> nw[<span class=\"number\">33</span>];\t\t  <span class=\"comment\">//存放的是2^w的值，nwm1是2^w-1的值，即GF(2^w)的最大值</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">int</span> *galois_log_tables[<span class=\"number\">33</span>];  <span class=\"comment\">//各个w(1~30)的反表</span></span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">int</span> *galois_ilog_tables[<span class=\"number\">33</span>]; <span class=\"comment\">//各个w(1~30)的正表</span></span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">int</span> *galois_mult_tables[<span class=\"number\">33</span>]; <span class=\"comment\">//各个w(1~30)的乘法表</span></span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">int</span> *galois_div_tables[<span class=\"number\">33</span>];  <span class=\"comment\">//各个w(1~30)的除法表</span></span><br></pre></td></tr></table></figure>\r\n<p>以上是Galois.c中定义的一系列表，这些表将会在之后进行构造。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">galois_create_log_tables</span><span class=\"params\">(<span class=\"keyword\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">//创建w的正反表，且将正表复制了两份，以便构建乘法表和除法表，然后将正表的初始位置(galois_log_tables[w][0]置为第二个副本的起始位置)，返回0表示构建成功，返回1表示失败</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">galois_logtable_multiply</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> y, <span class=\"keyword\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">//查正反表计算x*y</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">galois_logtable_divide</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> y, <span class=\"keyword\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">//查正反表计算x/y</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">galois_create_mult_tables</span><span class=\"params\">(<span class=\"keyword\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">//构建大小为nw[w] * nw[w]的乘法表和除法表</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">galois_ilog</span><span class=\"params\">(<span class=\"keyword\">int</span> value, <span class=\"keyword\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">//求value对应的二进制的值，即x^value对应的数值</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">galois_log</span><span class=\"params\">(<span class=\"keyword\">int</span> value, <span class=\"keyword\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">//求value对应的多项式，即value对应的x^i的i值</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">galois_shift_multiply</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> y, <span class=\"keyword\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">//移位乘法，不需要任何表即可实现，但需要w次乘2，w次判断。</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">//对于x*y，先计算出y*2, y*2^2, y*2^3, ..., y*2^w-1的值，然后将x化为二进制，对x的第i位为1的，取出y*2^i进行异或得到结果。</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">galois_multtable_multiply</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> y, <span class=\"keyword\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">//查乘法表求x*y</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">galois_invert_binary_matrix</span><span class=\"params\">(<span class=\"keyword\">int</span> *mat, <span class=\"keyword\">int</span> *inv, <span class=\"keyword\">int</span> rows)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">//用初等变换法计算二进制矩阵mat的逆矩阵，mat的每一个元素表示一行，应为w，即w = row，若不可逆则停止运行程序</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">galois_inverse</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">//若w = 23~32，用移位，否则直接用galois_single_multiply计算1/x</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">galois_shift_inverse</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">//以移位的方式求y的倒数</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">//先由y得到mat2[w] = &#123;y, y*2, y*2^2, ..., y*2^w-1&#125;，通过galois_invert_binary_matrix函数得到mat2[w]的逆矩阵inv，inv[0]即为1/y的值</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">galois_single_multiply</span><span class=\"params\">(<span class=\"keyword\">int</span> a, <span class=\"keyword\">int</span> b, <span class=\"keyword\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">//计算x*y，对于不同的w采用不同的乘法策略：</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">/********************************</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"function\"> * w = 1~9: 构造乘法表，查乘法表</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"function\"> * w = 10~22: 构建正反表，查正反表</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"function\"> * w = 23~31: 用移位乘法</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"function\"> * w = 32: 用裂乘</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"function\"> ********************************/</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">galois_single_divide</span><span class=\"params\">(<span class=\"keyword\">int</span> a, <span class=\"keyword\">int</span> b, <span class=\"keyword\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">//计算a/b，对于不同的w采用不同的除法策略：</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">/********************************</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"function\"> * w = 1~9: 构造除法表，查除法表</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"function\"> * w = 10~22: 构建正反表，查正反表</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"function\"> * w = 23~32: 先得到b的倒数(galois_inverse(b, w))，再用galois_single_multiply函数计算(分为w = 23~31和w = 32的两种策略)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"function\"> ********************************/</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">galois_shift_divide</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> y, <span class=\"keyword\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">//利用galois_shift_inverse函数得到b的倒数，再利用移位乘法得到a/b的值</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">galois_multtable_divide</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> y, <span class=\"keyword\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">//查除法表得x/y</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">galois_create_split_w8_tables</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">//创建裂乘表</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">galois_split_w8_multiply</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> y)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">//裂乘</span></span></span><br></pre></td></tr></table></figure>\r\n<p>其中，裂乘的思路如下： 对于<span class=\"math inline\">\\(x\\times y\\)</span>，以<span class=\"math inline\">\\(GF(2^{32})\\)</span>为例，<span class=\"math inline\">\\(x\\)</span>和<span class=\"math inline\">\\(y\\)</span>均为域内元素，则<span class=\"math inline\">\\(x\\)</span>和<span class=\"math inline\">\\(y\\)</span>可表示成： <span class=\"math display\">\\[\r\nx = x_0+2^8\\times x_1+2^{2\\times 8}\\times x_2+2^{3\\times 8}\\times x_3 \\\\\r\ny = y_0+2^8\\times y_1+2^{2\\times 8}\\times y_2+2^{3\\times 8}\\times y_3\r\n\\]</span></p>\r\n<p>其中<span class=\"math inline\">\\(x_i\\)</span>和<span class=\"math inline\">\\(y_i\\)</span>均为unit8_t型数据，<span class=\"math inline\">\\(i \\in \\{0, 1, 2, 3\\}\\)</span>. 则： <span class=\"math display\">\\[\r\n\\begin{aligned}\r\nx\\times y &amp;= ( x_0+2^8\\times x_1+2^{2\\times 8}\\times x_2+2^{3\\times 8}\\times x_3)\\times (y_0+2^8\\times y_1+2^{2\\times 8}\\times y_2+2^{3\\times 8}\\times y_3)\\\\\r\n&amp;=x_0y_0\\\\\r\n&amp;+\\ 2^8\\times (x_0y_1+x_1y_0)\\\\\r\n&amp;+\\ 2^{2 \\times 8}\\times (x_0y_2+x_1y_1+x_2y_0)\\\\\r\n&amp;+\\ 2^{3 \\times 8}\\times (x_0y_3+x_1y_2+x_2y_1+x_3y_0)\\\\\r\n&amp;+\\ 2^{4 \\times 8}\\times (x_1y_3+x_2y_2+x_3y_1)\\\\\r\n&amp;+\\ 2^{5 \\times 8}\\times (x_2y_3+x_3y_2)\\\\\r\n&amp;+\\ 2^{6 \\times 8}\\times (x_3y_3)\r\n\\end{aligned}\r\n\\]</span> 因此，设<span class=\"math inline\">\\(\\alpha\\)</span>为unit32_t类型数中只有低<span class=\"math inline\">\\(8\\)</span>位的任意数字，那么根据上述<span class=\"math inline\">\\(x\\times y\\)</span>的拆分结果可以归结为 <span class=\"math display\">\\[\r\n\\alpha \\times \\alpha, \\alpha \\times (\\alpha &lt;&lt; 8), \\alpha \\times (\\alpha&lt;&lt;16),\\alpha \\times (\\alpha&lt;&lt;24),\r\n\\]</span></p>\r\n<p><span class=\"math display\">\\[\r\n (\\alpha &lt;&lt; 8)\\times (\\alpha&lt;&lt;24),(\\alpha &lt;&lt; 16)\\times (\\alpha&lt;&lt;24),(\\alpha &lt;&lt; 24)\\times (\\alpha&lt;&lt;24)\r\n\\]</span></p>\r\n<p>一共7种运算。每一种运算可以用一个乘法表表示，每个乘法表大小为<span class=\"math inline\">\\(2^8\\times 2^8\\times 4\\ Bytes\\)</span>.</p>\r\n<p>以上为Galois field上的一些基本运算。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">galois_region_xor</span><span class=\"params\">(<span class=\"keyword\">char</span> *r1,         <span class=\"comment\">/* Region 1 */</span></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                       <span class=\"keyword\">char</span> *r2,         <span class=\"comment\">/* Region 2 */</span></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                       <span class=\"keyword\">char</span> *r3,         <span class=\"comment\">/* Sum region (r3 = r1 ^ r2) */</span></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                       <span class=\"keyword\">int</span> nbytes)</span></span>;      <span class=\"comment\">/* Number of bytes in region */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">galois_w08_region_multiply</span><span class=\"params\">(<span class=\"keyword\">char</span> *region,       <span class=\"comment\">/* Region to multiply */</span></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                                <span class=\"keyword\">int</span> multby,       <span class=\"comment\">/* Number to multiply by */</span></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                                <span class=\"keyword\">int</span> nbytes,       <span class=\"comment\">/* Number of bytes in region */</span></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                                <span class=\"keyword\">char</span> *r2,         </span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\"><span class=\"comment\">/* If r2 != NULL, products go here.Otherwise region is overwritten */</span></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                                <span class=\"keyword\">int</span> add)</span></span>;         </span><br><span class=\"line\"><span class=\"comment\">/* If (r2 != NULL &amp;&amp; add) the produce is XOR&#x27;d with r2 */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">galois_w16_region_multiply</span><span class=\"params\">(<span class=\"keyword\">char</span> *region,       <span class=\"comment\">/* Region to multiply */</span></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                                <span class=\"keyword\">int</span> multby,       <span class=\"comment\">/* Number to multiply by */</span></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                                <span class=\"keyword\">int</span> nbytes,       <span class=\"comment\">/* Number of bytes in region */</span></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                                <span class=\"keyword\">char</span> *r2,         </span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\"><span class=\"comment\">/* If r2 != NULL, products go here. Otherwise region is overwritten */</span></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                                <span class=\"keyword\">int</span> add)</span></span>;         </span><br><span class=\"line\"><span class=\"comment\">/* If (r2 != NULL &amp;&amp; add) the produce is XOR&#x27;d with r2 */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">galois_w32_region_multiply</span><span class=\"params\">(<span class=\"keyword\">char</span> *region,       <span class=\"comment\">/* Region to multiply */</span></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                                <span class=\"keyword\">int</span> multby,       <span class=\"comment\">/* Number to multiply by */</span></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                                <span class=\"keyword\">int</span> nbytes,       <span class=\"comment\">/* Number of bytes in region */</span></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                                <span class=\"keyword\">char</span> *r2,         </span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\"><span class=\"comment\">/* If r2 != NULL, products go here. Otherwise region is overwritten */</span></span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                                  <span class=\"keyword\">int</span> add)</span></span>;         </span><br><span class=\"line\"><span class=\"comment\">/* If (r2 != NULL &amp;&amp; add) the produce is XOR&#x27;d with r2 */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 上述三个函数均为将region中各个元素乘以multby</span></span><br><span class=\"line\"><span class=\"comment\">// 1. r2 == NULL,则将结果写入region，结束</span></span><br><span class=\"line\"><span class=\"comment\">// 2. r2 != NULL 且 add is false,则将结果写入r2</span></span><br><span class=\"line\"><span class=\"comment\">// 3. r2 != NULL 且 add is true,将结果与r2异或再写入r2</span></span><br></pre></td></tr></table></figure>\r\n<p>以上四个函数为域内乘法，第一个表示将两个等大的数组<span class=\"math inline\">\\(r_1\\)</span>和<span class=\"math inline\">\\(r_2\\)</span>按元素进行异或，将结果置入<span class=\"math inline\">\\(r_3\\)</span>中。后面3个函数主要用来求点积，具体的实现步骤已经标注在上面的注释中了，点积的概念将在之后介绍到。</p>\r\n<h2 id=\"二jerasure.cjerasure.h\">（二）JErasure.c/JErasure.h</h2>\r\n<h3 id=\"函数的参数介绍\">3.2.1 函数的参数介绍</h3>\r\n<p>在分析函数功能之前，先弄明白这两个文件中定义的函数的参数。</p>\r\n<p><span class=\"math inline\">\\(K\\)</span> = 数据块数量</p>\r\n<p><span class=\"math inline\">\\(M\\)</span> = 校验块(coding devices)数量</p>\r\n<p><span class=\"math inline\">\\(W\\)</span> = 字长</p>\r\n<p><span class=\"math inline\">\\(data\\_ptrs[][]\\)</span> = 包含<span class=\"math inline\">\\(k\\)</span>个指向大小为size bytes的数据的指针的数组，即数据块指针，<span class=\"math inline\">\\(size\\)</span>必须是sizeof(long)的整数倍</p>\r\n<p><span class=\"math inline\">\\(coding\\_ptrs[][]\\)</span> = 指向编码数据（大小为字节）的m个指针数组，即校验块指针</p>\r\n<p><span class=\"math inline\">\\(packetsize\\)</span> = 使用bitmatrix编码的编码块(coding block)大小</p>\r\n<p><span class=\"math inline\">\\(Matrix[]\\)</span> = 包含<span class=\"math inline\">\\(k\\times m\\)</span>个整数(integer)的数组，即编码矩阵，其中<span class=\"math inline\">\\(i\\)</span>行<span class=\"math inline\">\\(j\\)</span>列元素为<span class=\"math inline\">\\(matrix[i\\times k+j]\\)</span></p>\r\n<p><span class=\"math inline\">\\(Bitmatrix[]\\)</span> = 包含<span class=\"math inline\">\\(kw \\times mw\\)</span>个整数(integer)的数组，其中<span class=\"math inline\">\\(i\\)</span>行<span class=\"math inline\">\\(j\\)</span>列元素为<span class=\"math inline\">\\(bitmatrix[i\\times kw+j]\\)</span></p>\r\n<p><span class=\"math inline\">\\(Erasures[]\\)</span> = 已删除的设备(devices)(块)的<span class=\"math inline\">\\(id\\)</span>的数组，用于记录哪些块丢失 <span class=\"math inline\">\\(id∈[0, k+m-1]\\)</span> <span class=\"math inline\">\\(id∈[0, k-1]：数据块id\\)</span> <span class=\"math inline\">\\(id∈[k, k+m-1]：编码块(校验块)id\\)</span> <span class=\"math inline\">\\(例如：erasures[0] = 0;\\)</span> //第<span class=\"math inline\">\\(0\\)</span>个块丢失 <span class=\"math inline\">\\(erasures[1] = 3;\\)</span> //第<span class=\"math inline\">\\(3\\)</span>个块丢失 <span class=\"math inline\">\\(erasures[2] = -1;\\)</span> //结束标志</p>\r\n<p><span class=\"math inline\">\\(Operation[op][]\\)</span> = 包含5个整数的数组(五元组) <span class=\"math inline\">\\(4 : 进行操作 - 0表示复制，1表示异或\\)</span> <span class=\"math inline\">\\(0 : 源设备(device)[0,k+m-1](operation[op][0] = -1表示结束)\\)</span> <span class=\"math inline\">\\(1 : 源数据包(packet)[0,w-1]\\)</span> <span class=\"math inline\">\\(2 : 目标设备[0,k+m-1]\\)</span> <span class=\"math inline\">\\(3 : 目标数据包[0,w-1]\\)</span></p>\r\n<p>我这里只介绍各个接口的实现和作用，各位最好还是对照源码来理解各个参数的含义。</p>\r\n<h3 id=\"位矩阵编解码的时空优化方案\">3.2.2 位矩阵编解码的时空优化方案</h3>\r\n<p>因为位矩阵的大小变成了<span class=\"math inline\">\\(kw\\times mw\\)</span>，比之前的矩阵大了<span class=\"math inline\">\\(w^2-1\\)</span>倍，空间利用率极低。而且在编码校验块的时候，中间可能会有大量的XOR操作是重复的，例如 <span class=\"math display\">\\[\r\nP_{1,1}=D_{1,1} \\otimes D_{1,2};\\\\\r\n    P_{1,2}=D_{1,1} \\otimes D_{1,2} \\otimes D_{2,2};\\\\\r\n    P_{2,1}=D_{1,1} \\otimes D_{2,2} \\otimes D_{3,1}\r\n\\]</span> 因此，可以由<span class=\"math display\">\\[P_{1,2}=P_{1,1} \\otimes D_{2,2} \\\\P_{2,1}=P_{1,2}\\otimes D_{2,2}\\otimes D_{3,1}\\]</span>来减少XOR次数，一般而言，<span class=\"math inline\">\\(kw\\)</span>和<span class=\"math inline\">\\(mw\\)</span>较大，所以以这种方式来减少XOR次数是可以减少编解码时间的。</p>\r\n<p>刚刚那个栗子只减少了1次XOR操作，看起来8太行。现在来举个好一点的栗子： <img src=\"https://img-blog.csdnimg.cn/20201113153306999.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjg2ODg0OQ==,size_16,color_FFFFFF,t_70#pic_center\" /> 由上面的图上所示，按照位矩阵的XOR操作得到校验块，可以得到： <img src=\"https://img-blog.csdnimg.cn/20201113153439304.png#pic_center\" /> 但是很显然，中间有大量的XOR操作可以重复利用。如果将其重复的结果进行分类，则可以有以下结果： <img src=\"https://img-blog.csdnimg.cn/20201113153729783.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjg2ODg0OQ==,size_16,color_FFFFFF,t_70#pic_center\" /> 很显然，这次是大大的减少所需的XOR操作。</p>\r\n<p>以这种思路，JErasure库给出了两种方式来分别实现提高空间利用率和进一步减少XOR的操作数：</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> **<span class=\"title\">jerasure_dumb_bitmatrix_to_schedule</span><span class=\"params\">(<span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> m, <span class=\"keyword\">int</span> w, <span class=\"keyword\">int</span> *bitmatrix)</span></span>;</span><br><span class=\"line\"><span class=\"comment\">//将bitmatrix转换为一系列操作。简单粗暴。</span></span><br><span class=\"line\"><span class=\"comment\">//返回一个operations[][]数组，具体实现方式为：</span></span><br><span class=\"line\"><span class=\"comment\">//若bitmatrix[index] == 1，则计算得到当前bitmatrix位置对应的数据块位置，如果在该行是第一个bitmatrix[index] == 1，则置operation为0(copy)，否则为1(XOR)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> **<span class=\"title\">jerasure_smart_bitmatrix_to_schedule</span><span class=\"params\">(<span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> m, <span class=\"keyword\">int</span> w, <span class=\"keyword\">int</span> *bitmatrix)</span></span>;</span><br><span class=\"line\"><span class=\"comment\">// 采用与上一函数类似的方法，不过使用之前的结果来计算新的点积。</span></span><br></pre></td></tr></table></figure>\r\n<p>这两个函数都是将位矩阵(bitmatrix)转化为了调度(schedule)，既减少空间开销，也减少了XOR次数。 先来分析第一个函数：(dumb) 其实就是在模拟位矩阵与数据包的矩阵乘法过程。例如： <img src=\"https://img-blog.csdnimg.cn/2020111315183021.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjg2ODg0OQ==,size_16,color_FFFFFF,t_70#pic_center\" /> 例如: <span class=\"math display\">\\[C_{11}=D_{11} \\otimes D_{21} \\otimes D_{22} \\otimes D_{33}\\otimes D_{41} \\otimes D_{42} \\otimes D_{43} \\otimes D_{52}\\]</span> <span class=\"math inline\">\\(jerasure\\_dumb\\_bitmatrix\\_to\\_schedule\\)</span>即模拟<span class=\"math inline\">\\(D_{11}, \\cdots, D_{52}\\)</span>的操作，且每个operation元素对应了一个源块和目标块的位置，以及要进行的操作。 例如，<span class=\"math inline\">\\(D_{11}\\)</span>对应的源块即为<span class=\"math inline\">\\((1,1)\\)</span>，目标块<span class=\"math inline\">\\(C_{11}\\)</span>即为<span class=\"math inline\">\\((1,1)\\)</span>，因为<span class=\"math inline\">\\(D_{11}\\)</span>在第一个位置上，所以操作为复制(copy)，即为<span class=\"math inline\">\\((0)\\)</span>，因此，<span class=\"math inline\">\\(D_{11}\\)</span>对应的五元组为<span class=\"math inline\">\\((1,1,1,1,0)\\)</span>. 再例如，<span class=\"math inline\">\\(D_{21}\\)</span>对应的源块即为<span class=\"math inline\">\\((2,1)\\)</span>，目标块<span class=\"math inline\">\\(C_{11}\\)</span>即为<span class=\"math inline\">\\((1,1)\\)</span>，因为<span class=\"math inline\">\\(D_{21}\\)</span>不在第一个位置上，也就是说之前已经开始计算异或结果了，所以此时操作为异或(XOR)，即为<span class=\"math inline\">\\((1)\\)</span>，代表XOR <span class=\"math inline\">\\(D_{21}\\)</span>，因此，<span class=\"math inline\">\\(D_{11}\\)</span>对应的五元组为<span class=\"math inline\">\\((2,1,1,1,1)\\)</span>.</p>\r\n<p>现在来分析第二个函数：(smart) 前面那个函数只是开胃菜，这个函数才是对位运算的大大优化。基本思路与上一函数类似，但是这个会使用之前计算过的XOR结果(点积)来编码新的校验块。 下面是这种中间结果复用的实现方式：</p>\r\n<p>先定义一些记号，以便后续说明： <span class=\"math inline\">\\(\\text{from[]含有r个元素，初始置-1}\\)</span></p>\r\n<p><span class=\"math inline\">\\(\\text{diff[]含r个元素}，\\text{diff[i]表示Mi中1的数量}\\)</span></p>\r\n<p><span class=\"math inline\">\\(\\text{flink[]和 blink[]用于定位top，top用于找当前待计算的校验块}\\)</span></p>\r\n<p><span class=\"math inline\">\\(\\text{bestdiff记录当前最小的diff[i]的值}\\)</span></p>\r\n<p><span class=\"math inline\">\\(\\text{bestrow记录当前bestdiff对应的diff[i]的 i的值}\\)</span></p>\r\n<p>实现步骤： 假定<span class=\"math inline\">\\(M\\)</span>为<span class=\"math inline\">\\(bitmatrix\\)</span>，<span class=\"math inline\">\\(V\\)</span>为输入的数据块，<span class=\"math inline\">\\(U\\)</span>为生成的校验块，<span class=\"math inline\">\\(notdone\\)</span>代表待生成的校验块<span class=\"math inline\">\\(id\\)</span>的集合，初始为<span class=\"math inline\">\\(0\\)</span> ~ <span class=\"math inline\">\\(mw-1\\)</span>，则步骤如下:</p>\r\n<pre><code>1. 选择未计算的校验块的packet且diff[i]最小的 i，即找到i∈notdone且diff[i]最小\r\n2. 若from[i] = -1, 则令operation[op]的元素为M[i, j] = 1的所有对应的数据块;\r\n   若from[i] ≠ -1, 则令operation[op]的第一个元素为校验块from[i]，之后的元素为第from[i]行与i行相异的bitmatrix中的元素对应的数据块\r\n3. 从notdone中删除i\r\n4. 对于notdone中的任一元素j，计算第j行与第i行中相异的元素的数量c，令x = c + 1，若x &lt; diff[j]，则diff[j] = x，from[j] = i</code></pre>\r\n<p>也就是说，在某一次计算中，如果<span class=\"math inline\">\\(from[i] != -1\\)</span>，则说明第<span class=\"math inline\">\\(i\\)</span>个校验块的计算中用前面的计算过的结果来计算第i个校验块比直接进行矩阵乘法用到的XOR数要少，如果<span class=\"math inline\">\\(from[i] == -1\\)</span>，则说明用前面的结果计算该校验块不如直接计算来的快，就直接从<span class=\"math inline\">\\(bitmatrix\\)</span>中进行异或运算。</p>\r\n<p>效率分析： 例如，在解码过程中，要计算得到<span class=\"math inline\">\\(D_0\\)</span>和<span class=\"math inline\">\\(D_1\\)</span>，通过一般的矩阵乘法计算，一共需要124次XORs。但是，如果按照上述方案： 1. 找到含有最少的1的一行(记为第<span class=\"math inline\">\\(i\\)</span>行)，即计算<span class=\"math inline\">\\(D_{1,3}\\)</span>对应的一行，一共有8个1，因此共7次XORs。 2. 计算其他9行(记为第<span class=\"math inline\">\\(j\\)</span>行)与<span class=\"math inline\">\\(D_{1,3}\\)</span>对应的<span class=\"math inline\">\\(bitmatrix\\)</span>的行中相异元素的数量，如果第<span class=\"math inline\">\\(j\\)</span>行中1的数量小于刚才计算出的数量+1，说明由第<span class=\"math inline\">\\(j\\)</span>行计算块得到结果需要的XOR数量多于由第<span class=\"math inline\">\\(j\\)</span>行计算块得到结果需要的XOR数量，此时将<span class=\"math inline\">\\(from[j]\\)</span>置为<span class=\"math inline\">\\(i\\)</span>，即第<span class=\"math inline\">\\(j\\)</span>行的XOR数量由第<span class=\"math inline\">\\(i\\)</span>行的结果来得到比当前方法更快。 3. 重复之，直到计算得到了所有的块。 <img src=\"https://img-blog.csdnimg.cn/20201113154800579.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjg2ODg0OQ==,size_16,color_FFFFFF,t_70#pic_center\" /> 根据上述理论分析，可以得出以下计算步骤： <img src=\"https://img-blog.csdnimg.cn/20201113155916771.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjg2ODg0OQ==,size_16,color_FFFFFF,t_70#pic_center\" /> 此时一共需要46次XORs操作。相比之前的124次XORs，这种方法得到了大幅优化。</p>\r\n<h3 id=\"无返回值void的函数\">3.2.3 无返回值(void)的函数</h3>\r\n<p>接下来是几个无返回值的函数，比较简单，所以拿出来放在一块儿分析了。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">jerasure_do_parity</span><span class=\"params\">(<span class=\"keyword\">int</span> k, <span class=\"keyword\">char</span> **data_ptrs, <span class=\"keyword\">char</span> *parity_ptr, <span class=\"keyword\">int</span> size)</span></span>;</span><br><span class=\"line\"><span class=\"comment\">// 由data_ptrs直接进行XOR操作生成校验块，结果放入parity_ptr中</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">jerasure_matrix_encode</span><span class=\"params\">(<span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> m, <span class=\"keyword\">int</span> w, <span class=\"keyword\">int</span> *matrix,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                          <span class=\"keyword\">char</span> **data_ptrs, <span class=\"keyword\">char</span> **coding_ptrs, <span class=\"keyword\">int</span> size)</span></span>;</span><br><span class=\"line\"><span class=\"comment\">// 按常规方式编码，w必须是8，16，32</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">jerasure_bitmatrix_encode</span><span class=\"params\">(<span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> m, <span class=\"keyword\">int</span> w, <span class=\"keyword\">int</span> *bitmatrix,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                            <span class=\"keyword\">char</span> **data_ptrs, <span class=\"keyword\">char</span> **coding_ptrs, <span class=\"keyword\">int</span> size, <span class=\"keyword\">int</span> packetsize)</span></span>;</span><br><span class=\"line\"><span class=\"comment\">// 按常规方式对位矩阵编码，w ∈ [1, 32] and w ∈ N*</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">jerasure_schedule_encode</span><span class=\"params\">(<span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> m, <span class=\"keyword\">int</span> w, <span class=\"keyword\">int</span> **schedule,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                                  <span class=\"keyword\">char</span> **data_ptrs, <span class=\"keyword\">char</span> **coding_ptrs, <span class=\"keyword\">int</span> size, <span class=\"keyword\">int</span> packetsize)</span></span>;</span><br><span class=\"line\"><span class=\"comment\">// 使用jerasure_smart_bitmatrix_to_schedule()或者jerasure_dumb_bitmatrix_to_schedule()进行编码，具体方案由schedule[][]确定</span></span><br></pre></td></tr></table></figure>\r\n<p>没有什么难懂的地方，我根据自己的理解加了两句注释，大家看看代码也很容易就看懂了。</p>\r\n<h3 id=\"返回整数integer的函数\">3.2.4 返回整数(integer)的函数</h3>\r\n<p>这种返回整数的函数都是值返回<span class=\"math inline\">\\(0\\)</span>和<span class=\"math inline\">\\(-1\\)</span>的，返回<span class=\"math inline\">\\(0\\)</span>说明这个函数完整的进行了操作，返回成功的标志；返回<span class=\"math inline\">\\(-1\\)</span>说明参数有误，中途中断，返回失败的标志。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">jerasure_matrix_decode</span><span class=\"params\">(<span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> m, <span class=\"keyword\">int</span> w, </span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                          <span class=\"keyword\">int</span> *matrix, <span class=\"keyword\">int</span> row_k_ones, <span class=\"keyword\">int</span> *erasures,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                          <span class=\"keyword\">char</span> **data_ptrs, <span class=\"keyword\">char</span> **coding_ptrs, <span class=\"keyword\">int</span> size)</span></span>;</span><br></pre></td></tr></table></figure>\r\n<p><span class=\"math inline\">\\(k\\)</span>表示数据块，<span class=\"math inline\">\\(m\\)</span>表示校验块，<span class=\"math inline\">\\(matrix\\)</span>表示生成矩阵，<span class=\"math inline\">\\(row\\_k\\_ones\\)</span>用于记录编码的第一行是否为全1，用于优化，<span class=\"math inline\">\\(data\\_ptrs\\)</span>表示指向数据块的指针，<span class=\"math inline\">\\(coding\\_ptrs\\)</span>表示指向校验块的指针，<span class=\"math inline\">\\(erasures\\)</span>记录哪些块失效，<span class=\"math inline\">\\(size\\)</span>表示块大小。 这个函数表示创建<span class=\"math inline\">\\(GF(2^w)\\)</span>上的解码矩阵进行解码，且最终会丢弃解码矩阵。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">jerasure_bitmatrix_decode</span><span class=\"params\">(<span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> m, <span class=\"keyword\">int</span> w, </span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                            <span class=\"keyword\">int</span> *bitmatrix, <span class=\"keyword\">int</span> row_k_ones, <span class=\"keyword\">int</span> *erasures,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                            <span class=\"keyword\">char</span> **data_ptrs, <span class=\"keyword\">char</span> **coding_ptrs, <span class=\"keyword\">int</span> size, <span class=\"keyword\">int</span> packetsize)</span></span>;</span><br></pre></td></tr></table></figure>\r\n<p>表示创建<span class=\"math inline\">\\(GF(2)\\)</span>上的矩阵（位矩阵）进行解码，参数同上。<span class=\"math inline\">\\(packetsize\\)</span>是使用位矩阵进行编解码时一个<span class=\"math inline\">\\(packet\\)</span>的大小。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">jerasure_schedule_decode_lazy</span><span class=\"params\">(<span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> m, <span class=\"keyword\">int</span> w, <span class=\"keyword\">int</span> *bitmatrix, <span class=\"keyword\">int</span> *erasures,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                            <span class=\"keyword\">char</span> **data_ptrs, <span class=\"keyword\">char</span> **coding_ptrs, <span class=\"keyword\">int</span> size, <span class=\"keyword\">int</span> packetsize, <span class=\"keyword\">int</span> smart)</span></span>;</span><br></pre></td></tr></table></figure>\r\n<p>若<span class=\"math inline\">\\(smart == 1\\)</span>，则采用<span class=\"math inline\">\\(jerasure\\_smart\\_bitmatrix\\_to\\_schedule()\\)</span>来创建调度（schedule），否则采用<span class=\"math inline\">\\(jerasure\\_smart\\_bitmatrix\\_to\\_schedule()\\)</span>。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">jerasure_make_decoding_matrix</span><span class=\"params\">(<span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> m, <span class=\"keyword\">int</span> w, <span class=\"keyword\">int</span> *matrix, <span class=\"keyword\">int</span> *erased, </span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                                  <span class=\"keyword\">int</span> *decoding_matrix, <span class=\"keyword\">int</span> *dm_ids)</span></span>;</span><br></pre></td></tr></table></figure>\r\n<p>创建解码矩阵，但是不解码，解码矩阵存放在<span class=\"math inline\">\\(decoding\\_matrix\\)</span>中，<span class=\"math inline\">\\(dm\\_ids\\)</span>含有<span class=\"math inline\">\\(k\\)</span>个整数，即用这<span class=\"math inline\">\\(k\\)</span>个存活块来构建解码矩阵，最终生成的<span class=\"math inline\">\\(decoding\\_matrix\\)</span>含有<span class=\"math inline\">\\(k\\times k\\)</span>个整数。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">jerasure_make_decoding_bitmatrix</span><span class=\"params\">(<span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> m, <span class=\"keyword\">int</span> w, <span class=\"keyword\">int</span> *matrix, <span class=\"keyword\">int</span> *erased, </span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                                  <span class=\"keyword\">int</span> *decoding_matrix, <span class=\"keyword\">int</span> *dm_ids)</span></span>;</span><br></pre></td></tr></table></figure>\r\n<p>同上，创建解码位矩阵，但是不解码，解码矩阵存放在<span class=\"math inline\">\\(decoding\\_matrix\\)</span>中，<span class=\"math inline\">\\(dm\\_ids\\)</span>含有<span class=\"math inline\">\\(kw\\)</span>个整数，即用这<span class=\"math inline\">\\(kw\\)</span>个存活块来构建解码矩阵，最终生成的<span class=\"math inline\">\\(decoding\\_matrix\\)</span>含有<span class=\"math inline\">\\(kw\\times kw\\)</span>个整数。</p>\r\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> *<span class=\"title\">jerasure_erasures_to_erased</span><span class=\"params\">(<span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> m, <span class=\"keyword\">int</span> *erasures)</span></span>;</span><br></pre></td></tr></table></figure>\r\n<p>将<span class=\"math inline\">\\(erasures[]\\)</span>转换成<span class=\"math inline\">\\(erased[]\\)</span>返回，其中<span class=\"math inline\">\\(erased[]\\)</span>标识了哪些位置上的 <span class=\"math inline\">\\(packet\\)</span>不可用。例如<span class=\"math inline\">\\(erased[2] = 1\\)</span>说明第<span class=\"math inline\">\\(2\\)</span>个<span class=\"math inline\">\\(packet\\)</span>不可用（从第<span class=\"math inline\">\\(0\\)</span>个<span class=\"math inline\">\\(packet\\)</span>开始计数）。举个栗子： 若<span class=\"math display\">\\[erasures[] = \\{0,2,3\\}\\]</span>则<span class=\"math display\">\\[ erased[] = \\{1,0,1,1\\} \\]</span></p>\r\n<h3 id=\"求点积dot-product的函数\">3.2.5 求点积（dot product）的函数</h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">jerasure_matrix_dotprod</span><span class=\"params\">(<span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> w, <span class=\"keyword\">int</span> *matrix_row,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                          <span class=\"keyword\">int</span> *src_ids, <span class=\"keyword\">int</span> dest_id,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                          <span class=\"keyword\">char</span> **data_ptrs, <span class=\"keyword\">char</span> **coding_ptrs, <span class=\"keyword\">int</span> size)</span></span>;</span><br></pre></td></tr></table></figure>\r\n<p>简单来说，就是将生成矩阵（编码矩阵/解码矩阵）的一行元素与数据块/幸存块相乘（求点积）。</p>\r\n<p>数据块/幸存块的id存放在<span class=\"math inline\">\\(src\\_ids\\)</span>中，例如： <img src=\"https://img-blog.csdnimg.cn/20201117112501820.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjg2ODg0OQ==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"dot_product\" /> <span class=\"math inline\">\\(D_{1,1}\\)</span>的id为<span class=\"math inline\">\\(0\\)</span>，<span class=\"math inline\">\\(D_{4,3}\\)</span>的id为<span class=\"math inline\">\\(12\\)</span>，<span class=\"math inline\">\\(C_{1,1}\\)</span>的id为<span class=\"math inline\">\\(16\\)</span>等。</p>\r\n<p><font color=#FF0000>*<strong>注意：此处为了简单起见，给出的例子全部是以<span class=\"math inline\">\\(1\\)</span>开始计算id的，而一般情况下，应该从<span class=\"math inline\">\\(0\\)</span>开始。例如将上述<span class=\"math inline\">\\(D_{1\\to5}\\)</span>和<span class=\"math inline\">\\(C_{1\\to2}\\)</span>换成<span class=\"math inline\">\\(D_{0\\to4}\\)</span>和<span class=\"math inline\">\\(C_{0\\to1}\\)</span>，则<span class=\"math inline\">\\(D_{0,0}\\)</span>的id是<span class=\"math inline\">\\(0\\)</span>，<span class=\"math inline\">\\(D_{4,3}\\)</span>的id是<span class=\"math inline\">\\(11\\)</span>等。</strong></font></p>\r\n<p>编码/解码生成的块的id存放在<span class=\"math inline\">\\(dest\\_id\\)</span>中。若<span class=\"math inline\">\\(src\\_ids = null\\)</span>，则说明是在编码过程中，直接利用<span class=\"math inline\">\\(data\\_ptrs\\)</span>计算点积即可，若<span class=\"math inline\">\\(src\\_ids\\ne null\\)</span>，则说明是在解码过程中，则需要从<span class=\"math inline\">\\(data\\_ptrs\\)</span>和<span class=\"math inline\">\\(coding\\_ptrs\\)</span>中得到对应的数据块/幸存块再计算点积。</p>\r\n<p>该函数的对乘法计算进行了稍微的优化工作。因为点击计算需要<span class=\"math inline\">\\(GF(2^w)\\)</span>的乘法和加法，所以它会首先计算<span class=\"math inline\">\\(matrix\\)</span>中为<span class=\"math inline\">\\(0\\)</span>或<span class=\"math inline\">\\(1\\)</span>对应的块，然后再计算其他块，以简化计算的复杂度。例如： <span class=\"math display\">\\[\r\n\\begin{bmatrix}\r\n\\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots \\\\\r\n\\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots \\\\\r\n\\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots \\\\\r\n1 &amp; 3 &amp; 0 &amp; 2 &amp; 1 &amp; 0 &amp; 3 &amp; 7 \\\\\r\n\\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots \\\\\r\n\\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots \\\\\r\n\\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots \r\n\\end{bmatrix}\r\n\\begin{bmatrix}\r\nD_1 \\\\[8pt]\r\nD_2 \\\\[8pt]\r\nD_3 \\\\[8pt]\r\nD_4 \\\\[8pt]\r\nD_5 \\\\[8pt]\r\nD_6 \\\\[8pt]\r\nD_7 \\\\[8pt]\r\nD_8\r\n\\end{bmatrix}=\r\n\\begin{bmatrix}\r\n\\cdots \\\\[8pt]\r\n\\cdots \\\\[8pt]\r\n\\cdots \\\\[8pt]\r\nC_i \\\\\r\n\\cdots \\\\[8pt]\r\n\\cdots \\\\[8pt]\r\n\\cdots\r\n\\end{bmatrix}\r\n\\]</span></p>\r\n<p>一般情况下，计算得到<span class=\"math display\">\\[C_i=1D_1\\oplus 3D_2\\oplus 0D_3\\oplus 2D_4\\oplus 1D_5\\oplus 0D_6\\oplus 3D_7\\oplus 7D_8\\]</span></p>\r\n<p>该函数则先计算0和1对应的块，即<span class=\"math inline\">\\(D_1,D_3,D_5,D_6\\)</span>。<span class=\"math inline\">\\(D_3,D_6\\)</span>对应的矩阵元素为0，所以可以忽略(<span class=\"math inline\">\\(\\alpha \\oplus 0=\\alpha\\)</span>)，即先得到<span class=\"math inline\">\\(D_1\\oplus D_5\\)</span>。接下来再利用<span class=\"math inline\">\\(\\text{galois\\_w\\_region\\_multiply}\\)</span>计算剩余的非<span class=\"math inline\">\\(1\\)</span>的点积，然后将二者异或即得到<span class=\"math inline\">\\(C_i\\)</span>。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">jerasure_bitmatrix_dotprod</span><span class=\"params\">(<span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> w, <span class=\"keyword\">int</span> *bitmatrix_row,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                             <span class=\"keyword\">int</span> *src_ids, <span class=\"keyword\">int</span> dest_id,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">                             <span class=\"keyword\">char</span> **data_ptrs, <span class=\"keyword\">char</span> **coding_ptrs, <span class=\"keyword\">int</span> size, <span class=\"keyword\">int</span> packetsize)</span></span>;</span><br></pre></td></tr></table></figure>\r\n<p>含义同上一函数，方法为直接计算。从这里也可看出，<span class=\"math inline\">\\(GF(2)\\)</span>上的点积计算比<span class=\"math inline\">\\(GF(2^w)\\)</span>方便得多。</p>\r\n<h3 id=\"矩阵转置操作函数\">3.2.6 矩阵转置操作函数</h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">jerasure_invert_matrix</span><span class=\"params\">(<span class=\"keyword\">int</span> *mat, <span class=\"keyword\">int</span> *inv, <span class=\"keyword\">int</span> rows, <span class=\"keyword\">int</span> w)</span></span>;</span><br></pre></td></tr></table></figure>\r\n<p>利用初等变换法求<span class=\"math inline\">\\(mat\\)</span>的逆矩阵，将结果放入<span class=\"math inline\">\\(inv\\)</span>中。大小为<span class=\"math inline\">\\(rows\\times rows\\)</span>。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">jerasure_invert_bitmatrix</span><span class=\"params\">(<span class=\"keyword\">int</span> *mat, <span class=\"keyword\">int</span> *inv, <span class=\"keyword\">int</span> rows)</span></span>;</span><br></pre></td></tr></table></figure>\r\n<p>利用初等变换法求<span class=\"math inline\">\\(mat\\)</span>的逆矩阵，将结果放入<span class=\"math inline\">\\(inv\\)</span>中。大小为<span class=\"math inline\">\\(rows\\times rows\\)</span>。此时的<span class=\"math inline\">\\(w=1\\)</span>，因此也可以用<span class=\"math inline\">\\(jerasure\\_invert\\_matrix\\)</span>求逆，但是该函数的时间复杂度为<span class=\"math inline\">\\(O(n^2)\\)</span>，用上一函数令<span class=\"math inline\">\\(w=1\\)</span>的时间复杂度为<span class=\"math inline\">\\(O(n^3)\\)</span>。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">jerasure_invertible_matrix</span><span class=\"params\">(<span class=\"keyword\">int</span> *mat, <span class=\"keyword\">int</span> rows, <span class=\"keyword\">int</span> w)</span></span>;</span><br></pre></td></tr></table></figure>\r\n<p>判断<span class=\"math inline\">\\(mat\\)</span>是否可逆，不会求逆。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">jerasure_invertible_bitmatrix</span><span class=\"params\">(<span class=\"keyword\">int</span> *mat, <span class=\"keyword\">int</span> rows)</span></span>;</span><br></pre></td></tr></table></figure>\r\n<p>同上，判断<span class=\"math inline\">\\(mat\\)</span>是否可逆，不会求逆。</p>\r\n<h3 id=\"一些基本的矩阵操作函数\">3.2.7 一些基本的矩阵操作函数</h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">jerasure_print_matrix</span><span class=\"params\">(<span class=\"keyword\">int</span> *matrix, <span class=\"keyword\">int</span> rows, <span class=\"keyword\">int</span> cols, <span class=\"keyword\">int</span> w)</span></span>;</span><br></pre></td></tr></table></figure>\r\n<p>输出<span class=\"math inline\">\\(matrix\\)</span>，根据<span class=\"math inline\">\\(w\\)</span>的大小确定列间距。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">jerasure_print_bitmatrix</span><span class=\"params\">(<span class=\"keyword\">int</span> *matrix, <span class=\"keyword\">int</span> rows, <span class=\"keyword\">int</span> cols, <span class=\"keyword\">int</span> w)</span></span>;</span><br></pre></td></tr></table></figure>\r\n<p>输出<span class=\"math inline\">\\(matrix\\)</span>，每<span class=\"math inline\">\\(w\\)</span>个字符后插入一个空格，每<span class=\"math inline\">\\(w\\)</span>行后插入一个空白行。</p>\r\n<p>例如：</p>\r\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;string.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">jerasure_print_matrix</span><span class=\"params\">(<span class=\"keyword\">int</span> *m, <span class=\"keyword\">int</span> rows, <span class=\"keyword\">int</span> cols, <span class=\"keyword\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> i, j;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> fw;</span><br><span class=\"line\">    <span class=\"keyword\">char</span> s[<span class=\"number\">30</span>];</span><br><span class=\"line\">    <span class=\"keyword\">unsigned</span> <span class=\"keyword\">int</span> w2;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (w == <span class=\"number\">32</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        fw = <span class=\"number\">10</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        w2 = (<span class=\"number\">1</span> &lt;&lt; w);</span><br><span class=\"line\">        <span class=\"built_in\">sprintf</span>(s, <span class=\"string\">&quot;%u&quot;</span>, w2 - <span class=\"number\">1</span>);</span><br><span class=\"line\">        fw = <span class=\"built_in\">strlen</span>(s);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; rows; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (j = <span class=\"number\">0</span>; j &lt; cols; j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (j != <span class=\"number\">0</span>)</span><br><span class=\"line\">                <span class=\"built_in\">printf</span>(<span class=\"string\">&quot; &quot;</span>);</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%*u&quot;</span>, fw, m[i * cols + j]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;\\n&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">jerasure_print_bitmatrix</span><span class=\"params\">(<span class=\"keyword\">int</span> *m, <span class=\"keyword\">int</span> rows, <span class=\"keyword\">int</span> cols, <span class=\"keyword\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> i, j;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; rows; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (i != <span class=\"number\">0</span> &amp;&amp; i % w == <span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;\\n&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (j = <span class=\"number\">0</span>; j &lt; cols; j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (j != <span class=\"number\">0</span> &amp;&amp; j % w == <span class=\"number\">0</span>)</span><br><span class=\"line\">                <span class=\"built_in\">printf</span>(<span class=\"string\">&quot; &quot;</span>);</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d&quot;</span>, m[i * cols + j]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;\\n&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> mat[] = &#123;<span class=\"number\">1</span>, <span class=\"number\">5</span>, <span class=\"number\">2</span>, <span class=\"number\">7</span>, <span class=\"number\">4</span>, </span><br><span class=\"line\">    \t\t\t <span class=\"number\">5</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">7</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> bitmat[<span class=\"number\">6</span>*<span class=\"number\">15</span>] = &#123;   <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>,    <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>,    <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>,    <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>,    <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">                           <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>,    <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>,    <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>,    <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>,    <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>,</span><br><span class=\"line\">                           <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>,    <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>,    <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>,    <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>,    <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>,</span><br><span class=\"line\">                           </span><br><span class=\"line\">                           <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>,    <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>,    <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>,    <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>,    <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>,</span><br><span class=\"line\">                           <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>,    <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>,    <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>,    <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>,    <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">                           <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>,    <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>,    <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>,    <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>,    <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">    jerasure_print_matrix(mat, <span class=\"number\">2</span>, <span class=\"number\">5</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">    <span class=\"built_in\">putchar</span>(<span class=\"number\">10</span>);</span><br><span class=\"line\">    jerasure_print_bitmatrix(bitmat, <span class=\"number\">2</span>*<span class=\"number\">3</span>, <span class=\"number\">5</span>*<span class=\"number\">3</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">    system(<span class=\"string\">&quot;pause&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p>输出结果为： <img src=\"https://img-blog.csdnimg.cn/20201117145029289.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjg2ODg0OQ==,size_16,color_FFFFFF,t_70#pic_center\" alt=\"输出结果\" /> <figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> *<span class=\"title\">jerasure_matrix_multiply</span><span class=\"params\">(<span class=\"keyword\">int</span> *m1, <span class=\"keyword\">int</span> *m2, <span class=\"keyword\">int</span> r1, <span class=\"keyword\">int</span> c1, <span class=\"keyword\">int</span> r2, <span class=\"keyword\">int</span> c2, <span class=\"keyword\">int</span> w)</span></span>;</span><br></pre></td></tr></table></figure> 计算矩阵乘法。<span class=\"math inline\">\\(m_1\\)</span>为<span class=\"math inline\">\\(r_1\\times c_1\\)</span>，<span class=\"math inline\">\\(m_2\\)</span>为<span class=\"math inline\">\\(r_2\\times c_2\\)</span>，计算<span class=\"math inline\">\\(m_1\\times m_2\\)</span>，显然<span class=\"math inline\">\\(c_1=r_2\\)</span>。</p>\r\n<h3 id=\"监测函数\">3.2.8 监测函数</h3>\r\n<p>为评估编解码性能，JErasure库提供了一个监测函数。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">jerasure_get_stats</span><span class=\"params\">(<span class=\"keyword\">double</span> *fill_in)</span></span>;</span><br></pre></td></tr></table></figure>\r\n<p><code>fill_in</code>是含有<span class=\"math inline\">\\(3\\)</span>个<code>double</code>类型的向量，分别评价三个指标，其含义分别为：</p>\r\n<ol type=\"1\">\r\n<li><p>使用`galois_region_xor()进行了XOR运算的字节数；</p></li>\r\n<li><p>使用<code>galois_w08_region_multiply()</code>, <code>galois_w16_region_multiply()</code> or <code>galois_w32_region_multiply()</code>来乘以常数的字节数，即<span class=\"math inline\">\\(\\text{region}\\)</span>的长度；</p></li>\r\n<li><p>使用<span class=\"math inline\">\\(\\text{memcpy()}\\)</span>复制的字节数。</p></li>\r\n</ol>\r\n<p>调用该函数之后，上述三个指标将会被清空。具体如下：</p>\r\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">jerasure_get_stats</span><span class=\"params\">(<span class=\"keyword\">double</span> *fill_in)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">  fill_in[<span class=\"number\">0</span>] = jerasure_total_xor_bytes;</span><br><span class=\"line\">  fill_in[<span class=\"number\">1</span>] = jerasure_total_gf_bytes;</span><br><span class=\"line\">  fill_in[<span class=\"number\">2</span>] = jerasure_total_memcpy_bytes;</span><br><span class=\"line\">  jerasure_total_xor_bytes = <span class=\"number\">0</span>;</span><br><span class=\"line\">  jerasure_total_gf_bytes = <span class=\"number\">0</span>;</span><br><span class=\"line\">  jerasure_total_memcpy_bytes = <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","categories":["JErasure"],"tags":["galois field","Reed-Solomon Code","JErasure"]},{"title":"八方旅人 -- 壁纸 (1920×1080)","url":"/2021/11/11/octopath/","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><p><code>Alpyn</code></p>\r\n<span id=\"more\"></span>\r\n<p><img src=\"alpyn.jpg\" /></p>\r\n<p><code>Cyrus</code></p>\r\n<p><img src=\"cyrus.jpg\" /></p>\r\n<p><code>haaint</code></p>\r\n<p><img src=\"haaint.jpg\" /></p>\r\n<p><code>Olberic</code></p>\r\n<p><img src=\"olberic.jpg\" /></p>\r\n<p><code>Ophilia</code></p>\r\n<p><img src=\"ophilia.jpg\" /></p>\r\n<p><code>Primrose</code></p>\r\n<p><img src=\"primrose.jpg\" /></p>\r\n<p><code>Therion</code></p>\r\n<p><img src=\"therion.jpg\" /></p>\r\n<p><code>Tressia</code></p>\r\n<p><img src=\"tressia.jpg\" /></p>\r\n<hr />\r\n<p><code>ART1</code></p>\r\n<p><img src=\"art1.jpg\" /></p>\r\n<p><code>ART2</code></p>\r\n<p><img src=\"art2.jpg\" /></p>\r\n<p><code>ART3</code></p>\r\n<p><img src=\"art3.jpg\" /></p>\r\n","categories":["OCTOPATH"],"tags":["OCTOPATH","paperwall"]},{"title":"【置顶】更新日志","url":"/2021/11/11/top/","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><p><span class=\"math display\">\\[\r\n\\LARGE{2021.11}\r\n\\]</span></p>\r\n<hr />\r\n<span id=\"more\"></span>\r\n<p><span class=\"math display\">\\[\r\n\\Large{2021.11.18}\r\n\\]</span></p>\r\n<ul>\r\n<li>更新 <code>CUDA</code> 相关博文</li>\r\n</ul>\r\n<p><span class=\"math display\">\\[\r\n\\Large{2021.11.12}\r\n\\]</span></p>\r\n<ul>\r\n<li>新增站内搜索功能</li>\r\n<li>新增点击特效</li>\r\n<li>新增音乐</li>\r\n<li>修复了搜索功能失效的问题</li>\r\n<li>新增音乐列表</li>\r\n<li>修复音乐无法点击播放的问题</li>\r\n<li>新增音乐全局播放</li>\r\n<li>新增音乐进度条</li>\r\n<li>新增站内页面跳转不打断音乐播放</li>\r\n<li>新增打赏功能</li>\r\n<li>更新 <code>CUDA</code> 相关博文</li>\r\n</ul>\r\n<p><span class=\"math display\">\\[\r\n\\Large{2021.11.11}\r\n\\]</span></p>\r\n<ul>\r\n<li>修复归档导致页面崩溃的 <code>BUG</code></li>\r\n<li>新增评论功能</li>\r\n<li>新增友链</li>\r\n<li>上传 <code>CUDA</code> 相关博文</li>\r\n</ul>\r\n<p><span class=\"math display\">\\[\r\n\\Large{2021.11.10}\r\n\\]</span></p>\r\n<ul>\r\n<li>修复无法正确识别图片的 <code>BUG</code></li>\r\n<li>新增归档功能</li>\r\n<li>新增标签功能</li>\r\n<li>新增归类功能</li>\r\n<li>上传 <code>JErasure</code> 库的相关博文</li>\r\n</ul>\r\n<p><span class=\"math display\">\\[\r\n\\Large{2021.11.09}\r\n\\]</span></p>\r\n<ul>\r\n<li>创建博客</li>\r\n<li>新增 <code>nexT</code> 渲染模式</li>\r\n<li>新增了一些良性 <code>BUG</code></li>\r\n<li>上传第一篇博客</li>\r\n</ul>\r\n","categories":["LOG"],"tags":["logs"]},{"title":"CUDA beginning","url":"/2021/11/11/CUDA-beginning/","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><h1 id=\"什么是-cuda\">〇、 什么是 <code>CUDA</code></h1>\r\n<p><code>CUDA</code>（<code>Compute Unified Device Architecture</code>），是显卡厂商 <a href=\"https://baike.baidu.com/item/NVIDIA\"><code>NVIDIA</code></a> 推出的运算平台。 CUDA™是一种由NVIDIA推出的通用 <a href=\"https://baike.baidu.com/item/并行计算/113443\">并行计算</a> 架构，该架构使 <a href=\"https://baike.baidu.com/item/GPU\"><code>GPU</code></a> 架构，该架构使 <a href=\"https://baike.baidu.com/item/GPU\"><code>GPU</code></a> 能够解决复杂的计算问题。 它包含了CUDA<a href=\"https://baike.baidu.com/item/指令集架构\">指令集架构</a>（<a href=\"https://baike.baidu.com/item/ISA\"><code>ISA</code></a>）以及GPU内部的并行计算引擎。 开发人员可以使用<a href=\"https://baike.baidu.com/item/C语言\"><code>C</code>语言</a>来为<code>CUDA™</code>架构编写程序，所编写出的程序可以在支持<code>CUDA™</code>的处理器上以超高性能运行。</p>\r\n<hr />\r\n<span id=\"more\"></span>\r\n<h1 id=\"一-引言\">一、 引言</h1>\r\n<h2 id=\"gpu-的诞生\">1.1 <code>GPU</code> 的诞生</h2>\r\n<p>​ <code>CPU</code>的计算速度无法满足需求，大部分坐标处理工作及光影特效需要 <code>CPU</code> 亲自完成，占用太多运算时间，造成整体画面不能流畅的表现出来。随着时间的推移，<code>CPU</code> 进行各种光影计算的速度变得越来越无法满足游戏开发商的需求，更多特效的应用也几乎榨干了 <code>CPU</code> 的性能，因此，矛盾产生了，<code>GPU</code> 应运而生。</p>\r\n<h2 id=\"gpu-概述\">1.2 <code>GPU</code> 概述</h2>\r\n<p><code>GPU</code>（<code>Graphics Processing Unit</code>）是一种特殊类型的处理器，具有数百或数千个内核，可并行运行大量计算。<code>GPU</code>是一种专门在<code>PC</code>，游戏机，手机等设备上上运行绘图运算工作的<a href=\"https://baike.hk.xileso.top/baike-微處理器\">微处理器</a>。虽然<code>GPU</code>在游戏中以<a href=\"https://baike.hk.xileso.top/baike-3D渲染\">3D</a><a href=\"https://baike.hk.xileso.top/baike-3D渲染\">渲染</a>而闻名，但它们对运行分析、<a href=\"https://baike.hk.xileso.top/baike-深度学习\">深度学习</a>和<a href=\"https://baike.hk.xileso.top/baike-机器学习\">机器学习</a>算法尤其有用。GPU允许某些计算比传统CPU上运行相同的计算速度快<code>10</code>倍至<code>100</code>倍。</p>\r\n<h2 id=\"cuda-产生\">1.3 <code>CUDA</code> 产生</h2>\r\n<p><code>GPU</code>的高效在于可以高度并行处理。 以两个向量相加为例，<code>CPU</code>可能采取循环处理，每个循环对一个分量做加法。<code>GPU</code>则可以开多个线程，每个线程同时对一个分量做加法。<code>CPU</code>加法的速度一般快于<code>GPU</code>，但因为<code>GPU</code>可以同时开大量线程并行跑，因此更加高效。</p>\r\n<p>为了降低<code>GPU</code>程序的开发难度，<code>NVIDIA</code>推出了 <code>CUDA</code>（<code>Compute Unified Device Architecture</code>，统一计算设备架构）这一编程模型。</p>\r\n<h2 id=\"cpu-和-gpu-模型对比\">1.4 <code>CPU</code> 和 <code>GPU</code> 模型对比</h2>\r\n<h3 id=\"cpu-架构\">1.4.1 <code>CPU</code> 架构</h3>\r\n<p><img src=\"CPU%20Arch.png\" /></p>\r\n<p><code>CPU</code>（<code>Central Processing Unit</code>, 中央处理器）：<code>CPU</code>的结构主要包括运算器（<code>ALU</code>, <code>Arithmetic and Logic Unit</code>）、控制单元（<code>CU</code>, <code>Control Unit</code>）、寄存器（<code>Register</code>）、高速缓存器（<code>Cache</code>）等。简单来说就是<strong>计算单元，控制单元，存储单元</strong>。<strong>计算能力</strong>是CPU的很小的一部分功能。</p>\r\n<ul>\r\n<li><p><code>ALU</code> — 运算单元</p></li>\r\n<li><p><code>Control</code> — 控制单元</p></li>\r\n<li><p><code>Cache</code> — 高速缓存（<code>CPU</code>和内存之间的中介桥梁），进行高速数据交换的存储器</p></li>\r\n<li><p><code>DRAM</code>— 进行短暂存储的存储器，易失性存储器（电源开启时数据存在，断开电源数据消失）</p></li>\r\n</ul>\r\n<p>可以看出 <code>CPU</code><strong>是基于低延迟设计</strong> 的。因为它有<strong>特别大的缓存空间可以降低延时</strong>，可以保存较多数据在缓存里面，当需要访问的这些数据时，只要在之前访问过的，现在直接在缓存里面取即可。</p>\r\n<p>此外，<code>CPU</code>具有复杂的控制单元。例如当程序含有多个分支的时候，它可以通过提供分支预测的能力来降低延时。再比如在数据转发时，当一些指令依赖前面的指令结果时，数据转发的逻辑控制单元决定这些指令在<code>pipeline</code>中的位置并且尽可能快的转发一个指令的结果给后续的指令。这些动作需要很多的对比电路单元和转发电路单元。</p>\r\n<p>因为<code>CPU</code>的架构中需要大量的空间去放置存储单元和控制单元，相比之下计算单元只占据了很小的一部分，所以它在大规模并行计算能力上极受限制，而更擅长于逻辑控制。</p>\r\n<h3 id=\"gpu-架构\">1.4.2 <code>GPU</code> 架构</h3>\r\n<p><img src=\"GPU%20Arch.png\" /></p>\r\n<p><code>GPU</code>的结构里有大量的<code>ALU</code>（计算单元）单元和很少的<code>Cache</code>（缓存）。</p>\r\n<p><code>GPU</code>的<code>Cache</code>不是像<code>CPU</code>那样保存后面需要访问的数据的，它是为<code>thread</code>（线程）提供服务的。如果有很多线程需要访问同一个相同的数据，缓存会合并这些访问，然后再去访问<code>dram</code>（因为需要访问的数据保存在<code>dram</code>中而不是<code>cache</code>里面），获取数据后<code>cache</code>会转发这个数据给对应的线程，这个时候<code>Cache</code>是作为数据转发的角色。但是由于需要访问<code>dram</code>，自然会带来延时的问题。</p>\r\n<p><code>GPU</code>的工作大部分都计算量大，但没什么技术含量，而且要<strong>重复很多很多次</strong>。也就是说，<code>GPU</code>是用很多简单的计算单元去完成大量的计算任务，纯粹的人海战术。所以<code>GPU</code>的计算特点就是<strong>超长的流水线</strong>和<strong>并行计算</strong>。显然，<code>GPU</code>是基于高吞吐量设计的。</p>\r\n<h2 id=\"串行计算和并行计算\">1.5 串行计算和并行计算</h2>\r\n<p>串行计算可以看成是将某个任务分解成一系列小任务，把这些小任务一一完成。在串行计算时，我们的想法就是让处理器每次处理一个计算任务，处理完一个计算任务后再计算下一个任务，直到所有小任务都完成了，那么这个大的程序任务也就完成了。<code>CPU</code> 的每个核心自身能力极强，处理任务上非常强悍，但是他核心少，所以 <code>CPU</code> 特别擅长串行计算。</p>\r\n<p><img src=\"sol.png\" /></p>\r\n<p>当我们可以利用多核处理器同时处理多个任务时，为了进一步加快大任务的计算速度，我们可以把一些小任务分配到不同的处理器上进行同时计算，最后再将这些结果进行整合，完成一次任务计算。<code>GPU</code>的每个核心的计算能力不如<code>CPU</code>，但是它核心非常多，可同时处理多个计算任务，所以<code>GPU</code>擅长并行计算。</p>\r\n<p><img src=\"par.png\" /></p>\r\n<p>所以，要加快程序的运行速度，可以先分析程序中哪些部分是强耦合的，哪些部分是相对独立的，对于强耦合的部分可以使用串行计算，而对于相对独立的部分，则可以充分利用多核处理器的优势进一步加速我们的计算任务，使用并行计算加快计算速度。因此，利用串行+并行的编程思路即可完成一次高性能计算，也就是充分利用<code>CPU</code>和<code>GPU</code>的优势来使程序性能得到优化。</p>\r\n<h1 id=\"二-cuda-模型\">二、 <code>CUDA</code> 模型</h1>\r\n<h2 id=\"cuda-程序执行过程\">2.1 <code>CUDA</code> 程序执行过程</h2>\r\n<p>典型的<code>CUDA</code>程序实现流程如下：</p>\r\n<ol type=\"1\">\r\n<li>把数据从<code>CPU</code>内存拷贝到<code>GPU</code>内存；</li>\r\n<li>调用核函数对存储在<code>GPU</code>内存中的数据进行操作；</li>\r\n<li>将数据从<code>GPU</code>内存传送到<code>CPU</code>内存。</li>\r\n</ol>\r\n<p><img src=\"cuda1.png\" /></p>\r\n<h2 id=\"cuda-线程模型\">2.2 <code>CUDA</code> 线程模型</h2>\r\n<p><code>kernel</code>在<code>device</code>上执行时实际上是启动很多线程，一个<code>kernel</code>所启动的所有线程称为一个网格（<code>grid</code>），同一个网格上的线程共享相同的全局内存空间，<code>grid</code>是线程结构的第一层次，而网格又可以分为很多线程块（<code>block</code>），一个线程块里面包含很多线程，这是第二个层次。</p>\r\n<p><img src=\"thread.png\" /></p>\r\n<p>理想的主机端的串行代码只负责上一个<code>kernel</code>函数的清理和为下一个<code>kernel</code>函数进行准备，这样可以充分发挥<code>GPU</code>的高效运算能力，减少内存和显存之间传递数据的开销。但是在实践中一般无法将所有的计算任务交给设备端处理，主机端的串行代码中还应包含一些并行度较小的计算任务。</p>\r\n<h2 id=\"cuda-内存模型\">2.3 <code>CUDA</code> 内存模型</h2>\r\n<p><code>CUDA</code>编程模型本质是从<code>GPU</code>架构中抽象出的一个内存层次结构，通过在<code>CUDA</code>上进行开发可以对<code>GPU</code>不同的内存层次进行处理。由于<code>LRC</code>码在编解码的过程中会进行数据的分组分割，需要对原始数据块进行存储处理等操作，为了加快<code>LRC</code>码的编解码性能，可以将分割分组后的数据存储到<code>GPU</code>的不同内存层次中去，这一点可以利用<code>CUDA</code>编程实现。因此，对于<code>CUDA</code>模型中不同的内存层次结构的了解很有必要。</p>\r\n<p>在设备端全局内存类似于<code>CPU</code>的系统内存，具有存储空间大但是内存带宽低、时延较高的特点，而共享内存则类似于<code>CPU</code>的缓存，具有的存储空间比线程自带的寄存器空间要大且拥有高内存带宽以及低时延。其中，<code>GPU</code>的共享内存可以由<code>CUDA_C</code>的内核直接控制。</p>\r\n<p><img src=\"memory.png\" /></p>\r\n<p>上图即为 <code>CUDA</code> 内存模型，前文已经介绍过 <code>Grid - Block - Thread</code> 的线程结构，在内存模型中，一个 <code>Grid</code> 中的所有 <code>Block</code> 的线程可以共享访问 <strong>全局内存</strong> 、 <strong>常量内存</strong> 、 <strong>纹理内存</strong> 的数据，在一个 <code>Block</code> 中，所有线程 <code>Thread</code> 可以共享访问 <strong>本地内存</strong> （<strong>共享内存</strong>）的数据。</p>\r\n<h1 id=\"三-cuda-核函数\">三、 <code>CUDA</code> 核函数</h1>\r\n<p>假如我们要计算 <code>10000</code> 个 <code>0</code> 到 <code>9</code> 的随机数立方和，用 <code>C</code> 写应该是这样：</p>\r\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 1.c</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;time.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> DATA_SIZE 10000</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// generate random number</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">GenerateFunc</span><span class=\"params\">(<span class=\"keyword\">int</span>* dat, <span class=\"keyword\">int</span> size)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; size; ++i) &#123;</span><br><span class=\"line\">        dat[i] = rand() % <span class=\"number\">10</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">getRes</span><span class=\"params\">(<span class=\"keyword\">int</span>* dat, <span class=\"keyword\">int</span> size)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> ret = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; size; ++i) &#123;</span><br><span class=\"line\">        ret += dat[i] * dat[i] * dat[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ret;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    srand(time(<span class=\"literal\">NULL</span>));</span><br><span class=\"line\">    <span class=\"keyword\">int</span> data[DATA_SIZE];</span><br><span class=\"line\">    GenerateFunc(data, DATA_SIZE);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> ret = getRes(data, DATA_SIZE);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;ret = %d\\n&quot;</span>, ret);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p>那么我们如何让这个工作在显卡上完成呢？首先第一件事很显而易见，这些数字不能放在内存里了，而是要复制到<code>GPU</code>的显存上。</p>\r\n<p>前文已经介绍过，在 <code>CUDA</code>的架构下，一个程序分为两个部份：<code>host</code>端和 <code>device</code>端。<code>Host</code>端是指在 <code>CPU</code>上执行的部份，而 <code>device</code>端则是在显示芯片上执行的部份。<code>Device</code>端的程序又称为 <code>kernel</code>。通常 <code>host</code>端程序会将数据准备好后，复制到显卡的内存中，再由显示芯片执行 <code>device</code>端程序，完成后再由 <code>host</code>端程序将结果从显卡的内存中取回。</p>\r\n<p>我们需要把产生的数据复制到<code>Device</code>端的<code>RAM</code>，才能在显卡上完成计算，因此我们首先开辟一块合适的显存，然后把随机数从内存复制进去。</p>\r\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*把数据复制到显卡内存中*/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span>* gpudata, *result;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//cudaMalloc 取得一块显卡内存 ( 其中result用来存储计算结果 )</span></span><br><span class=\"line\">cudaMalloc((<span class=\"keyword\">void</span>**)&amp;gpudata, <span class=\"keyword\">sizeof</span>(<span class=\"keyword\">int</span>)* DATA_SIZE);</span><br><span class=\"line\">cudaMalloc((<span class=\"keyword\">void</span>**)&amp;result, <span class=\"keyword\">sizeof</span>(<span class=\"keyword\">int</span>));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//cudaMemcpy 将产生的随机数复制到显卡内存中 </span></span><br><span class=\"line\"><span class=\"comment\">//cudaMemcpyHostToDevice - 从内存复制到显卡内存</span></span><br><span class=\"line\"><span class=\"comment\">//cudaMemcpyDeviceToHost - 从显卡内存复制到内存</span></span><br><span class=\"line\">cudaMemcpy(gpudata, data, <span class=\"keyword\">sizeof</span>(<span class=\"keyword\">int</span>)* DATA_SIZE,cudaMemcpyHostToDevice);</span><br></pre></td></tr></table></figure>\r\n<p><code>cudaMalloc</code>和 <code>cudaMemcpy</code>的用法和一般的 <code>malloc</code>及 <code>memcpy</code>类似，不过 <code>cudaMemcpy</code>则多出一个参数，指示复制内存的方向。在这里因为是从主内存复制到显卡内存，所以使用 <code>cudaMemcpyHostToDevice</code>。如果是从显卡内存到主内存，则使用<code>cudaMemcpyDeviceToHost</code>。</p>\r\n<p>完成了从内存到显存的数据拷贝之后，我们接下来就要在显卡上完成计算了。</p>\r\n<p><code>CUDA</code> 核函数就是要写在显示芯片上执行的程序。在 <code>CUDA</code>中，在函数前面加上<code>__global__</code> 表示这个函式是要在显示芯片上执行的,所以我们只要在正常函数之前加上一个<code>__global__</code>就行了：</p>\r\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">__global__ <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">getRes</span><span class=\"params\">(<span class=\"keyword\">int</span>* dat, <span class=\"keyword\">int</span>* res)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; DATA_SIZE; i++) &#123;</span><br><span class=\"line\">        sum += dat[i] * dat[i] * dat[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    *res = sum;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p>可以看到，在 <code>C</code> 源代码中该接口是以 <code>int</code> 型返回的，但是这里的返回值是 <code>void</code> ，需要注意，所有在 <code>device</code> 端执行的代码，即前缀包含 <code>__global__</code> 的接口必须以 <code>void</code> 返回，也就是无返回值，所有需要返回的数据都要在参数列表中以参数的形式传入和修改。</p>\r\n<p>写好核函数之后需要让<code>CUDA</code>执行这个函数。在 <code>CUDA</code>中，要执行一个核函数，使用以下的语法：</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\">functionName&lt;&lt;&lt;blockNum, threadNum, shared_memory_size&gt;&gt;&gt;(args...);</span><br></pre></td></tr></table></figure>\r\n<p>例如，我们令 <code>block</code> 数量为 <code>1</code> ，每个 <code>block</code> 中的 <code>thread</code> 数量为 <code>1</code>，不使用共享内存，则调用核函数的接口的方式为：</p>\r\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\">getRes&lt;&lt;&lt;<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>&gt;&gt;&gt;(gpudata, result);</span><br></pre></td></tr></table></figure>\r\n<p>很显然，令 <code>block</code> 数量为 <code>1</code> ，每个 <code>block</code> 中的 <code>thread</code> 数量为 <code>1</code>，不使用共享内存，这样的话就是单纯的让单个线程完成计算，没有涉及到多线程并行计算。计算完了，千万别忘了还要<strong>把结果从显示芯片复制回主内存上</strong>，然后<strong>释放掉内存</strong>。</p>\r\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> sum;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//cudaMemcpy -- copy result from device to host</span></span><br><span class=\"line\">cudaMemcpy(&amp;sum, result, <span class=\"keyword\">sizeof</span>(<span class=\"keyword\">int</span>), cudaMemcpyDeviceToHost);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Free memory</span></span><br><span class=\"line\">cudaFree(gpudata);</span><br><span class=\"line\">cudaFree(result);</span><br></pre></td></tr></table></figure>\r\n<p>完整程序：</p>\r\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\">//CUDA RunTime API</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;cuda_runtime.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> DATA_SIZE 10000</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> data[DATA_SIZE];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">GenerateFunc</span><span class=\"params\">(<span class=\"keyword\">int</span>* dat, <span class=\"keyword\">int</span> size)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; size; ++i) &#123;</span><br><span class=\"line\">        dat[i] = rand() % <span class=\"number\">10</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//CUDA 初始化</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">bool</span> <span class=\"title\">InitCUDA</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> count;</span><br><span class=\"line\">    <span class=\"comment\">//取得支持Cuda的装置的数目</span></span><br><span class=\"line\">    cudaGetDeviceCount(&amp;count);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (count == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">&quot;There is no device.\\n&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; count; i++) &#123;</span><br><span class=\"line\">        cudaDeviceProp prop;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (cudaGetDeviceProperties(&amp;prop, i) == cudaSuccess) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (prop.major &gt;= <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (i == count) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">&quot;There is no device supporting CUDA 1.x.\\n&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cudaSetDevice(i);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">__global__ <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">getRes</span><span class=\"params\">(<span class=\"keyword\">int</span>* dat, <span class=\"keyword\">int</span>* res)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; DATA_SIZE; i++) &#123;</span><br><span class=\"line\">        sum += dat[i] * dat[i] * dat[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    *res = sum;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//CUDA 初始化</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!InitCUDA()) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    GenerateNumbers(data, DATA_SIZE);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">int</span>* gpudata, *result;</span><br><span class=\"line\">    cudaMalloc((<span class=\"keyword\">void</span>**)&amp;gpudata, <span class=\"keyword\">sizeof</span>(<span class=\"keyword\">int</span>)* DATA_SIZE);</span><br><span class=\"line\">    cudaMalloc((<span class=\"keyword\">void</span>**)&amp;result, <span class=\"keyword\">sizeof</span>(<span class=\"keyword\">int</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">    cudaMemcpy(gpudata, data, <span class=\"keyword\">sizeof</span>(<span class=\"keyword\">int</span>)* DATA_SIZE, cudaMemcpyHostToDevice);</span><br><span class=\"line\">    sumOfSquares &lt;&lt;&lt;<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>&gt;&gt;&gt;(gpudata, result);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">int</span> sum;</span><br><span class=\"line\"></span><br><span class=\"line\">    cudaMemcpy(&amp;sum, result, <span class=\"keyword\">sizeof</span>(<span class=\"keyword\">int</span>), cudaMemcpyDeviceToHost);</span><br><span class=\"line\"></span><br><span class=\"line\">    cudaFree(gpudata);</span><br><span class=\"line\">    cudaFree(result);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;GPU result: %d\\n&quot;</span>, sum);</span><br><span class=\"line\"></span><br><span class=\"line\">    sum = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; DATA_SIZE; i++) &#123;</span><br><span class=\"line\">        sum += data[i] * data[i] * data[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;CPU result: %d\\n&quot;</span>, sum);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"四-核函数运行参数\">四、 核函数运行参数</h1>\r\n<p>上一个部分介绍了核函数的一种调用形式：</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\">functionName&lt;&lt;&lt;blockNum, threadNum, shared_memory_size&gt;&gt;&gt;(args...);</span><br></pre></td></tr></table></figure>\r\n<p>其中 <code>&lt;&lt;&lt; &gt;&gt;&gt;</code> 标识了核函数的启动方式。实际上，当我们定义了核函数，并将其标识为 <code>__global__</code> 后：</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">__global__ <span class=\"keyword\">void</span> <span class=\"title\">kernel</span><span class=\"params\">(param1, ...)</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>\r\n<p>在主机端调用时应采用如下的形式：</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\">kernel&lt;&lt;&lt;Dg, Db, Ns, S&gt;&gt;&gt;(param1, ...);</span><br></pre></td></tr></table></figure>\r\n<p>其中：</p>\r\n<ul>\r\n<li><code>Dg</code> 是 <code>dim3</code> 类型的， <code>dim3</code> 即基于 <code>unsigned int</code> 定义的矢量类型，实质上是 <code>3</code> 个 <code>unsigned int</code> 组成的结构体，用来定义 <code>grid</code> 的维度和尺寸，即 <code>grid</code> 每行有 <code>Dg.x</code> 个 <code>block</code> ，每列有 <code>Dg.y</code> 个 <code>block</code> ，高度为 <code>Dg.z</code> ；</li>\r\n<li><code>Db</code> 是 <code>dim3</code> 类型的，用来定义 <code>block</code> 的维度和尺寸，即 <code>block</code> 每行有 <code>Db.x</code> 个 <code>thread</code> ，每列有 <code>Db.y</code> 个 <code>thread</code> ，高度为 <code>Db.z</code> ；</li>\r\n<li><code>Ns</code>： <code>size_t</code> 类型，可缺省，默认为 <code>0</code> 。 用于设置每个 <code>block</code> 除了静态分配的共享内存外，最多能动态分配的共享内存大小，单位为 <code>byte</code> 。 <code>0</code> 表示不需要动态分配；</li>\r\n<li><code>S</code>： <code>cudaStream_t</code> 类型，可缺省，默认为 <code>0</code> 。 表示该核函数位于哪个流。</li>\r\n</ul>\r\n<p>前面已经介绍了 <code>GPU</code> 的线程结构，结合之前的线程结构更容易理解。</p>\r\n<h2 id=\"核函数举例之矢量相加\">4.1 核函数举例之矢量相加</h2>\r\n<h3 id=\"一维-grid-一维-block\">4.1.1 一维 <code>grid</code> ，一维 <code>block</code></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">__global__ <span class=\"keyword\">void</span> <span class=\"title\">addKernel_G1_B1</span><span class=\"params\">(<span class=\"keyword\">int</span>* ret, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* a, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// grid  -- 1-dim</span></span><br><span class=\"line\">    <span class=\"comment\">// block -- 1-dim</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> tid = blockIdx.x * blockDim.x + threadIdx.x;</span><br><span class=\"line\">    ret[tid] = a[tid] + b[tid];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"一维-grid-二维-block\">4.1.2 一维 <code>grid</code> ，二维 <code>block</code></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">__global__ <span class=\"keyword\">void</span> <span class=\"title\">addKernel_G1_B2</span><span class=\"params\">(<span class=\"keyword\">int</span>* ret, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* a, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// grid  -- 1-dim</span></span><br><span class=\"line\">    <span class=\"comment\">// block -- 2-dim</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> tid = blockIdx.x * blockDim.x * blockDim.y + threadIdx.y * blockDim.x + threadIdx.x;</span><br><span class=\"line\">    ret[tid] = a[tid] + b[tid];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"一维-grid-三维-block\">4.1.3 一维 <code>grid</code> ，三维 <code>block</code></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">__global__ <span class=\"keyword\">void</span> <span class=\"title\">addKernel_G1_B2</span><span class=\"params\">(<span class=\"keyword\">int</span>* ret, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* a, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// grid  -- 1-dim</span></span><br><span class=\"line\">    <span class=\"comment\">// block -- 3-dim</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> tid = blockIdx.x * blockDim.x * blockDim.y * blockDim.z</span><br><span class=\"line\">            + threadIdx.z * blockDim.y * blockDim.x</span><br><span class=\"line\">            + threadIdx.y * blockDim.x</span><br><span class=\"line\">            + threadIdx.x;</span><br><span class=\"line\">    ret[tid] = a[tid] + b[tid];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"二维-grid-一维-block\">4.1.4 二维 <code>grid</code> ，一维 <code>block</code></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">__global__ <span class=\"keyword\">void</span> <span class=\"title\">addKernel_G2_B1</span><span class=\"params\">(<span class=\"keyword\">int</span>* ret, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* a, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// grid  -- 2-dim</span></span><br><span class=\"line\">    <span class=\"comment\">// block -- 1-dim</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> bid = blockIdx.y * gridDim.x + blockIdx.x;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> tid = bid * blockDim.x + threadIdx.x;</span><br><span class=\"line\">    ret[tid] = a[tid] + b[tid];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"二维-grid-二维-block\">4.1.5 二维 <code>grid</code> ，二维 <code>block</code></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">__global__ <span class=\"keyword\">void</span> <span class=\"title\">addKernel_G2_B2</span><span class=\"params\">(<span class=\"keyword\">int</span>* ret, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* a, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// grid  -- 2-dim</span></span><br><span class=\"line\">    <span class=\"comment\">// block -- 2-dim</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> bid = blockIdx.y * gridDim.x + blockIdx.x;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> tid = bid * (blockDim.x * blockDim.y) + (threadIdx.y * blockDim.x) + threadIdx.x;</span><br><span class=\"line\">    ret[tid] = a[tid] + b[tid];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"二维-grid-三维-block\">4.1.6 二维 <code>grid</code> ，三维 <code>block</code></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">__global__ <span class=\"keyword\">void</span> <span class=\"title\">addKernel_G2_B3</span><span class=\"params\">(<span class=\"keyword\">int</span>* ret, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* a, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// grid  -- 2-dim</span></span><br><span class=\"line\">    <span class=\"comment\">// block -- 3-dim</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> bid = blockIdx.y * gridDim.x + blockIdx.x;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> tid = bid * (blockDim.x * blockDim.y * blockDim.z)</span><br><span class=\"line\">            + threadIdx.z * (blockDim.y * blockDim.x)</span><br><span class=\"line\">            + threadIdx.y * blockDim.x</span><br><span class=\"line\">            + threadIdx.x;</span><br><span class=\"line\">    ret[tid] = a[tid] + b[tid];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"三维-grid-一维-block\">4.1.7 三维 <code>grid</code> ，一维 <code>block</code></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">__global__ <span class=\"keyword\">void</span> <span class=\"title\">addKernel_G3_B1</span><span class=\"params\">(<span class=\"keyword\">int</span>* ret, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* a, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// grid  -- 3-dim</span></span><br><span class=\"line\">    <span class=\"comment\">// block -- 1-dim</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> bid = blockIdx.z * gridDim.x * gridDim.y + blockIdx.y * gridDim.x + blockIdx.x;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> tid = bid * blockDim.x + threadIdx.x;</span><br><span class=\"line\">    ret[tid] = a[tid] + b[tid];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"三维-grid-二维-block\">4.1.8 三维 <code>grid</code> ，二维 <code>block</code></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">__global__ <span class=\"keyword\">void</span> <span class=\"title\">addKernel_G3_B2</span><span class=\"params\">(<span class=\"keyword\">int</span>* ret, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* a, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// grid  -- 3-dim</span></span><br><span class=\"line\">    <span class=\"comment\">// block -- 2-dim</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> bid = blockIdx.z * gridDim.x * gridDim.y + blockIdx.y * gridDim.x + blockIdx.x;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> tid = bid * (blockDim.x * blockDim.y) + (threadIdx.y * blockDim.x) + threadIdx.x;</span><br><span class=\"line\">    ret[tid] = a[tid] + b[tid];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"三维-grid-三维-block\">4.1.9 三维 <code>grid</code> ，三维 <code>block</code></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">__global__ <span class=\"keyword\">void</span> <span class=\"title\">addKernel_G3_B3</span><span class=\"params\">(<span class=\"keyword\">int</span>* ret, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* a, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// grid  -- 3-dim</span></span><br><span class=\"line\">    <span class=\"comment\">// block -- 3-dim</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> bid = blockIdx.z * gridDim.x * gridDim.y + blockIdx.y * gridDim.x + blockIdx.x;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> tid = bid * (blockDim.x * blockDim.y * blockDim.z)</span><br><span class=\"line\">            + threadIdx.z * (blockDim.y * blockDim.x)</span><br><span class=\"line\">            + threadIdx.y * blockDim.x</span><br><span class=\"line\">            + threadIdx.x;</span><br><span class=\"line\">    ret[tid] = a[tid] + b[tid];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"任务调度\">4.2 任务调度</h2>\r\n<p>以上面的 <code>addKernel_G1_B1</code> 为例：</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">__global__ <span class=\"keyword\">void</span> <span class=\"title\">addKernel_G1_B1</span><span class=\"params\">(<span class=\"keyword\">int</span>* ret, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* a, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// grid  -- 1-dim</span></span><br><span class=\"line\">    <span class=\"comment\">// block -- 1-dim</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> tid = blockIdx.x * blockDim.x + threadIdx.x;</span><br><span class=\"line\">    ret[tid] = a[tid] + b[tid];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">addKernel_G1_B1&lt;&lt;&lt;<span class=\"number\">1</span>, size&gt;&gt;&gt;(dev, dev_a, dev_b);</span><br></pre></td></tr></table></figure>\r\n<p>当 <code>size &gt; 1024</code> 时，矢量会过长，因为一个 <code>block</code> 能容纳的线程数至多为 <code>1024</code> 。于是我们可以采用多个线程块来解决线程不足的问题。 假如我们设定每个线程块包含 <code>128</code> 个线程，则需要的线程块的数量为 <code>size / 128</code> 。 为了避免不能整除带来的问题，我们可以稍微多开一点 <code>(size + 127) / 128</code> ，但需要增加判断条件来避免越界。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">__global__ <span class=\"keyword\">void</span> <span class=\"title\">addKernel</span><span class=\"params\">(<span class=\"keyword\">int</span>* ret, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* a, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* b, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span> size)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> tid = blockIdx.x * blockDim.x + threadIdx.x;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tid &lt; size)</span><br><span class=\"line\">        c[tid] = a[tid] + b[tid];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 运行核函数，运行设置为多个block，每个block中128个线程</span></span><br><span class=\"line\">addKernel &lt;&lt;&lt;(size + <span class=\"number\">127</span>) / <span class=\"number\">128</span>, <span class=\"number\">128</span> &gt;&gt;&gt;(dev, dev_a, dev_b, size);</span><br></pre></td></tr></table></figure>\r\n<p>如果数据量大于 <code>Block_num * Thread_num</code>，那么我们就无法为每个分量单独分配一个线程了。 不过，一个简单的解决办法就是在核函数中增加循环。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">__global__ <span class=\"keyword\">void</span> <span class=\"title\">addKernel</span><span class=\"params\">(<span class=\"keyword\">int</span>* ret, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* a, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span>* b, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span> size)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> tid = blockIdx.x * blockDim.x + threadIdx.x; </span><br><span class=\"line\">    <span class=\"keyword\">while</span> (tid &lt; size)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        c[tid] = a[tid] + b[tid];</span><br><span class=\"line\">        <span class=\"comment\">// 偏移分量等于一个Grid中包含的线程数量</span></span><br><span class=\"line\">        tid += blockDim.x * gridDim.x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 运行核函数，运行设置为1个Grid包含128个block，每个block包含128个线程</span></span><br><span class=\"line\"><span class=\"comment\">// 其中已经假设 size &gt; 128*128</span></span><br><span class=\"line\">addKernel&lt;&lt;&lt;<span class=\"number\">128</span>, <span class=\"number\">128</span>&gt;&gt;&gt;(dev, dev_a, dev_b, size);</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"线程同步\">4.3 线程同步</h2>\r\n<p>同一个 <code>Block</code> 中的线程可以访问一块共享内存。由于共享内存缓冲区驻留在物理 <code>GPU</code> 上（片上内存），而不是 <code>GPU</code> 之外的系统内存（片外内存）上，因此访问共享内存的延迟要远远低于访问普通缓冲区的延迟。</p>\r\n<p>不同 <code>Block</code> 之间存在隔离，如果我们需要不同线程之间进行通信，那么还需要考虑线程同步的问题。比如线程<code>1</code> 将某个数值写入内存，然后线程 <code>2</code> 会对该数值进行一些操作，那么显然必须等 <code>1</code> 完成之后 <code>2</code> 才可以操作，如果没有同步，程序将会因进入“竞态条件”而产生意想不到的错误。</p>\r\n<p>举个栗子：</p>\r\n<p>求向量点积，如四维向量的点积为： <span class=\"math display\">\\[\r\n(x_1, x_2, x_3, x_4)\\cdot (y_1, y_2, y_3, y_4)=x_1y_1 + x_2y_2 + x_3y_3 + x_4y_4\r\n\\]</span> 现在假设进行点积运算的两个向量的长度为 <code>33 * 1024</code> ，使用 <code>32</code> 个线程块，每个线程块使用 <code>256</code> 个线程。</p>\r\n<h3 id=\"step-1.-申请共享内存\">Step 1. 申请共享内存</h3>\r\n<p>首先申请共享内存，例如申请一个数组 <code>cache</code> ：</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\">__shared__ <span class=\"keyword\">int</span> cache[threadsPerBlock];</span><br></pre></td></tr></table></figure>\r\n<p>我们需要明白的是，一旦这样声明数组，就会创建与线程块的数量相同的数组 <code>cache</code> ，即每个线程块都会对应一个这样的数组 <code>cache</code> 。我们都知道，共享内存是用于同一个线程块内的线程之间交流的，不同线程块之间是无法通过共享内存进行交流的。另外，数组 <code>cache</code> 的大小是每个线程块中线程的个数，即线程块的大小。</p>\r\n<h3 id=\"step-2.-分析每个线程的工作\">Step 2. 分析每个线程的工作</h3>\r\n<p>如果向量长度不是特别长(假设大小等于总线程个数)的话，每个线程只需要工作一次，即计算两个元素的积并保存在中间变量 <code>temp</code> 里。但是实际计算过程中由于向量长度过长，一次计算可能会计算不完，每个线程需要多次计算才能完成所有工作，因此 <code>temp</code> 保存的值可能为多个元素乘积之和。</p>\r\n<p>假设数组大小为 <code>16</code> ，线程总数为 <code>4</code> 。此时一次并行是无法完成工作的，所以需要多次并行，即每个线程需要做四次工作才可完成计算。</p>\r\n<p>那么相应的代码如下：</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> tid = threadIdx.x + blockIdx.x * blockDim.x;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> tmp = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">while</span> (tid &lt; N) &#123;</span><br><span class=\"line\">    tmp += a[tid] * b[tid];</span><br><span class=\"line\">    tid += blockDim.x * gridDim.x;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p>如果你已经理解了上面这个过程，那么你也应该会明白每个线程块移动的步长为什么是总线程的个数了，即 <code>tid += blockDim.x * gridDim.x</code> 这段代码。</p>\r\n<h3 id=\"step-3.-多线程协同\">Step 3. 多线程协同</h3>\r\n<p>要让多线程协同工作，就需要使用到共享内存。每个线程将 <code>tmp</code> 的值保存到每个线程块的共享内存( <code>shared memory</code> )中，即数组 <code>cache</code> 中：</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\">cache[cacheIdx] = tmp;</span><br><span class=\"line\">__syncthreads();</span><br></pre></td></tr></table></figure>\r\n<p>这样每个线程块中对应的数组 <code>cache</code> 保存的就是每个线程的计算结果。为了节省带宽，这里又采用了并行计算中常用的归约算法，来计算数组中所有值之和，并保存在第一个元素( <code>cache[0]</code> )内。这样每个线程就通过共享内存( <code>shared memory</code> )进行数据交流了。具体代码如下所示：</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//归约算法将每个线程块上的cache数组归约为一个值cache[0]，最终保存在数组c里</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> i = blockDim.x /<span class=\"number\">2</span>;</span><br><span class=\"line\"><span class=\"keyword\">while</span> (i != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cacheIndex &lt; i) &#123;</span><br><span class=\"line\">        cache[cacheIndex] += cache[cacheIndex + i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    __syncthreads();</span><br><span class=\"line\"></span><br><span class=\"line\">    i /= <span class=\"number\">2</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"step-4.-保存结果\">Step 4. 保存结果</h3>\r\n<p>现在每个线程块的计算结果已经保存到每个共享数组 <code>cache</code> 的第一个元素 <code>cache[0]</code> 中，这样可以大大节省带宽。下面就需要将这些归约结果保存到全局内存( <code>global memory</code> )中。</p>\r\n<p>观察核函数你会发现有一个传入参数——数组 <code>ret</code> 。这个数组是位于全局内存中，每次使用线程块中线程 <code>ID</code> 为 <code>0</code> 的线程来将每个线程块的归约结果保存到该数组中，注意这里每个线程块中的结果保存到数组 <code>ret</code> 中与之相对应的位置，即 <code>c[blockIdx.x]</code>。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (cacheIdx == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    ret[blockIdx.x] = cache[<span class=\"number\">0</span>];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"step-5.-完整代码\">Step 5. 完整代码</h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&quot;cuda_runtime.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">33</span> * <span class=\"number\">1024</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> threadsPerBlock = <span class=\"number\">256</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> blocksPerGrid = <span class=\"number\">32</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// kernel</span></span><br><span class=\"line\"><span class=\"function\">__global__ <span class=\"keyword\">void</span> <span class=\"title\">dot</span><span class=\"params\">(<span class=\"keyword\">int</span>* ret, <span class=\"keyword\">int</span>* a, <span class=\"keyword\">int</span>* b)</span> </span>&#123;</span><br><span class=\"line\">    __shared__ <span class=\"keyword\">int</span> cache[threadsPerBlock];</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">int</span> tid = blockIdx.x * blockDim.x + threadIdx.x;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">int</span> cacheIdx = threadIdx.x;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">int</span> tmp = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (tid &lt; N) &#123;</span><br><span class=\"line\">        tmp += a[tid] * b[tid];</span><br><span class=\"line\">        tid += gridDim.x * blockDim.x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    cache[cacheIdx] = tmp;</span><br><span class=\"line\">    </span><br><span class=\"line\">    __syncthreads();</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// int i = threadsPerBlock / 2;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> i = blockDim.x / <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (i != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (cacheIdx &lt; i) &#123;</span><br><span class=\"line\">            cache[cacheIdx] += cache[cacheIdx + i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        __syncthreads();</span><br><span class=\"line\">        i /= <span class=\"number\">2</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cacheIdx == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        ret[blockIdx.x] = cache[<span class=\"number\">0</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// main</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span>* a = (<span class=\"keyword\">int</span> *)<span class=\"built_in\">malloc</span>(N * <span class=\"built_in\"><span class=\"keyword\">sizeof</span></span>(<span class=\"keyword\">int</span>));</span><br><span class=\"line\">    <span class=\"keyword\">int</span>* b = (<span class=\"keyword\">int</span> *)<span class=\"built_in\">malloc</span>(N * <span class=\"built_in\"><span class=\"keyword\">sizeof</span></span>(<span class=\"keyword\">int</span>));</span><br><span class=\"line\">    <span class=\"keyword\">int</span>* ret = (<span class=\"keyword\">int</span> *)<span class=\"built_in\">malloc</span>(blocksPerGrid * <span class=\"built_in\"><span class=\"keyword\">sizeof</span></span>(<span class=\"keyword\">int</span>));</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// initialize a and b</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">size_t</span> i = <span class=\"number\">0</span>; i &lt; N; ++i) &#123;</span><br><span class=\"line\">        a[i] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        b[i] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">int</span>* dev_a = <span class=\"literal\">nullptr</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span>* dev_b = <span class=\"literal\">nullptr</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span>* dev_ret = <span class=\"literal\">nullptr</span>;</span><br><span class=\"line\">    <span class=\"built_in\">cudaMalloc</span>((<span class=\"keyword\">void</span>**)&amp;dev_a, N * <span class=\"built_in\"><span class=\"keyword\">sizeof</span></span>(<span class=\"keyword\">int</span>));</span><br><span class=\"line\">    <span class=\"built_in\">cudaMalloc</span>((<span class=\"keyword\">void</span>**)&amp;dev_b, N * <span class=\"built_in\"><span class=\"keyword\">sizeof</span></span>(<span class=\"keyword\">int</span>));</span><br><span class=\"line\">    <span class=\"built_in\">cudaMalloc</span>((<span class=\"keyword\">void</span>**)&amp;dev_ret, blocksPerGrid * <span class=\"built_in\"><span class=\"keyword\">sizeof</span></span>(<span class=\"keyword\">int</span>));</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// CPU -&gt; GPU(host -&gt; device)</span></span><br><span class=\"line\">    <span class=\"built_in\">cudaMemcpy</span>(dev_a, a, N * <span class=\"built_in\"><span class=\"keyword\">sizeof</span></span>(<span class=\"keyword\">int</span>), cudaMemcpyHostToDevice);</span><br><span class=\"line\">    <span class=\"built_in\">cudaMemcpy</span>(dev_b, b, N * <span class=\"built_in\"><span class=\"keyword\">sizeof</span></span>(<span class=\"keyword\">int</span>), cudaMemcpyHostToDevice);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// kernel calculate</span></span><br><span class=\"line\">    dot&lt;&lt;&lt;<span class=\"number\">32</span>, <span class=\"number\">256</span>&gt;&gt;&gt;(dev_ret, dev_a, dev_b);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// GPU -&gt; CPU(device -&gt; host)</span></span><br><span class=\"line\">    <span class=\"built_in\">cudaMemcpy</span>(ret, dev_ret, blocksPerGrid * <span class=\"built_in\"><span class=\"keyword\">sizeof</span></span>(<span class=\"keyword\">int</span>), cudaMemcpyDeviceToHost);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">size_t</span> i = <span class=\"number\">1</span>; i &lt; blocksPerGrid; ++i) &#123;</span><br><span class=\"line\">        ret[<span class=\"number\">0</span>] += ret[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    std::cout &lt;&lt; <span class=\"string\">&quot;The answer is : &quot;</span> &lt;&lt; ret[<span class=\"number\">0</span>] &lt;&lt; std::endl;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// free memory</span></span><br><span class=\"line\">    <span class=\"built_in\">cudaFree</span>(dev_a);</span><br><span class=\"line\">    <span class=\"built_in\">cudaFree</span>(dev_b);</span><br><span class=\"line\">    <span class=\"built_in\">cudaFree</span>(dev_ret);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","categories":["CUDA"],"tags":["CUDA"]},{"title":"生成随机的合法身份证号","url":"/2022/03/11/ID-generate/","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><p>这是一个很早就有的想法，在三月份左右我看到过一道类似于判断身份证号是否合法的一道简单的题，然后就想着能不能通过这个校验方式来获取随机的身份证号。要获取一个身份证号，首先分析身份证号的构成：</p>\r\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">第一、二位表示省级行政区。</span><br><span class=\"line\">第一位数字是以前的大区制代码。第二位是大区所在省市编码。全国共分为8个大区：华北（1）、东北（2）、华东（3）、华南（4）、西南（5）、西北（6）、台湾（7）和港澳（8）。</span><br><span class=\"line\">第三、四位表示地级行政区。其中，01-20，51-70表示地级市；21-50表示地区、自治州、盟；90表示省直辖县级行政单位；直辖市身份证中01表示市辖区，02表示县。</span><br><span class=\"line\">第五、六位表示县级行政区。01-18表示市辖区或地区、自治州、盟辖县级市；21-80表示县、旗；81-99表示省直辖县级行政单位。</span><br><span class=\"line\"></span><br><span class=\"line\">身份证号码第七位到第十四位表示编码对象出生的年、月、日，其中年份用四位数字表示，年、月、日之间不用分隔符。例如：1981年05月11日就用19810511表示。按GB/T7408的规定执行。</span><br><span class=\"line\"></span><br><span class=\"line\">身份证号码第十五位到第十七位表示在同一地址码所标识的区域范围内，对同年、月、日出生的人员编定的顺序号。其中第十七位奇数分给男性，偶数分给女性。</span><br><span class=\"line\"></span><br><span class=\"line\">身份证号码第十八位是根据前面十七位数字码，按照ISO 7064:1983.MOD 11-2校验码计算出来的检验码。</span><br><span class=\"line\">作为尾号的校验码，是由号码编制单位按统一的公式计算出来的，如果某人的尾号是0-9，都不会出现X，但如果尾号是10，那么就得用X来代替，因为如果用10做尾号，那么此人的身份证就变成了19位，而19位的号码违反了国家标准，并且中国的计算机应用系统也不承认19位的身份证号码。X是罗马数字的10，用X来代替10，可以保证公民的身份证符合国家标准。</span><br></pre></td></tr></table></figure>\r\n<p><a href=\"https://baike.baidu.com/item/居民身份证号码/3400358\">身份证号码构成</a></p>\r\n<p>所以代码的实现步骤就很明显了，首先确定前六位，也就是身份证上的登记地点对应的六位数；然后确定第七到十四位，也就是生日，然后随机生成第十五位到第十七位，最后计算校验码得到第十八位。</p>\r\n<span id=\"more\"></span>\r\n<h1 id=\"地区确定\">地区确定</h1>\r\n<p>要确定合法的地区编号，需要有一张可查的表。现记录下了大部分的地区编号及对应的省级行政区如下：</p>\r\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">// id.txt</span><br><span class=\"line\">110000                 北京市</span><br><span class=\"line\">110101     东城区</span><br><span class=\"line\">110102     西城区</span><br><span class=\"line\">110105     朝阳区</span><br><span class=\"line\">110106     丰台区</span><br><span class=\"line\">110107     石景山区</span><br><span class=\"line\">110108     海淀区</span><br><span class=\"line\">110109     门头沟区</span><br><span class=\"line\">110111     房山区</span><br><span class=\"line\">110112     通州区</span><br><span class=\"line\">110113     顺义区</span><br><span class=\"line\">110114     昌平区</span><br><span class=\"line\">110115     大兴区</span><br><span class=\"line\">110116     怀柔区</span><br><span class=\"line\">110117     平谷区</span><br><span class=\"line\">110228     密云区</span><br><span class=\"line\">110229     延庆区</span><br><span class=\"line\">120000                 天津市</span><br><span class=\"line\">120101     和平区</span><br><span class=\"line\">120102     河东区</span><br><span class=\"line\">120103     河西区</span><br><span class=\"line\">120104     南开区</span><br><span class=\"line\">120105     河北区</span><br><span class=\"line\">120106     红桥区</span><br><span class=\"line\">120110     东丽区</span><br><span class=\"line\">120111     西青区</span><br><span class=\"line\">120112     津南区</span><br><span class=\"line\">120113     北辰区</span><br><span class=\"line\">120114     武清区</span><br><span class=\"line\">120115     宝坻区</span><br><span class=\"line\">120116     滨海新区</span><br><span class=\"line\">120221     宁河区</span><br><span class=\"line\">120223     静海区</span><br><span class=\"line\">120225     蓟州区</span><br><span class=\"line\">130000                 河北省</span><br><span class=\"line\">130100     石家庄市</span><br><span class=\"line\">130102     长安区</span><br><span class=\"line\">130103     桥东区</span><br><span class=\"line\">130104     桥西区</span><br><span class=\"line\">130105     新华区</span><br><span class=\"line\">130107     井陉矿区</span><br><span class=\"line\">130108     裕华区</span><br><span class=\"line\">130109     藁城区</span><br><span class=\"line\">130110     鹿泉区</span><br><span class=\"line\">130111     栾城区</span><br><span class=\"line\">130121     井陉县</span><br><span class=\"line\">130123     正定县</span><br><span class=\"line\">130125     行唐县</span><br><span class=\"line\">130126     灵寿县</span><br><span class=\"line\">130127     高邑县</span><br><span class=\"line\">130128     深泽县</span><br><span class=\"line\">130129     赞皇县</span><br><span class=\"line\">130130     无极县</span><br><span class=\"line\">130131     平山县</span><br><span class=\"line\">130132     元氏县</span><br><span class=\"line\">130133     赵县</span><br><span class=\"line\">130181     辛集市</span><br><span class=\"line\">130183     晋州市</span><br><span class=\"line\">130184     新乐市</span><br><span class=\"line\">130200     唐山市</span><br><span class=\"line\">130202     路南区</span><br><span class=\"line\">130203     路北区</span><br><span class=\"line\">130204     古冶区</span><br><span class=\"line\">130205     开平区</span><br><span class=\"line\">130207     丰南区</span><br><span class=\"line\">130208     丰润区</span><br><span class=\"line\">130209     曹妃甸区</span><br><span class=\"line\">130224     滦南县</span><br><span class=\"line\">130225     乐亭县</span><br><span class=\"line\">130227     迁西县</span><br><span class=\"line\">130229     玉田县</span><br><span class=\"line\">130281     遵化市</span><br><span class=\"line\">130283     迁安市</span><br><span class=\"line\">130284     滦州市</span><br><span class=\"line\">130300     秦皇岛市</span><br><span class=\"line\">130302     海港区</span><br><span class=\"line\">130303     山海关区</span><br><span class=\"line\">130304     北戴河区</span><br><span class=\"line\">130306     抚宁区</span><br><span class=\"line\">130321     青龙县</span><br><span class=\"line\">130322     昌黎县</span><br><span class=\"line\">130324     卢龙县</span><br><span class=\"line\">130400     邯郸市</span><br><span class=\"line\">130402     邯山区</span><br><span class=\"line\">130403     丛台区</span><br><span class=\"line\">130404     复兴区</span><br><span class=\"line\">130406     峰峰矿区</span><br><span class=\"line\">130407     肥乡区</span><br><span class=\"line\">130408     永年区</span><br><span class=\"line\">130423     临漳县</span><br><span class=\"line\">130424     成安县</span><br><span class=\"line\">130425     大名县</span><br><span class=\"line\">130426     涉县</span><br><span class=\"line\">130427     磁县</span><br><span class=\"line\">130430     邱县</span><br><span class=\"line\">130431     鸡泽县</span><br><span class=\"line\">130432     广平县</span><br><span class=\"line\">130433     馆陶县</span><br><span class=\"line\">130434     魏县</span><br><span class=\"line\">130435     曲周县</span><br><span class=\"line\">130481     武安市</span><br><span class=\"line\">130500     邢台市</span><br><span class=\"line\">130502     桥东区</span><br><span class=\"line\">130503     桥西区</span><br><span class=\"line\">130521     邢台县</span><br><span class=\"line\">130522     临城县</span><br><span class=\"line\">130523     内丘县</span><br><span class=\"line\">130524     柏乡县</span><br><span class=\"line\">130525     隆尧县</span><br><span class=\"line\">130526     任县</span><br><span class=\"line\">130527     南和县</span><br><span class=\"line\">130528     宁晋县</span><br><span class=\"line\">130529     巨鹿县</span><br><span class=\"line\">130530     新河县</span><br><span class=\"line\">130531     广宗县</span><br><span class=\"line\">130532     平乡县</span><br><span class=\"line\">130533     威县</span><br><span class=\"line\">130534     清河县</span><br><span class=\"line\">130535     临西县</span><br><span class=\"line\">130581     南宫市</span><br><span class=\"line\">130582     沙河市</span><br><span class=\"line\">130600     保定市</span><br><span class=\"line\">130600     雄安新区</span><br><span class=\"line\">130602     竞秀区</span><br><span class=\"line\">130604     南市区</span><br><span class=\"line\">130606     莲池区</span><br><span class=\"line\">130607     满城区</span><br><span class=\"line\">130608     清苑区</span><br><span class=\"line\">130609     徐水区</span><br><span class=\"line\">130623     涞水县</span><br><span class=\"line\">130624     阜平县</span><br><span class=\"line\">130626     定兴县</span><br><span class=\"line\">130627     唐县</span><br><span class=\"line\">130628     高阳县</span><br><span class=\"line\">130629     容城县</span><br><span class=\"line\">130630     涞源县</span><br><span class=\"line\">130631     望都县</span><br><span class=\"line\">130632     安新县</span><br><span class=\"line\">130633     易县</span><br><span class=\"line\">130634     曲阳县</span><br><span class=\"line\">130635     蠡县</span><br><span class=\"line\">130636     顺平县</span><br><span class=\"line\">130637     博野县</span><br><span class=\"line\">130638     雄县</span><br><span class=\"line\">130681     涿州市</span><br><span class=\"line\">130682     定州市</span><br><span class=\"line\">130683     安国市</span><br><span class=\"line\">130684     高碑店市</span><br><span class=\"line\">130700     张家口市</span><br><span class=\"line\">130702     桥东区</span><br><span class=\"line\">130703     桥西区</span><br><span class=\"line\">130705     宣化区</span><br><span class=\"line\">130706     下花园区</span><br><span class=\"line\">130708     万全区</span><br><span class=\"line\">130709     崇礼区</span><br><span class=\"line\">130721     宣化县</span><br><span class=\"line\">130722     张北县</span><br><span class=\"line\">130723     康保县</span><br><span class=\"line\">130724     沽源县</span><br><span class=\"line\">130725     尚义县</span><br><span class=\"line\">130726     蔚县</span><br><span class=\"line\">130727     阳原县</span><br><span class=\"line\">130728     怀安县</span><br><span class=\"line\">130730     怀来县</span><br><span class=\"line\">130731     涿鹿县</span><br><span class=\"line\">130732     赤城县</span><br><span class=\"line\">130800     承德市</span><br><span class=\"line\">130802     双桥区</span><br><span class=\"line\">130803     双滦区</span><br><span class=\"line\">130804     鹰手营子矿区</span><br><span class=\"line\">130821     承德县</span><br><span class=\"line\">130822     兴隆县</span><br><span class=\"line\">130823     平泉市</span><br><span class=\"line\">130824     滦平县</span><br><span class=\"line\">130825     隆化县</span><br><span class=\"line\">130826     丰宁满族自治县</span><br><span class=\"line\">130827     宽城县</span><br><span class=\"line\">130828     围场县</span><br><span class=\"line\">130900     沧州市</span><br><span class=\"line\">130902     新华区</span><br><span class=\"line\">130903     运河区</span><br><span class=\"line\">130921     沧县</span><br><span class=\"line\">130922     青县</span><br><span class=\"line\">130923     东光县</span><br><span class=\"line\">130924     海兴县</span><br><span class=\"line\">130925     盐山县</span><br><span class=\"line\">130926     肃宁县</span><br><span class=\"line\">130927     南皮县</span><br><span class=\"line\">130928     吴桥县</span><br><span class=\"line\">130929     献县</span><br><span class=\"line\">130930     孟村回族自治县</span><br><span class=\"line\">130981     泊头市</span><br><span class=\"line\">130982     任丘市</span><br><span class=\"line\">130983     黄骅市</span><br><span class=\"line\">130984     河间市</span><br><span class=\"line\">131000     廊坊市</span><br><span class=\"line\">131002     安次区</span><br><span class=\"line\">131003     广阳区</span><br><span class=\"line\">131022     固安县</span><br><span class=\"line\">131023     永清县</span><br><span class=\"line\">131024     香河县</span><br><span class=\"line\">131025     大城县</span><br><span class=\"line\">131026     文安县</span><br><span class=\"line\">131028     大厂回族自治县</span><br><span class=\"line\">131081     霸州市</span><br><span class=\"line\">131082     三河市</span><br><span class=\"line\">131100     衡水市</span><br><span class=\"line\">131102     桃城区</span><br><span class=\"line\">131103     冀州市</span><br><span class=\"line\">131121     枣强县</span><br><span class=\"line\">131122     武邑县</span><br><span class=\"line\">131123     武强县</span><br><span class=\"line\">131124     饶阳县</span><br><span class=\"line\">131125     安平县</span><br><span class=\"line\">131126     故城县</span><br><span class=\"line\">131127     景县</span><br><span class=\"line\">131128     阜城县</span><br><span class=\"line\">131182     深州市</span><br><span class=\"line\">140000                 山西省</span><br><span class=\"line\">140100     太原市</span><br><span class=\"line\">140105     小店区</span><br><span class=\"line\">140106     迎泽区</span><br><span class=\"line\">140107     杏花岭区</span><br><span class=\"line\">140108     尖草坪区</span><br><span class=\"line\">140109     万柏林区</span><br><span class=\"line\">140110     晋源区</span><br><span class=\"line\">140121     清徐县</span><br><span class=\"line\">140122     阳曲县</span><br><span class=\"line\">140123     娄烦县</span><br><span class=\"line\">140181     古交市</span><br><span class=\"line\">140200     大同市</span><br><span class=\"line\">140203     矿区</span><br><span class=\"line\">140212     新荣区</span><br><span class=\"line\">140213     平城区</span><br><span class=\"line\">140214     云冈区</span><br><span class=\"line\">140215     云州区</span><br><span class=\"line\">140221     阳高县</span><br><span class=\"line\">140222     天镇县</span><br><span class=\"line\">140223     广灵县</span><br><span class=\"line\">140224     灵丘县</span><br><span class=\"line\">140225     浑源县</span><br><span class=\"line\">140226     左云县</span><br><span class=\"line\">140300     阳泉市</span><br><span class=\"line\">140302     城区</span><br><span class=\"line\">140303     矿区</span><br><span class=\"line\">140311     郊区</span><br><span class=\"line\">140321     平定县</span><br><span class=\"line\">140322     盂县</span><br><span class=\"line\">140400     长治市</span><br><span class=\"line\">140403     潞州区</span><br><span class=\"line\">140404     上党区</span><br><span class=\"line\">140405     屯留区</span><br><span class=\"line\">140406     潞城区</span><br><span class=\"line\">140411     郊区</span><br><span class=\"line\">140423     襄垣县</span><br><span class=\"line\">140425     平顺县</span><br><span class=\"line\">140426     黎城县</span><br><span class=\"line\">140427     壶关县</span><br><span class=\"line\">140428     长子县</span><br><span class=\"line\">140429     武乡县</span><br><span class=\"line\">140430     沁县</span><br><span class=\"line\">140431     沁源县</span><br><span class=\"line\">140500     晋城市</span><br><span class=\"line\">140502     城区</span><br><span class=\"line\">140521     沁水县</span><br><span class=\"line\">140522     阳城县</span><br><span class=\"line\">140524     陵川县</span><br><span class=\"line\">140525     泽州县</span><br><span class=\"line\">140581     高平市</span><br><span class=\"line\">140600     朔州市</span><br><span class=\"line\">140602     朔城区</span><br><span class=\"line\">140603     平鲁区</span><br><span class=\"line\">140621     山阴县</span><br><span class=\"line\">140622     应县</span><br><span class=\"line\">140623     右玉县</span><br><span class=\"line\">140624     怀仁市</span><br><span class=\"line\">140700     晋中市</span><br><span class=\"line\">140702     榆次区</span><br><span class=\"line\">140721     榆社县</span><br><span class=\"line\">140722     左权县</span><br><span class=\"line\">140723     和顺县</span><br><span class=\"line\">140724     昔阳县</span><br><span class=\"line\">140725     寿阳县</span><br><span class=\"line\">140726     太谷县</span><br><span class=\"line\">140727     祁县</span><br><span class=\"line\">140728     平遥县</span><br><span class=\"line\">140729     灵石县</span><br><span class=\"line\">140781     介休市</span><br><span class=\"line\">140800     运城市</span><br><span class=\"line\">140802     盐湖区</span><br><span class=\"line\">140821     临猗县</span><br><span class=\"line\">140822     万荣县</span><br><span class=\"line\">140823     闻喜县</span><br><span class=\"line\">140824     稷山县</span><br><span class=\"line\">140825     新绛县</span><br><span class=\"line\">140826     绛县</span><br><span class=\"line\">140827     垣曲县</span><br><span class=\"line\">140828     夏县</span><br><span class=\"line\">140829     平陆县</span><br><span class=\"line\">140830     芮城县</span><br><span class=\"line\">140881     永济市</span><br><span class=\"line\">140882     河津市</span><br><span class=\"line\">140900     忻州市</span><br><span class=\"line\">140902     忻府区</span><br><span class=\"line\">140921     定襄县</span><br><span class=\"line\">140922     五台县</span><br><span class=\"line\">140923     代县</span><br><span class=\"line\">140924     繁峙县</span><br><span class=\"line\">140925     宁武县</span><br><span class=\"line\">140926     静乐县</span><br><span class=\"line\">140927     神池县</span><br><span class=\"line\">140928     五寨县</span><br><span class=\"line\">140929     岢岚县</span><br><span class=\"line\">140930     河曲县</span><br><span class=\"line\">140931     保德县</span><br><span class=\"line\">140932     偏关县</span><br><span class=\"line\">140981     原平市</span><br><span class=\"line\">141000     临汾市</span><br><span class=\"line\">141002     尧都区</span><br><span class=\"line\">141021     曲沃县</span><br><span class=\"line\">141022     翼城县</span><br><span class=\"line\">141023     襄汾县</span><br><span class=\"line\">141024     洪洞县</span><br><span class=\"line\">141025     古县</span><br><span class=\"line\">141026     安泽县</span><br><span class=\"line\">141027     浮山县</span><br><span class=\"line\">141028     吉县</span><br><span class=\"line\">141029     乡宁县</span><br><span class=\"line\">141030     大宁县</span><br><span class=\"line\">141031     隰县</span><br><span class=\"line\">141032     永和县</span><br><span class=\"line\">141033     蒲县</span><br><span class=\"line\">141034     汾西县</span><br><span class=\"line\">141081     侯马市</span><br><span class=\"line\">141082     霍州市</span><br><span class=\"line\">141100     吕梁市</span><br><span class=\"line\">141102     离石区</span><br><span class=\"line\">141121     文水县</span><br><span class=\"line\">141122     交城县</span><br><span class=\"line\">141123     兴县</span><br><span class=\"line\">141124     临县</span><br><span class=\"line\">141125     柳林县</span><br><span class=\"line\">141126     石楼县</span><br><span class=\"line\">141127     岚县</span><br><span class=\"line\">141128     方山县</span><br><span class=\"line\">141129     中阳县</span><br><span class=\"line\">141130     交口县</span><br><span class=\"line\">141181     孝义市</span><br><span class=\"line\">141182     汾阳市</span><br><span class=\"line\">150000                 内蒙古</span><br><span class=\"line\">150100     呼和浩特市</span><br><span class=\"line\">150102     新城区</span><br><span class=\"line\">150103     回民区</span><br><span class=\"line\">150104     玉泉区</span><br><span class=\"line\">150105     赛罕区</span><br><span class=\"line\">150121     土默特左旗</span><br><span class=\"line\">150122     托克托县</span><br><span class=\"line\">150123     和林格尔县</span><br><span class=\"line\">150124     清水河县</span><br><span class=\"line\">150125     武川县</span><br><span class=\"line\">150200     包头市</span><br><span class=\"line\">150202     东河区</span><br><span class=\"line\">150203     昆都仑区</span><br><span class=\"line\">150204     青山区</span><br><span class=\"line\">150205     石拐区</span><br><span class=\"line\">150206     白云鄂博矿区</span><br><span class=\"line\">150207     九原区</span><br><span class=\"line\">150221     土默特右旗</span><br><span class=\"line\">150222     固阳县</span><br><span class=\"line\">150223     达尔罕旗</span><br><span class=\"line\">150300     乌海市</span><br><span class=\"line\">150302     海勃湾区</span><br><span class=\"line\">150303     海南区</span><br><span class=\"line\">150304     乌达区</span><br><span class=\"line\">150400     赤峰市</span><br><span class=\"line\">150402     红山区</span><br><span class=\"line\">150403     元宝山区</span><br><span class=\"line\">150404     松山区</span><br><span class=\"line\">150421     阿鲁旗</span><br><span class=\"line\">150422     巴林左旗</span><br><span class=\"line\">150423     巴林右旗</span><br><span class=\"line\">150424     林西县</span><br><span class=\"line\">150425     克什克腾旗</span><br><span class=\"line\">150426     翁牛特旗</span><br><span class=\"line\">150428     喀喇沁旗</span><br><span class=\"line\">150429     宁城县</span><br><span class=\"line\">150430     敖汉旗</span><br><span class=\"line\">150500     通辽市</span><br><span class=\"line\">150502     科尔沁区</span><br><span class=\"line\">150521     科尔沁左翼中旗</span><br><span class=\"line\">150522     科尔沁左翼后旗</span><br><span class=\"line\">150523     开鲁县</span><br><span class=\"line\">150524     库伦旗</span><br><span class=\"line\">150525     奈曼旗</span><br><span class=\"line\">150526     扎鲁特旗</span><br><span class=\"line\">150571     经济技术开发区</span><br><span class=\"line\">150581     霍林郭勒市</span><br><span class=\"line\">150600     鄂尔多斯市</span><br><span class=\"line\">150602     东胜区</span><br><span class=\"line\">150603     康巴什区</span><br><span class=\"line\">150621     达拉特旗</span><br><span class=\"line\">150622     准格尔旗</span><br><span class=\"line\">150623     鄂托克前旗</span><br><span class=\"line\">150624     鄂托克旗</span><br><span class=\"line\">150625     杭锦旗</span><br><span class=\"line\">150626     乌审旗</span><br><span class=\"line\">150627     伊金霍洛旗</span><br><span class=\"line\">150700     呼伦贝尔市</span><br><span class=\"line\">150702     海拉尔区</span><br><span class=\"line\">150703     扎赉诺尔区</span><br><span class=\"line\">150721     阿荣旗</span><br><span class=\"line\">150722     莫力达瓦旗</span><br><span class=\"line\">150723     鄂伦春自治旗</span><br><span class=\"line\">150724     鄂温克族自治旗</span><br><span class=\"line\">150725     陈巴尔虎旗</span><br><span class=\"line\">150726     新巴尔虎左旗</span><br><span class=\"line\">150727     新巴尔虎右旗</span><br><span class=\"line\">150781     满洲里市</span><br><span class=\"line\">150782     牙克石市</span><br><span class=\"line\">150783     扎兰屯市</span><br><span class=\"line\">150784     额尔古纳市</span><br><span class=\"line\">150785     根河市</span><br><span class=\"line\">150800     巴彦淖尔市</span><br><span class=\"line\">150802     临河区</span><br><span class=\"line\">150821     五原县</span><br><span class=\"line\">150822     磴口县</span><br><span class=\"line\">150823     乌拉特前旗</span><br><span class=\"line\">150824     乌拉特中旗</span><br><span class=\"line\">150825     乌拉特后旗</span><br><span class=\"line\">150826     杭锦后旗</span><br><span class=\"line\">150900     乌兰察布市</span><br><span class=\"line\">150902     集宁区</span><br><span class=\"line\">150921     卓资县</span><br><span class=\"line\">150922     化德县</span><br><span class=\"line\">150923     商都县</span><br><span class=\"line\">150924     兴和县</span><br><span class=\"line\">150925     凉城县</span><br><span class=\"line\">150926     察哈尔右翼前旗</span><br><span class=\"line\">150927     察哈尔右翼中旗</span><br><span class=\"line\">150928     察哈尔右翼后旗</span><br><span class=\"line\">150929     四子王旗</span><br><span class=\"line\">150981     丰镇市</span><br><span class=\"line\">152200     兴安盟</span><br><span class=\"line\">152201     乌兰浩特市</span><br><span class=\"line\">152202     阿尔山市</span><br><span class=\"line\">152221     科尔沁右翼前旗</span><br><span class=\"line\">152222     科尔沁右翼中旗</span><br><span class=\"line\">152223     扎赉特旗</span><br><span class=\"line\">152224     突泉县</span><br><span class=\"line\">152500     锡林郭勒盟</span><br><span class=\"line\">152501     二连浩特市</span><br><span class=\"line\">152502     锡林浩特市</span><br><span class=\"line\">152522     阿巴嘎旗</span><br><span class=\"line\">152523     苏尼特左旗</span><br><span class=\"line\">152524     苏尼特右旗</span><br><span class=\"line\">152525     东乌珠穆沁旗</span><br><span class=\"line\">152526     西乌珠穆沁旗</span><br><span class=\"line\">152527     太仆寺旗</span><br><span class=\"line\">152528     镶黄旗</span><br><span class=\"line\">152529     正镶白旗</span><br><span class=\"line\">152530     正蓝旗</span><br><span class=\"line\">152531     多伦县</span><br><span class=\"line\">152571     乌拉盖管委会</span><br><span class=\"line\">152900     阿拉善盟</span><br><span class=\"line\">152921     阿拉善左旗</span><br><span class=\"line\">152922     阿拉善右旗</span><br><span class=\"line\">152923     额济纳旗</span><br><span class=\"line\">152971     经济开发区</span><br><span class=\"line\">210000                 辽宁省</span><br><span class=\"line\">210100     沈阳市</span><br><span class=\"line\">210102     和平区</span><br><span class=\"line\">210103     沈河区</span><br><span class=\"line\">210104     大东区</span><br><span class=\"line\">210105     皇姑区</span><br><span class=\"line\">210106     铁西区</span><br><span class=\"line\">210111     苏家屯区</span><br><span class=\"line\">210112     浑南区</span><br><span class=\"line\">210113     沈北新区</span><br><span class=\"line\">210114     于洪区</span><br><span class=\"line\">210115     辽中区</span><br><span class=\"line\">210123     康平县</span><br><span class=\"line\">210124     法库县</span><br><span class=\"line\">210181     新民市</span><br><span class=\"line\">210200     大连市</span><br><span class=\"line\">210200     中山区</span><br><span class=\"line\">210203     西岗区</span><br><span class=\"line\">210204     沙河口区</span><br><span class=\"line\">210211     甘井子区</span><br><span class=\"line\">210212     旅顺口区</span><br><span class=\"line\">210213     金州区</span><br><span class=\"line\">210214     普兰店区</span><br><span class=\"line\">210224     长海县</span><br><span class=\"line\">210281     瓦房店市</span><br><span class=\"line\">210283     庄河市</span><br><span class=\"line\">210300     鞍山市</span><br><span class=\"line\">210302     铁东区</span><br><span class=\"line\">210303     铁西区</span><br><span class=\"line\">210304     立山区</span><br><span class=\"line\">210311     千山区</span><br><span class=\"line\">210321     台安县</span><br><span class=\"line\">210323     岫岩满族自治县</span><br><span class=\"line\">210381     海城市</span><br><span class=\"line\">210400     抚顺市</span><br><span class=\"line\">210402     新抚区</span><br><span class=\"line\">210403     东洲区</span><br><span class=\"line\">210404     望花区</span><br><span class=\"line\">210411     顺城区</span><br><span class=\"line\">210421     抚顺县</span><br><span class=\"line\">210422     新宾满族自治县</span><br><span class=\"line\">210423     清原满族自治县</span><br><span class=\"line\">210500     本溪市</span><br><span class=\"line\">210502     平山区</span><br><span class=\"line\">210503     溪湖区</span><br><span class=\"line\">210504     明山区</span><br><span class=\"line\">210505     南芬区</span><br><span class=\"line\">210521     本溪满族自治县</span><br><span class=\"line\">210522     桓仁满族自治县</span><br><span class=\"line\">210600     丹东市</span><br><span class=\"line\">210602     元宝区</span><br><span class=\"line\">210603     振兴区</span><br><span class=\"line\">210604     振安区</span><br><span class=\"line\">210624     宽甸满族自治县</span><br><span class=\"line\">210681     东港市</span><br><span class=\"line\">210682     凤城市</span><br><span class=\"line\">210700     锦州市</span><br><span class=\"line\">210702     古塔区</span><br><span class=\"line\">210703     凌河区</span><br><span class=\"line\">210711     太和区</span><br><span class=\"line\">210726     黑山县</span><br><span class=\"line\">210727     义县</span><br><span class=\"line\">210781     凌海市</span><br><span class=\"line\">210782     北镇市</span><br><span class=\"line\">210800     营口市</span><br><span class=\"line\">210802     站前区</span><br><span class=\"line\">210803     西市区</span><br><span class=\"line\">210804     鲅鱼圈区</span><br><span class=\"line\">210811     老边区</span><br><span class=\"line\">210881     盖州市</span><br><span class=\"line\">210882     大石桥市</span><br><span class=\"line\">210900     阜新市</span><br><span class=\"line\">210902     海州区</span><br><span class=\"line\">210903     新邱区</span><br><span class=\"line\">210904     太平区</span><br><span class=\"line\">210905     清河门区</span><br><span class=\"line\">210911     细河区</span><br><span class=\"line\">210921     阜新蒙古族自治县</span><br><span class=\"line\">210922     彰武县</span><br><span class=\"line\">211000     辽阳市</span><br><span class=\"line\">211002     白塔区</span><br><span class=\"line\">211003     文圣区</span><br><span class=\"line\">211004     宏伟区</span><br><span class=\"line\">211005     弓长岭区</span><br><span class=\"line\">211011     太子河区</span><br><span class=\"line\">211021     辽阳县</span><br><span class=\"line\">211081     灯塔市</span><br><span class=\"line\">211100     盘锦市</span><br><span class=\"line\">211102     双台子区</span><br><span class=\"line\">211103     兴隆台区</span><br><span class=\"line\">211104     大洼区</span><br><span class=\"line\">211122     盘山县</span><br><span class=\"line\">211200     铁岭市</span><br><span class=\"line\">211202     银州区</span><br><span class=\"line\">211204     清河区</span><br><span class=\"line\">211221     铁岭县</span><br><span class=\"line\">211223     西丰县</span><br><span class=\"line\">211224     昌图县</span><br><span class=\"line\">211281     调兵山市</span><br><span class=\"line\">211282     开原市</span><br><span class=\"line\">211300     朝阳市</span><br><span class=\"line\">211302     双塔区</span><br><span class=\"line\">211303     龙城区</span><br><span class=\"line\">211321     朝阳县</span><br><span class=\"line\">211322     建平县</span><br><span class=\"line\">211324     喀左县</span><br><span class=\"line\">211381     北票市</span><br><span class=\"line\">211382     凌源市</span><br><span class=\"line\">211400     葫芦岛市</span><br><span class=\"line\">211402     连山区</span><br><span class=\"line\">211403     龙港区</span><br><span class=\"line\">211404     南票区</span><br><span class=\"line\">211421     绥中县</span><br><span class=\"line\">211422     建昌县</span><br><span class=\"line\">211481     兴城市</span><br><span class=\"line\">220000                 吉林省</span><br><span class=\"line\">220100     长春市</span><br><span class=\"line\">220102     南关区</span><br><span class=\"line\">220103     宽城区</span><br><span class=\"line\">220104     朝阳区</span><br><span class=\"line\">220105     二道区</span><br><span class=\"line\">220106     绿园区</span><br><span class=\"line\">220112     双阳区</span><br><span class=\"line\">220113     九台区</span><br><span class=\"line\">220122     农安县</span><br><span class=\"line\">220182     榆树市</span><br><span class=\"line\">220183     德惠市</span><br><span class=\"line\">220200     吉林市</span><br><span class=\"line\">220202     昌邑区</span><br><span class=\"line\">220203     龙潭区</span><br><span class=\"line\">220204     船营区</span><br><span class=\"line\">220211     丰满区</span><br><span class=\"line\">220221     永吉县</span><br><span class=\"line\">220281     蛟河市</span><br><span class=\"line\">220282     桦甸市</span><br><span class=\"line\">220283     舒兰市</span><br><span class=\"line\">220284     磐石市</span><br><span class=\"line\">220300     四平市</span><br><span class=\"line\">220302     铁西区</span><br><span class=\"line\">220303     铁东区</span><br><span class=\"line\">220322     梨树县</span><br><span class=\"line\">220323     伊通满族自治县</span><br><span class=\"line\">220381     公主岭市</span><br><span class=\"line\">220382     双辽市</span><br><span class=\"line\">220400     辽源市</span><br><span class=\"line\">220402     龙山区</span><br><span class=\"line\">220403     西安区</span><br><span class=\"line\">220421     东丰县</span><br><span class=\"line\">220422     东辽县</span><br><span class=\"line\">220500     通化市</span><br><span class=\"line\">220502     东昌区</span><br><span class=\"line\">220503     二道江区</span><br><span class=\"line\">220521     通化县</span><br><span class=\"line\">220523     辉南县</span><br><span class=\"line\">220524     柳河县</span><br><span class=\"line\">220581     梅河口市</span><br><span class=\"line\">220582     集安市</span><br><span class=\"line\">220600     白山市</span><br><span class=\"line\">220602     浑江区</span><br><span class=\"line\">220605     江源区</span><br><span class=\"line\">220621     抚松县</span><br><span class=\"line\">220622     靖宇县</span><br><span class=\"line\">220623     长白县</span><br><span class=\"line\">220681     临江市</span><br><span class=\"line\">220700     松原市</span><br><span class=\"line\">220702     宁江区</span><br><span class=\"line\">220721     前郭尔罗斯县</span><br><span class=\"line\">220722     长岭县</span><br><span class=\"line\">220723     乾安县</span><br><span class=\"line\">220781     扶余市</span><br><span class=\"line\">220800     白城市</span><br><span class=\"line\">220802     洮北区</span><br><span class=\"line\">220821     镇赉县</span><br><span class=\"line\">220822     通榆县</span><br><span class=\"line\">220881     洮南市</span><br><span class=\"line\">220882     大安市</span><br><span class=\"line\">222400     延边州</span><br><span class=\"line\">222401     延吉市</span><br><span class=\"line\">222402     图们市</span><br><span class=\"line\">222403     敦化市</span><br><span class=\"line\">222404     珲春市</span><br><span class=\"line\">222405     龙井市</span><br><span class=\"line\">222406     和龙市</span><br><span class=\"line\">222424     汪清县</span><br><span class=\"line\">222426     安图县</span><br><span class=\"line\">230000                 黑龙江</span><br><span class=\"line\">230100     哈尔滨市</span><br><span class=\"line\">230102     道里区</span><br><span class=\"line\">230103     南岗区</span><br><span class=\"line\">230104     道外区</span><br><span class=\"line\">230108     平房区</span><br><span class=\"line\">230109     松北区</span><br><span class=\"line\">230110     香坊区</span><br><span class=\"line\">230111     呼兰区</span><br><span class=\"line\">230112     阿城区</span><br><span class=\"line\">230113     双城区</span><br><span class=\"line\">230123     依兰县</span><br><span class=\"line\">230124     方正县</span><br><span class=\"line\">230125     宾县</span><br><span class=\"line\">230126     巴彦县</span><br><span class=\"line\">230127     木兰县</span><br><span class=\"line\">230128     通河县</span><br><span class=\"line\">230129     延寿县</span><br><span class=\"line\">230183     尚志市</span><br><span class=\"line\">230184     五常市</span><br><span class=\"line\">230200     齐齐哈尔市</span><br><span class=\"line\">230202     龙沙区</span><br><span class=\"line\">230203     建华区</span><br><span class=\"line\">230204     铁锋区</span><br><span class=\"line\">230205     昂昂溪区</span><br><span class=\"line\">230206     富拉尔基区</span><br><span class=\"line\">230207     碾子山区</span><br><span class=\"line\">230208     梅里斯达斡尔族区</span><br><span class=\"line\">230221     龙江县</span><br><span class=\"line\">230223     依安县</span><br><span class=\"line\">230224     泰来县</span><br><span class=\"line\">230225     甘南县</span><br><span class=\"line\">230227     富裕县</span><br><span class=\"line\">230229     克山县</span><br><span class=\"line\">230230     克东县</span><br><span class=\"line\">230231     拜泉县</span><br><span class=\"line\">230281     讷河市</span><br><span class=\"line\">230300     鸡西市</span><br><span class=\"line\">230302     鸡冠区</span><br><span class=\"line\">230303     恒山市</span><br><span class=\"line\">230304     滴道区</span><br><span class=\"line\">230305     梨树区</span><br><span class=\"line\">230306     城子河区</span><br><span class=\"line\">230307     麻山区</span><br><span class=\"line\">230321     鸡东县</span><br><span class=\"line\">230381     虎林市</span><br><span class=\"line\">230382     密山市</span><br><span class=\"line\">230400     鹤岗市</span><br><span class=\"line\">230402     向阳区</span><br><span class=\"line\">230403     工农区</span><br><span class=\"line\">230404     南山区</span><br><span class=\"line\">230405     兴安区</span><br><span class=\"line\">230406     东山区</span><br><span class=\"line\">230407     兴山区</span><br><span class=\"line\">230421     萝北县</span><br><span class=\"line\">230422     绥滨县</span><br><span class=\"line\">230500     双鸭山市</span><br><span class=\"line\">230502     尖山区</span><br><span class=\"line\">230503     岭东区</span><br><span class=\"line\">230505     四方台区</span><br><span class=\"line\">230506     宝山区</span><br><span class=\"line\">230521     集贤县</span><br><span class=\"line\">230522     友谊县</span><br><span class=\"line\">230523     宝清县</span><br><span class=\"line\">230524     饶河县</span><br><span class=\"line\">230600     大庆市</span><br><span class=\"line\">230602     萨尔图区</span><br><span class=\"line\">230603     龙凤区</span><br><span class=\"line\">230604     让胡路区</span><br><span class=\"line\">230605     红岗区</span><br><span class=\"line\">230606     大同区</span><br><span class=\"line\">230621     肇州县</span><br><span class=\"line\">230622     肇源县</span><br><span class=\"line\">230623     林甸县</span><br><span class=\"line\">230624     杜尔伯特蒙县</span><br><span class=\"line\">230671     高新技术产业开发区</span><br><span class=\"line\">230700     伊春市</span><br><span class=\"line\">230703     南岔县del</span><br><span class=\"line\">230707     丰林县</span><br><span class=\"line\">230708     美溪区</span><br><span class=\"line\">230709     金林区DEL</span><br><span class=\"line\">230710     五营区</span><br><span class=\"line\">230714     乌伊岭区</span><br><span class=\"line\">230715     红星区</span><br><span class=\"line\">230717     伊美区</span><br><span class=\"line\">230718     乌翠区</span><br><span class=\"line\">230719     友好区</span><br><span class=\"line\">230722     嘉荫县</span><br><span class=\"line\">230723     汤旺县</span><br><span class=\"line\">230724     丰林县</span><br><span class=\"line\">230725     大箐山县</span><br><span class=\"line\">230726     南岔县</span><br><span class=\"line\">230751     金林区</span><br><span class=\"line\">230781     铁力市</span><br><span class=\"line\">230800     佳木斯市</span><br><span class=\"line\">230803     向阳区</span><br><span class=\"line\">230804     前进区</span><br><span class=\"line\">230805     东风区</span><br><span class=\"line\">230811     郊区</span><br><span class=\"line\">230822     桦南县</span><br><span class=\"line\">230826     桦川县</span><br><span class=\"line\">230828     汤原县</span><br><span class=\"line\">230881     同江市</span><br><span class=\"line\">230882     富锦市</span><br><span class=\"line\">230883     抚远市</span><br><span class=\"line\">230900     七台河市</span><br><span class=\"line\">230902     新兴区</span><br><span class=\"line\">230903     桃山市</span><br><span class=\"line\">230904     茄子河区</span><br><span class=\"line\">230921     勃利县</span><br><span class=\"line\">231000     牡丹江市</span><br><span class=\"line\">231002     东安区</span><br><span class=\"line\">231003     阳明区</span><br><span class=\"line\">231004     爱民区</span><br><span class=\"line\">231005     西安区</span><br><span class=\"line\">231025     林口县</span><br><span class=\"line\">231081     绥芬河市</span><br><span class=\"line\">231083     海林市</span><br><span class=\"line\">231084     宁安市</span><br><span class=\"line\">231085     穆棱市</span><br><span class=\"line\">231086     东宁市</span><br><span class=\"line\">231100     黑河市</span><br><span class=\"line\">231102     爱辉区</span><br><span class=\"line\">231121     嫩江市</span><br><span class=\"line\">231123     逊克县</span><br><span class=\"line\">231124     孙吴县</span><br><span class=\"line\">231181     北安市</span><br><span class=\"line\">231182     五大连池市</span><br><span class=\"line\">231200     绥化市</span><br><span class=\"line\">231202     北林区</span><br><span class=\"line\">231221     望奎县</span><br><span class=\"line\">231222     兰西县</span><br><span class=\"line\">231223     青冈县</span><br><span class=\"line\">231224     庆安县</span><br><span class=\"line\">231225     明水县</span><br><span class=\"line\">231226     绥棱县</span><br><span class=\"line\">231281     安达市</span><br><span class=\"line\">231282     肇东市</span><br><span class=\"line\">231283     海伦市</span><br><span class=\"line\">232700     大兴安岭市</span><br><span class=\"line\">232701     漠河市</span><br><span class=\"line\">232721     呼玛县</span><br><span class=\"line\">232722     塔河县</span><br><span class=\"line\">232761     加格达奇区</span><br><span class=\"line\">232762     松岭区</span><br><span class=\"line\">232763     新林区</span><br><span class=\"line\">232764     呼中区</span><br><span class=\"line\">310000                 上海市</span><br><span class=\"line\">310101     黄浦区</span><br><span class=\"line\">310104     徐汇区</span><br><span class=\"line\">310105     长宁区</span><br><span class=\"line\">310106     静安区</span><br><span class=\"line\">310107     普陀区</span><br><span class=\"line\">310109     虹口区</span><br><span class=\"line\">310110     杨浦区</span><br><span class=\"line\">310112     闵行区</span><br><span class=\"line\">310113     宝山区</span><br><span class=\"line\">310114     嘉定区</span><br><span class=\"line\">310115     浦东新区</span><br><span class=\"line\">310116     金山区</span><br><span class=\"line\">310117     松江区</span><br><span class=\"line\">310118     青浦区</span><br><span class=\"line\">310120     奉贤区</span><br><span class=\"line\">310230     崇明区</span><br><span class=\"line\">320000                 江苏省</span><br><span class=\"line\">320100     南京市</span><br><span class=\"line\">320102     玄武区</span><br><span class=\"line\">320104     秦淮区</span><br><span class=\"line\">320105     建邺区</span><br><span class=\"line\">320106     鼓楼区</span><br><span class=\"line\">320111     浦口区</span><br><span class=\"line\">320113     栖霞区</span><br><span class=\"line\">320114     雨花台区</span><br><span class=\"line\">320115     江宁区</span><br><span class=\"line\">320116     六合区</span><br><span class=\"line\">320124     溧水区</span><br><span class=\"line\">320125     高淳区</span><br><span class=\"line\">320200     无锡市</span><br><span class=\"line\">320205     锡山区</span><br><span class=\"line\">320206     惠山区</span><br><span class=\"line\">320211     滨湖区</span><br><span class=\"line\">320213     梁溪区</span><br><span class=\"line\">320214     新吴区</span><br><span class=\"line\">320281     江阴市</span><br><span class=\"line\">320282     宜兴市</span><br><span class=\"line\">320300     徐州市</span><br><span class=\"line\">320302     鼓楼区</span><br><span class=\"line\">320303     云龙区</span><br><span class=\"line\">320305     贾汪区</span><br><span class=\"line\">320311     泉山区</span><br><span class=\"line\">320312     铜山区</span><br><span class=\"line\">320321     丰县</span><br><span class=\"line\">320322     沛县</span><br><span class=\"line\">320324     睢宁县</span><br><span class=\"line\">320381     新沂市</span><br><span class=\"line\">320382     邳州市</span><br><span class=\"line\">320400     常州市</span><br><span class=\"line\">320402     天宁区</span><br><span class=\"line\">320404     钟楼区</span><br><span class=\"line\">320411     新北区</span><br><span class=\"line\">320412     武进区</span><br><span class=\"line\">320481     溧阳市</span><br><span class=\"line\">320482     金坛区</span><br><span class=\"line\">320500     苏州市</span><br><span class=\"line\">320505     虎丘区</span><br><span class=\"line\">320506     吴中区</span><br><span class=\"line\">320507     相城区</span><br><span class=\"line\">320508     姑苏区</span><br><span class=\"line\">320509     吴江区</span><br><span class=\"line\">320581     常熟市</span><br><span class=\"line\">320582     张家港市</span><br><span class=\"line\">320583     昆山市</span><br><span class=\"line\">320585     太仓市</span><br><span class=\"line\">320600     南通市</span><br><span class=\"line\">320602     崇川区</span><br><span class=\"line\">320611     港闸区</span><br><span class=\"line\">320612     通州区</span><br><span class=\"line\">320621     海安市</span><br><span class=\"line\">320623     如东市</span><br><span class=\"line\">320681     启东市</span><br><span class=\"line\">320682     如皋市</span><br><span class=\"line\">320684     海门市</span><br><span class=\"line\">320700     连云港市</span><br><span class=\"line\">320703     连云区</span><br><span class=\"line\">320706     海州区</span><br><span class=\"line\">320721     赣榆区</span><br><span class=\"line\">320722     东海县</span><br><span class=\"line\">320723     灌云县</span><br><span class=\"line\">320724     灌南县</span><br><span class=\"line\">320800     淮安市</span><br><span class=\"line\">320803     淮安区</span><br><span class=\"line\">320804     淮阴区</span><br><span class=\"line\">320812     清江浦区</span><br><span class=\"line\">320826     涟水县</span><br><span class=\"line\">320829     洪泽区</span><br><span class=\"line\">320830     盱眙县</span><br><span class=\"line\">320831     金湖县</span><br><span class=\"line\">320900     盐城市</span><br><span class=\"line\">320902     亭湖区</span><br><span class=\"line\">320903     盐都区</span><br><span class=\"line\">320904     大丰区</span><br><span class=\"line\">320921     响水县</span><br><span class=\"line\">320922     滨海县</span><br><span class=\"line\">320923     阜宁县</span><br><span class=\"line\">320924     射阳县</span><br><span class=\"line\">320925     建湖县</span><br><span class=\"line\">320981     东台市</span><br><span class=\"line\">321000     扬州市</span><br><span class=\"line\">321002     广陵区</span><br><span class=\"line\">321003     邗江区</span><br><span class=\"line\">321012     江都区</span><br><span class=\"line\">321023     宝应县</span><br><span class=\"line\">321081     仪征市</span><br><span class=\"line\">321084     高邮市</span><br><span class=\"line\">321101     镇江市</span><br><span class=\"line\">321102     京口区</span><br><span class=\"line\">321111     润州区</span><br><span class=\"line\">321112     丹徒区</span><br><span class=\"line\">321181     丹阳市</span><br><span class=\"line\">321182     扬中市</span><br><span class=\"line\">321183     句容市</span><br><span class=\"line\">321200     泰州市</span><br><span class=\"line\">321202     海陵区</span><br><span class=\"line\">321203     高港区</span><br><span class=\"line\">321281     兴化市</span><br><span class=\"line\">321282     靖江市</span><br><span class=\"line\">321283     泰兴市</span><br><span class=\"line\">321284     姜堰区</span><br><span class=\"line\">321300     宿迁市</span><br><span class=\"line\">321302     宿城区</span><br><span class=\"line\">321311     宿豫区</span><br><span class=\"line\">321322     沭阳县</span><br><span class=\"line\">321323     泗阳县</span><br><span class=\"line\">321324     泗洪县</span><br><span class=\"line\">330000                 浙江省</span><br><span class=\"line\">330100     杭州市</span><br><span class=\"line\">330102     上城区</span><br><span class=\"line\">330103     下城区</span><br><span class=\"line\">330104     江干区</span><br><span class=\"line\">330105     拱墅区</span><br><span class=\"line\">330106     西湖区</span><br><span class=\"line\">330108     滨江区</span><br><span class=\"line\">330109     萧山区</span><br><span class=\"line\">330110     余杭区</span><br><span class=\"line\">330111     富阳区</span><br><span class=\"line\">330112     临安区</span><br><span class=\"line\">330122     桐庐县</span><br><span class=\"line\">330127     淳安县</span><br><span class=\"line\">330182     建德市</span><br><span class=\"line\">330200     宁波市</span><br><span class=\"line\">330203     海曙区</span><br><span class=\"line\">330205     江北区</span><br><span class=\"line\">330206     北仑区</span><br><span class=\"line\">330211     镇海区</span><br><span class=\"line\">330212     鄞州区</span><br><span class=\"line\">330213     奉化区</span><br><span class=\"line\">330225     象山县</span><br><span class=\"line\">330226     宁海县</span><br><span class=\"line\">330281     余姚市</span><br><span class=\"line\">330282     慈溪市</span><br><span class=\"line\">330300     温州市</span><br><span class=\"line\">330302     鹿城区</span><br><span class=\"line\">330303     龙湾区</span><br><span class=\"line\">330304     瓯海区</span><br><span class=\"line\">330322     洞头区</span><br><span class=\"line\">330324     永嘉县</span><br><span class=\"line\">330326     平阳县</span><br><span class=\"line\">330327     苍南县</span><br><span class=\"line\">330328     文成县</span><br><span class=\"line\">330329     泰顺县</span><br><span class=\"line\">330381     瑞安市</span><br><span class=\"line\">330382     乐清市</span><br><span class=\"line\">330383     龙港市</span><br><span class=\"line\">330400     嘉兴市</span><br><span class=\"line\">330402     南湖区</span><br><span class=\"line\">330411     秀洲区</span><br><span class=\"line\">330421     嘉善县</span><br><span class=\"line\">330424     海盐县</span><br><span class=\"line\">330481     海宁市</span><br><span class=\"line\">330482     平湖市</span><br><span class=\"line\">330483     桐乡市</span><br><span class=\"line\">330500     湖州市</span><br><span class=\"line\">330502     吴兴区</span><br><span class=\"line\">330503     南浔区</span><br><span class=\"line\">330521     德清县</span><br><span class=\"line\">330522     长兴县</span><br><span class=\"line\">330523     安吉县</span><br><span class=\"line\">330600     绍兴市</span><br><span class=\"line\">330602     越城区</span><br><span class=\"line\">330621     柯桥区</span><br><span class=\"line\">330624     新昌县</span><br><span class=\"line\">330681     诸暨市</span><br><span class=\"line\">330682     上虞区</span><br><span class=\"line\">330683     嵊州市</span><br><span class=\"line\">330700     金华市</span><br><span class=\"line\">330702     婺城区</span><br><span class=\"line\">330703     金东区</span><br><span class=\"line\">330723     武义县</span><br><span class=\"line\">330726     浦江县</span><br><span class=\"line\">330727     磐安县</span><br><span class=\"line\">330781     兰溪市</span><br><span class=\"line\">330782     义乌市</span><br><span class=\"line\">330783     东阳市</span><br><span class=\"line\">330784     永康市</span><br><span class=\"line\">330800     衢州市</span><br><span class=\"line\">330802     柯城区</span><br><span class=\"line\">330803     衢江区</span><br><span class=\"line\">330822     常山县</span><br><span class=\"line\">330824     开化县</span><br><span class=\"line\">330825     龙游县</span><br><span class=\"line\">330881     江山市</span><br><span class=\"line\">330900     舟山市</span><br><span class=\"line\">330902     定海区</span><br><span class=\"line\">330903     普陀区</span><br><span class=\"line\">330921     岱山县</span><br><span class=\"line\">330922     嵊泗县</span><br><span class=\"line\">331000     台州市</span><br><span class=\"line\">331002     椒江区</span><br><span class=\"line\">331003     黄岩区</span><br><span class=\"line\">331004     路桥区</span><br><span class=\"line\">331021     玉环市</span><br><span class=\"line\">331022     三门县</span><br><span class=\"line\">331023     天台县</span><br><span class=\"line\">331024     仙居县</span><br><span class=\"line\">331081     温岭市</span><br><span class=\"line\">331082     临海市</span><br><span class=\"line\">331100     丽水市</span><br><span class=\"line\">331102     莲都区</span><br><span class=\"line\">331121     青田县</span><br><span class=\"line\">331122     缙云县</span><br><span class=\"line\">331123     遂昌县</span><br><span class=\"line\">331124     松阳县</span><br><span class=\"line\">331125     云和县</span><br><span class=\"line\">331126     庆元县</span><br><span class=\"line\">331127     景宁县</span><br><span class=\"line\">331181     龙泉市</span><br><span class=\"line\">340000                 安徽省</span><br><span class=\"line\">340100     合肥市</span><br><span class=\"line\">340102     瑶海区</span><br><span class=\"line\">340103     庐阳区</span><br><span class=\"line\">340104     蜀山区</span><br><span class=\"line\">340111     包河区</span><br><span class=\"line\">340121     长丰县</span><br><span class=\"line\">340122     肥东县</span><br><span class=\"line\">340123     肥西县</span><br><span class=\"line\">340124     庐江县</span><br><span class=\"line\">340181     巢湖市</span><br><span class=\"line\">340200     芜湖市</span><br><span class=\"line\">340202     镜湖区</span><br><span class=\"line\">340203     弋江区</span><br><span class=\"line\">340207     鸠江区</span><br><span class=\"line\">340208     三山区</span><br><span class=\"line\">340221     芜湖县</span><br><span class=\"line\">340222     繁昌县</span><br><span class=\"line\">340223     南陵县</span><br><span class=\"line\">340225     无为县</span><br><span class=\"line\">340300     蚌埠市</span><br><span class=\"line\">340302     龙子湖区</span><br><span class=\"line\">340303     蚌山区</span><br><span class=\"line\">340304     禹会区</span><br><span class=\"line\">340311     淮上区</span><br><span class=\"line\">340321     怀远县</span><br><span class=\"line\">340322     五河县</span><br><span class=\"line\">340323     固镇县</span><br><span class=\"line\">340400     淮南市</span><br><span class=\"line\">340402     大通区</span><br><span class=\"line\">340403     田家庵区</span><br><span class=\"line\">340404     谢家集区</span><br><span class=\"line\">340405     八公山区</span><br><span class=\"line\">340406     潘集区</span><br><span class=\"line\">340421     凤台县</span><br><span class=\"line\">340422     寿县</span><br><span class=\"line\">340500     马鞍山市</span><br><span class=\"line\">340502     博望区</span><br><span class=\"line\">340503     花山区</span><br><span class=\"line\">340504     雨山区</span><br><span class=\"line\">340521     当涂县</span><br><span class=\"line\">340522     含山县</span><br><span class=\"line\">340600     淮北市</span><br><span class=\"line\">340602     杜集区</span><br><span class=\"line\">340603     相山区</span><br><span class=\"line\">340604     烈山区</span><br><span class=\"line\">340621     濉溪县</span><br><span class=\"line\">340700     铜陵市</span><br><span class=\"line\">340702     铜官区</span><br><span class=\"line\">340706     义安区</span><br><span class=\"line\">340711     郊区</span><br><span class=\"line\">340722     枞阳县</span><br><span class=\"line\">340800     安庆市</span><br><span class=\"line\">340802     迎江区</span><br><span class=\"line\">340803     大观区</span><br><span class=\"line\">340811     宜秀区</span><br><span class=\"line\">340822     怀宁县</span><br><span class=\"line\">340824     潜山市</span><br><span class=\"line\">340825     太湖县</span><br><span class=\"line\">340826     宿松县</span><br><span class=\"line\">340827     望江县</span><br><span class=\"line\">340828     岳西县</span><br><span class=\"line\">340881     桐城市</span><br><span class=\"line\">341000     黄山市</span><br><span class=\"line\">341002     屯溪区</span><br><span class=\"line\">341003     黄山区</span><br><span class=\"line\">341004     徽州区</span><br><span class=\"line\">341021     歙县</span><br><span class=\"line\">341022     休宁县</span><br><span class=\"line\">341023     黟县</span><br><span class=\"line\">341024     祁门县</span><br><span class=\"line\">341100     滁州市</span><br><span class=\"line\">341102     琅琊区</span><br><span class=\"line\">341103     南谯区</span><br><span class=\"line\">341122     来安县</span><br><span class=\"line\">341124     全椒县</span><br><span class=\"line\">341125     定远县</span><br><span class=\"line\">341126     凤阳县</span><br><span class=\"line\">341181     天长市</span><br><span class=\"line\">341182     明光市</span><br><span class=\"line\">341200     阜阳市</span><br><span class=\"line\">341202     颍州区</span><br><span class=\"line\">341203     颍东区</span><br><span class=\"line\">341204     颍泉区</span><br><span class=\"line\">341221     临泉县</span><br><span class=\"line\">341222     太和县</span><br><span class=\"line\">341225     阜南县</span><br><span class=\"line\">341226     颍上县</span><br><span class=\"line\">341282     界首市</span><br><span class=\"line\">341300     宿州市</span><br><span class=\"line\">341302     埇桥区</span><br><span class=\"line\">341321     砀山县</span><br><span class=\"line\">341322     萧县</span><br><span class=\"line\">341323     灵璧县</span><br><span class=\"line\">341324     泗县</span><br><span class=\"line\">341424     和县</span><br><span class=\"line\">341500     六安市</span><br><span class=\"line\">341502     金安区</span><br><span class=\"line\">341503     裕安区</span><br><span class=\"line\">341504     叶集区</span><br><span class=\"line\">341522     霍邱县</span><br><span class=\"line\">341523     舒城县</span><br><span class=\"line\">341524     金寨县</span><br><span class=\"line\">341525     霍山县</span><br><span class=\"line\">341600     亳州市</span><br><span class=\"line\">341602     谯城区</span><br><span class=\"line\">341621     涡阳县</span><br><span class=\"line\">341622     蒙城县</span><br><span class=\"line\">341623     利辛县</span><br><span class=\"line\">341700     池州市</span><br><span class=\"line\">341702     贵池区</span><br><span class=\"line\">341721     东至县</span><br><span class=\"line\">341722     石台县</span><br><span class=\"line\">341723     青阳县</span><br><span class=\"line\">341800     宣城市</span><br><span class=\"line\">341802     宣州区</span><br><span class=\"line\">341821     郎溪县</span><br><span class=\"line\">341823     泾县</span><br><span class=\"line\">341824     绩溪县</span><br><span class=\"line\">341825     旌德县</span><br><span class=\"line\">341881     宁国市</span><br><span class=\"line\">341882     广德市</span><br><span class=\"line\">350000                 福建省</span><br><span class=\"line\">350100     福州市</span><br><span class=\"line\">350102     鼓楼区</span><br><span class=\"line\">350103     台江区</span><br><span class=\"line\">350104     仓山区</span><br><span class=\"line\">350105     马尾区</span><br><span class=\"line\">350111     晋安区</span><br><span class=\"line\">350112     长乐区</span><br><span class=\"line\">350121     闽侯县</span><br><span class=\"line\">350122     连江县</span><br><span class=\"line\">350123     罗源县</span><br><span class=\"line\">350124     闽清县</span><br><span class=\"line\">350125     永泰县</span><br><span class=\"line\">350128     平潭县</span><br><span class=\"line\">350181     福清市</span><br><span class=\"line\">350200     厦门市</span><br><span class=\"line\">350203     思明区</span><br><span class=\"line\">350205     海沧区</span><br><span class=\"line\">350206     湖里区</span><br><span class=\"line\">350211     集美区</span><br><span class=\"line\">350212     同安区</span><br><span class=\"line\">350213     翔安区</span><br><span class=\"line\">350300     莆田市</span><br><span class=\"line\">350302     城厢区</span><br><span class=\"line\">350303     涵江区</span><br><span class=\"line\">350304     荔城区</span><br><span class=\"line\">350305     秀屿区</span><br><span class=\"line\">350322     仙游县</span><br><span class=\"line\">350400     三明市</span><br><span class=\"line\">350402     梅列区</span><br><span class=\"line\">350403     三元区</span><br><span class=\"line\">350421     明溪县</span><br><span class=\"line\">350423     清流县</span><br><span class=\"line\">350424     宁化县</span><br><span class=\"line\">350425     大田县</span><br><span class=\"line\">350426     尤溪县</span><br><span class=\"line\">350427     沙县</span><br><span class=\"line\">350428     将乐县</span><br><span class=\"line\">350429     泰宁县</span><br><span class=\"line\">350430     建宁县</span><br><span class=\"line\">350481     永安市</span><br><span class=\"line\">350500     泉州市</span><br><span class=\"line\">350502     鲤城区</span><br><span class=\"line\">350503     丰泽区</span><br><span class=\"line\">350504     洛江区</span><br><span class=\"line\">350505     泉港区</span><br><span class=\"line\">350521     惠安县</span><br><span class=\"line\">350524     安溪县</span><br><span class=\"line\">350525     永春县</span><br><span class=\"line\">350526     德化县</span><br><span class=\"line\">350527     金门县</span><br><span class=\"line\">350581     石狮市</span><br><span class=\"line\">350582     晋江市</span><br><span class=\"line\">350583     南安市</span><br><span class=\"line\">350600     漳州市</span><br><span class=\"line\">350602     芗城区</span><br><span class=\"line\">350603     龙文区</span><br><span class=\"line\">350622     云霄县</span><br><span class=\"line\">350623     漳浦县</span><br><span class=\"line\">350624     诏安县</span><br><span class=\"line\">350625     长泰县</span><br><span class=\"line\">350626     东山县</span><br><span class=\"line\">350627     南靖县</span><br><span class=\"line\">350628     平和县</span><br><span class=\"line\">350629     华安县</span><br><span class=\"line\">350681     龙海市</span><br><span class=\"line\">350700     南平市</span><br><span class=\"line\">350702     延平区</span><br><span class=\"line\">350703     建阳区</span><br><span class=\"line\">350721     顺昌县</span><br><span class=\"line\">350722     浦城县</span><br><span class=\"line\">350723     光泽县</span><br><span class=\"line\">350724     松溪县</span><br><span class=\"line\">350725     政和县</span><br><span class=\"line\">350781     邵武市</span><br><span class=\"line\">350782     武夷山市</span><br><span class=\"line\">350783     建瓯市</span><br><span class=\"line\">350800     龙岩市</span><br><span class=\"line\">350802     新罗区</span><br><span class=\"line\">350803     永定区</span><br><span class=\"line\">350821     长汀县</span><br><span class=\"line\">350823     上杭县</span><br><span class=\"line\">350824     武平县</span><br><span class=\"line\">350825     连城县</span><br><span class=\"line\">350881     漳平市</span><br><span class=\"line\">350900     宁德市</span><br><span class=\"line\">350902     蕉城区</span><br><span class=\"line\">350921     霞浦县</span><br><span class=\"line\">350922     古田县</span><br><span class=\"line\">350923     屏南县</span><br><span class=\"line\">350924     寿宁县</span><br><span class=\"line\">350925     周宁县</span><br><span class=\"line\">350926     柘荣县</span><br><span class=\"line\">350981     福安市</span><br><span class=\"line\">350982     福鼎市</span><br><span class=\"line\">360000                 江西省</span><br><span class=\"line\">360100     南昌市</span><br><span class=\"line\">360102     东湖区</span><br><span class=\"line\">360103     西湖区</span><br><span class=\"line\">360104     青云谱区</span><br><span class=\"line\">360105     湾里区</span><br><span class=\"line\">360111     青山湖区</span><br><span class=\"line\">360121     南昌县</span><br><span class=\"line\">360122     新建区</span><br><span class=\"line\">360123     安义县</span><br><span class=\"line\">360124     进贤县</span><br><span class=\"line\">360200     景德镇市</span><br><span class=\"line\">360202     昌江区</span><br><span class=\"line\">360203     珠山区</span><br><span class=\"line\">360222     浮梁县</span><br><span class=\"line\">360281     乐平市</span><br><span class=\"line\">360300     萍乡市</span><br><span class=\"line\">360302     安源区</span><br><span class=\"line\">360313     湘东区</span><br><span class=\"line\">360321     莲花县</span><br><span class=\"line\">360322     上栗县</span><br><span class=\"line\">360323     芦溪县</span><br><span class=\"line\">360400     九江市</span><br><span class=\"line\">360402     濂溪区</span><br><span class=\"line\">360403     浔阳区</span><br><span class=\"line\">360421     柴桑区</span><br><span class=\"line\">360423     武宁县</span><br><span class=\"line\">360424     修水县</span><br><span class=\"line\">360425     永修县</span><br><span class=\"line\">360426     德安县</span><br><span class=\"line\">360427     庐山市</span><br><span class=\"line\">360428     都昌县</span><br><span class=\"line\">360429     湖口县</span><br><span class=\"line\">360430     彭泽县</span><br><span class=\"line\">360481     瑞昌市</span><br><span class=\"line\">360482     共青城市</span><br><span class=\"line\">360500     新余市</span><br><span class=\"line\">360502     渝水区</span><br><span class=\"line\">360521     分宜县</span><br><span class=\"line\">360600     鹰潭市</span><br><span class=\"line\">360602     月湖区</span><br><span class=\"line\">360603     余江区</span><br><span class=\"line\">360681     贵溪市</span><br><span class=\"line\">360700     赣州市</span><br><span class=\"line\">360702     章贡区</span><br><span class=\"line\">360704     赣县区</span><br><span class=\"line\">360722     信丰县</span><br><span class=\"line\">360723     大余县</span><br><span class=\"line\">360724     上犹县</span><br><span class=\"line\">360725     崇义县</span><br><span class=\"line\">360726     安远县</span><br><span class=\"line\">360727     龙南县</span><br><span class=\"line\">360728     定南县</span><br><span class=\"line\">360729     全南县</span><br><span class=\"line\">360730     宁都县</span><br><span class=\"line\">360731     于都县</span><br><span class=\"line\">360732     兴国县</span><br><span class=\"line\">360733     会昌县</span><br><span class=\"line\">360734     寻乌县</span><br><span class=\"line\">360735     石城县</span><br><span class=\"line\">360781     瑞金市</span><br><span class=\"line\">360782     南康区</span><br><span class=\"line\">360800     吉安市</span><br><span class=\"line\">360802     吉州区</span><br><span class=\"line\">360803     青原区</span><br><span class=\"line\">360821     吉安县</span><br><span class=\"line\">360822     吉水县</span><br><span class=\"line\">360823     峡江县</span><br><span class=\"line\">360824     新干县</span><br><span class=\"line\">360825     永丰县</span><br><span class=\"line\">360826     泰和县</span><br><span class=\"line\">360827     遂川县</span><br><span class=\"line\">360828     万安县</span><br><span class=\"line\">360829     安福县</span><br><span class=\"line\">360830     永新县</span><br><span class=\"line\">360881     井冈山市</span><br><span class=\"line\">360900     宜春市</span><br><span class=\"line\">360902     袁州区</span><br><span class=\"line\">360921     奉新县</span><br><span class=\"line\">360922     万载县</span><br><span class=\"line\">360923     上高县</span><br><span class=\"line\">360924     宜丰县</span><br><span class=\"line\">360925     靖安县</span><br><span class=\"line\">360926     铜鼓县</span><br><span class=\"line\">360981     丰城市</span><br><span class=\"line\">360982     樟树市</span><br><span class=\"line\">360983     高安市</span><br><span class=\"line\">361000     抚州市</span><br><span class=\"line\">361002     临川区</span><br><span class=\"line\">361003     东乡区</span><br><span class=\"line\">361021     南城县</span><br><span class=\"line\">361022     黎川县</span><br><span class=\"line\">361023     南丰县</span><br><span class=\"line\">361024     崇仁县</span><br><span class=\"line\">361025     乐安县</span><br><span class=\"line\">361026     宜黄县</span><br><span class=\"line\">361027     金溪县</span><br><span class=\"line\">361028     资溪县</span><br><span class=\"line\">361030     广昌县</span><br><span class=\"line\">361100     上饶市</span><br><span class=\"line\">361102     信州区</span><br><span class=\"line\">361121     上饶县</span><br><span class=\"line\">361122     广丰区</span><br><span class=\"line\">361123     玉山县</span><br><span class=\"line\">361124     铅山县</span><br><span class=\"line\">361125     横峰县</span><br><span class=\"line\">361126     弋阳县</span><br><span class=\"line\">361127     余干县</span><br><span class=\"line\">361128     鄱阳县</span><br><span class=\"line\">361129     万年县</span><br><span class=\"line\">361130     婺源县</span><br><span class=\"line\">361181     德兴市</span><br><span class=\"line\">370000                 山东省</span><br><span class=\"line\">370100     济南市</span><br><span class=\"line\">370102     历下区</span><br><span class=\"line\">370103     市中区</span><br><span class=\"line\">370104     槐荫区</span><br><span class=\"line\">370105     天桥区</span><br><span class=\"line\">370112     历城区</span><br><span class=\"line\">370113     长清区</span><br><span class=\"line\">370114     章丘区</span><br><span class=\"line\">370124     平阴县</span><br><span class=\"line\">370125     济阳区</span><br><span class=\"line\">370126     商河县</span><br><span class=\"line\">370200     青岛市</span><br><span class=\"line\">370202     市南区</span><br><span class=\"line\">370203     市北区</span><br><span class=\"line\">370211     黄岛区</span><br><span class=\"line\">370212     崂山区</span><br><span class=\"line\">370213     李沧区</span><br><span class=\"line\">370214     城阳区</span><br><span class=\"line\">370281     胶州市</span><br><span class=\"line\">370282     即墨区</span><br><span class=\"line\">370283     平度市</span><br><span class=\"line\">370285     莱西市</span><br><span class=\"line\">370300     淄博市</span><br><span class=\"line\">370302     淄川区</span><br><span class=\"line\">370303     张店区</span><br><span class=\"line\">370304     博山区</span><br><span class=\"line\">370305     临淄区</span><br><span class=\"line\">370306     周村区</span><br><span class=\"line\">370321     桓台县</span><br><span class=\"line\">370322     高青县</span><br><span class=\"line\">370323     沂源县</span><br><span class=\"line\">370400     枣庄市</span><br><span class=\"line\">370402     市中区</span><br><span class=\"line\">370403     薛城区</span><br><span class=\"line\">370404     峄城区</span><br><span class=\"line\">370405     台儿庄区</span><br><span class=\"line\">370406     山亭区</span><br><span class=\"line\">370481     滕州市</span><br><span class=\"line\">370500     东营市</span><br><span class=\"line\">370502     东营区</span><br><span class=\"line\">370503     河口区</span><br><span class=\"line\">370505     垦利区</span><br><span class=\"line\">370522     利津县</span><br><span class=\"line\">370523     广饶县</span><br><span class=\"line\">370600     烟台市</span><br><span class=\"line\">370602     芝罘区</span><br><span class=\"line\">370611     福山区</span><br><span class=\"line\">370612     牟平区</span><br><span class=\"line\">370613     莱山区</span><br><span class=\"line\">370634     长岛县</span><br><span class=\"line\">370681     龙口市</span><br><span class=\"line\">370682     莱阳市</span><br><span class=\"line\">370683     莱州市</span><br><span class=\"line\">370684     蓬莱市</span><br><span class=\"line\">370685     招远市</span><br><span class=\"line\">370686     栖霞市</span><br><span class=\"line\">370687     海阳市</span><br><span class=\"line\">370700     潍坊市</span><br><span class=\"line\">370702     潍城区</span><br><span class=\"line\">370703     寒亭区</span><br><span class=\"line\">370704     坊子区</span><br><span class=\"line\">370705     奎文区</span><br><span class=\"line\">370724     临朐县</span><br><span class=\"line\">370725     昌乐县</span><br><span class=\"line\">370781     青州市</span><br><span class=\"line\">370782     诸城市</span><br><span class=\"line\">370783     寿光市</span><br><span class=\"line\">370784     安丘市</span><br><span class=\"line\">370785     高密市</span><br><span class=\"line\">370786     昌邑市</span><br><span class=\"line\">370800     济宁市</span><br><span class=\"line\">370802     市中区</span><br><span class=\"line\">370811     任城区</span><br><span class=\"line\">370812     兖州区</span><br><span class=\"line\">370826     微山县</span><br><span class=\"line\">370827     鱼台县</span><br><span class=\"line\">370828     金乡县</span><br><span class=\"line\">370829     嘉祥县</span><br><span class=\"line\">370830     汶上县</span><br><span class=\"line\">370831     泗水县</span><br><span class=\"line\">370832     梁山县</span><br><span class=\"line\">370881     曲阜市</span><br><span class=\"line\">370883     邹城市</span><br><span class=\"line\">370900     泰安市</span><br><span class=\"line\">370902     泰山区</span><br><span class=\"line\">370911     岱岳区</span><br><span class=\"line\">370921     宁阳县</span><br><span class=\"line\">370923     东平县</span><br><span class=\"line\">370982     新泰市</span><br><span class=\"line\">370983     肥城市</span><br><span class=\"line\">371000     威海市</span><br><span class=\"line\">371002     环翠区</span><br><span class=\"line\">371081     文登区</span><br><span class=\"line\">371082     荣成市</span><br><span class=\"line\">371083     乳山市</span><br><span class=\"line\">371100     日照市</span><br><span class=\"line\">371102     东港区</span><br><span class=\"line\">371103     岚山区</span><br><span class=\"line\">371121     五莲县</span><br><span class=\"line\">371122     莒县</span><br><span class=\"line\">371200     莱芜</span><br><span class=\"line\">371202     莱芜区</span><br><span class=\"line\">371203     钢城区</span><br><span class=\"line\">371300     临沂市</span><br><span class=\"line\">371302     兰山区</span><br><span class=\"line\">371311     罗庄区</span><br><span class=\"line\">371312     河东区</span><br><span class=\"line\">371321     沂南县</span><br><span class=\"line\">371322     郯城县</span><br><span class=\"line\">371323     沂水县</span><br><span class=\"line\">371324     兰陵县</span><br><span class=\"line\">371325     费县</span><br><span class=\"line\">371326     平邑县</span><br><span class=\"line\">371327     莒南县</span><br><span class=\"line\">371328     蒙阴县</span><br><span class=\"line\">371329     临沭县</span><br><span class=\"line\">371400     德州市</span><br><span class=\"line\">371402     德城区</span><br><span class=\"line\">371403     陵城区</span><br><span class=\"line\">371422     宁津县</span><br><span class=\"line\">371423     庆云县</span><br><span class=\"line\">371424     临邑县</span><br><span class=\"line\">371425     齐河县</span><br><span class=\"line\">371426     平原县</span><br><span class=\"line\">371427     夏津县</span><br><span class=\"line\">371428     武城县</span><br><span class=\"line\">371481     乐陵市</span><br><span class=\"line\">371482     禹城市</span><br><span class=\"line\">371500     聊城市</span><br><span class=\"line\">371502     东昌府区</span><br><span class=\"line\">371521     阳谷县</span><br><span class=\"line\">371522     莘县</span><br><span class=\"line\">371523     茌平县</span><br><span class=\"line\">371524     东阿县</span><br><span class=\"line\">371525     冠县</span><br><span class=\"line\">371526     高唐县</span><br><span class=\"line\">371581     临清市</span><br><span class=\"line\">371600     滨州市</span><br><span class=\"line\">371600     经济开发区</span><br><span class=\"line\">371600     高新技术产业开发区</span><br><span class=\"line\">371602     滨城区</span><br><span class=\"line\">371603     沾化区</span><br><span class=\"line\">371621     惠民县</span><br><span class=\"line\">371622     阳信县</span><br><span class=\"line\">371623     无棣县</span><br><span class=\"line\">371625     博兴县</span><br><span class=\"line\">371626     邹平市</span><br><span class=\"line\">371700     菏泽市</span><br><span class=\"line\">371702     牡丹区</span><br><span class=\"line\">371703     定陶区</span><br><span class=\"line\">371721     曹县</span><br><span class=\"line\">371722     单县</span><br><span class=\"line\">371723     成武县</span><br><span class=\"line\">371724     巨野县</span><br><span class=\"line\">371725     郓城县</span><br><span class=\"line\">371726     鄄城县</span><br><span class=\"line\">371728     东明县</span><br><span class=\"line\">410000                 河南省</span><br><span class=\"line\">410100     郑州市</span><br><span class=\"line\">410102     中原区</span><br><span class=\"line\">410103     二七区</span><br><span class=\"line\">410104     管城回族区</span><br><span class=\"line\">410105     金水区</span><br><span class=\"line\">410106     上街区</span><br><span class=\"line\">410108     惠济区</span><br><span class=\"line\">410122     中牟县</span><br><span class=\"line\">410181     巩义市</span><br><span class=\"line\">410182     荥阳市</span><br><span class=\"line\">410183     新密市</span><br><span class=\"line\">410184     新郑市</span><br><span class=\"line\">410185     登封市</span><br><span class=\"line\">410200     开封市</span><br><span class=\"line\">410202     龙亭区</span><br><span class=\"line\">410203     顺河回族区</span><br><span class=\"line\">410204     鼓楼区</span><br><span class=\"line\">410205     禹王台区</span><br><span class=\"line\">410211     金明区</span><br><span class=\"line\">410212     祥符区</span><br><span class=\"line\">410221     杞县</span><br><span class=\"line\">410222     通许县</span><br><span class=\"line\">410223     尉氏县</span><br><span class=\"line\">410225     兰考县</span><br><span class=\"line\">410300     洛阳市</span><br><span class=\"line\">410302     老城区</span><br><span class=\"line\">410303     西工区</span><br><span class=\"line\">410304     瀍河区</span><br><span class=\"line\">410305     涧西区</span><br><span class=\"line\">410306     吉利区</span><br><span class=\"line\">410311     洛龙区</span><br><span class=\"line\">410322     孟津县</span><br><span class=\"line\">410323     新安县</span><br><span class=\"line\">410324     栾川县</span><br><span class=\"line\">410325     嵩县</span><br><span class=\"line\">410326     汝阳县</span><br><span class=\"line\">410327     宜阳县</span><br><span class=\"line\">410328     洛宁县</span><br><span class=\"line\">410329     伊川县</span><br><span class=\"line\">410381     偃师市</span><br><span class=\"line\">410400     平顶山市</span><br><span class=\"line\">410402     新华区</span><br><span class=\"line\">410403     卫东区</span><br><span class=\"line\">410404     石龙区</span><br><span class=\"line\">410411     湛河区</span><br><span class=\"line\">410421     宝丰县</span><br><span class=\"line\">410422     叶县</span><br><span class=\"line\">410423     鲁山县</span><br><span class=\"line\">410425     郏县</span><br><span class=\"line\">410481     舞钢市</span><br><span class=\"line\">410482     汝州市</span><br><span class=\"line\">410500     安阳市</span><br><span class=\"line\">410502     文峰区</span><br><span class=\"line\">410503     北关区</span><br><span class=\"line\">410505     殷都区</span><br><span class=\"line\">410506     龙安区</span><br><span class=\"line\">410522     安阳县</span><br><span class=\"line\">410523     汤阴县</span><br><span class=\"line\">410526     滑县</span><br><span class=\"line\">410527     内黄县</span><br><span class=\"line\">410581     林州市</span><br><span class=\"line\">410600     鹤壁市</span><br><span class=\"line\">410602     鹤山区</span><br><span class=\"line\">410603     山城区</span><br><span class=\"line\">410611     淇滨区</span><br><span class=\"line\">410621     浚县</span><br><span class=\"line\">410622     淇县</span><br><span class=\"line\">410700     新乡市</span><br><span class=\"line\">410702     红旗区</span><br><span class=\"line\">410703     卫滨区</span><br><span class=\"line\">410704     凤泉区</span><br><span class=\"line\">410711     牧野区</span><br><span class=\"line\">410721     新乡县</span><br><span class=\"line\">410724     获嘉县</span><br><span class=\"line\">410725     原阳县</span><br><span class=\"line\">410726     延津县</span><br><span class=\"line\">410727     封丘县</span><br><span class=\"line\">410728     长垣县</span><br><span class=\"line\">410781     卫辉市</span><br><span class=\"line\">410782     辉县市</span><br><span class=\"line\">410800     焦作市</span><br><span class=\"line\">410802     解放区</span><br><span class=\"line\">410803     中站区</span><br><span class=\"line\">410804     马村区</span><br><span class=\"line\">410811     山阳区</span><br><span class=\"line\">410821     修武县</span><br><span class=\"line\">410822     博爱县</span><br><span class=\"line\">410823     武陟县</span><br><span class=\"line\">410825     温县</span><br><span class=\"line\">410882     沁阳市</span><br><span class=\"line\">410883     孟州市</span><br><span class=\"line\">410900     濮阳市</span><br><span class=\"line\">410902     华龙区</span><br><span class=\"line\">410922     清丰县</span><br><span class=\"line\">410923     南乐县</span><br><span class=\"line\">410926     范县</span><br><span class=\"line\">410927     台前县</span><br><span class=\"line\">410928     濮阳县</span><br><span class=\"line\">411000     许昌市</span><br><span class=\"line\">411002     魏都区</span><br><span class=\"line\">411003     建安区</span><br><span class=\"line\">411024     鄢陵县</span><br><span class=\"line\">411025     襄城县</span><br><span class=\"line\">411081     禹州市</span><br><span class=\"line\">411082     长葛市</span><br><span class=\"line\">411100     漯河市</span><br><span class=\"line\">411100     经济技术开发区</span><br><span class=\"line\">411102     源汇区</span><br><span class=\"line\">411103     郾城区</span><br><span class=\"line\">411104     召陵区</span><br><span class=\"line\">411121     舞阳县</span><br><span class=\"line\">411122     临颍县</span><br><span class=\"line\">411200     三门峡市</span><br><span class=\"line\">411202     湖滨区</span><br><span class=\"line\">411221     渑池县</span><br><span class=\"line\">411222     陕州区</span><br><span class=\"line\">411224     卢氏县</span><br><span class=\"line\">411281     义马市</span><br><span class=\"line\">411282     灵宝市</span><br><span class=\"line\">411300     南阳市</span><br><span class=\"line\">411302     宛城区</span><br><span class=\"line\">411303     卧龙区</span><br><span class=\"line\">411321     南召县</span><br><span class=\"line\">411322     方城县</span><br><span class=\"line\">411323     西峡县</span><br><span class=\"line\">411324     镇平县</span><br><span class=\"line\">411325     内乡县</span><br><span class=\"line\">411326     淅川县</span><br><span class=\"line\">411327     社旗县</span><br><span class=\"line\">411328     唐河县</span><br><span class=\"line\">411329     新野县</span><br><span class=\"line\">411330     桐柏县</span><br><span class=\"line\">411381     邓州市</span><br><span class=\"line\">411400     商丘市</span><br><span class=\"line\">411402     梁园区</span><br><span class=\"line\">411403     睢阳区</span><br><span class=\"line\">411421     民权县</span><br><span class=\"line\">411422     睢县</span><br><span class=\"line\">411423     宁陵县</span><br><span class=\"line\">411424     柘城县</span><br><span class=\"line\">411425     虞城县</span><br><span class=\"line\">411426     夏邑县</span><br><span class=\"line\">411481     永城市</span><br><span class=\"line\">411500     信阳市</span><br><span class=\"line\">411502     浉河区</span><br><span class=\"line\">411503     平桥区</span><br><span class=\"line\">411521     罗山县</span><br><span class=\"line\">411522     光山县</span><br><span class=\"line\">411523     新县</span><br><span class=\"line\">411524     商城县</span><br><span class=\"line\">411525     固始县</span><br><span class=\"line\">411526     潢川县</span><br><span class=\"line\">411527     淮滨县</span><br><span class=\"line\">411528     息县</span><br><span class=\"line\">411600     周口市</span><br><span class=\"line\">411602     川汇区</span><br><span class=\"line\">411603     淮阳区</span><br><span class=\"line\">411621     扶沟县</span><br><span class=\"line\">411622     西华县</span><br><span class=\"line\">411623     商水县</span><br><span class=\"line\">411624     沈丘县</span><br><span class=\"line\">411625     郸城县</span><br><span class=\"line\">411627     太康县</span><br><span class=\"line\">411628     鹿邑县</span><br><span class=\"line\">411681     项城市</span><br><span class=\"line\">411700     驻马店市</span><br><span class=\"line\">411702     驿城区</span><br><span class=\"line\">411721     西平县</span><br><span class=\"line\">411722     上蔡县</span><br><span class=\"line\">411723     平舆县</span><br><span class=\"line\">411724     正阳县</span><br><span class=\"line\">411725     确山县</span><br><span class=\"line\">411726     泌阳县</span><br><span class=\"line\">411727     汝南县</span><br><span class=\"line\">411728     遂平县</span><br><span class=\"line\">411729     新蔡县</span><br><span class=\"line\">419001     济源市</span><br><span class=\"line\">420000                 湖北省</span><br><span class=\"line\">420100     武汉市</span><br><span class=\"line\">420102     江岸区</span><br><span class=\"line\">420103     江汉区</span><br><span class=\"line\">420104     硚口区</span><br><span class=\"line\">420105     汉阳区</span><br><span class=\"line\">420106     武昌区</span><br><span class=\"line\">420107     青山区</span><br><span class=\"line\">420111     洪山区</span><br><span class=\"line\">420112     东西湖区</span><br><span class=\"line\">420113     汉南区</span><br><span class=\"line\">420114     蔡甸区</span><br><span class=\"line\">420115     江夏区</span><br><span class=\"line\">420116     黄陂区</span><br><span class=\"line\">420117     新洲区</span><br><span class=\"line\">420200     黄石市</span><br><span class=\"line\">420202     黄石港区</span><br><span class=\"line\">420203     西塞山区</span><br><span class=\"line\">420204     下陆区</span><br><span class=\"line\">420205     铁山区</span><br><span class=\"line\">420222     阳新县</span><br><span class=\"line\">420281     大冶市</span><br><span class=\"line\">420300     十堰市</span><br><span class=\"line\">420302     茅箭区</span><br><span class=\"line\">420303     张湾区</span><br><span class=\"line\">420304     郧阳区</span><br><span class=\"line\">420322     郧西县</span><br><span class=\"line\">420323     竹山县</span><br><span class=\"line\">420324     竹溪县</span><br><span class=\"line\">420325     房县</span><br><span class=\"line\">420381     丹江口市</span><br><span class=\"line\">420500     宜昌市</span><br><span class=\"line\">420502     西陵区</span><br><span class=\"line\">420503     伍家岗区</span><br><span class=\"line\">420504     点军区</span><br><span class=\"line\">420505     猇亭区</span><br><span class=\"line\">420506     夷陵区</span><br><span class=\"line\">420525     远安县</span><br><span class=\"line\">420526     兴山县</span><br><span class=\"line\">420527     秭归县</span><br><span class=\"line\">420528     长阳县</span><br><span class=\"line\">420529     五峰县</span><br><span class=\"line\">420581     宜都市</span><br><span class=\"line\">420582     当阳市</span><br><span class=\"line\">420583     枝江市</span><br><span class=\"line\">420600     襄阳市</span><br><span class=\"line\">420602     襄城区</span><br><span class=\"line\">420606     樊城区</span><br><span class=\"line\">420607     襄州区</span><br><span class=\"line\">420624     南漳县</span><br><span class=\"line\">420625     谷城县</span><br><span class=\"line\">420626     保康县</span><br><span class=\"line\">420682     老河口市</span><br><span class=\"line\">420683     枣阳市</span><br><span class=\"line\">420684     宜城市</span><br><span class=\"line\">420700     鄂州市</span><br><span class=\"line\">420702     梁子湖区</span><br><span class=\"line\">420703     华容区</span><br><span class=\"line\">420704     鄂城区</span><br><span class=\"line\">420800     荆门市</span><br><span class=\"line\">420802     东宝区</span><br><span class=\"line\">420804     掇刀区</span><br><span class=\"line\">420821     京山市</span><br><span class=\"line\">420822     沙洋县</span><br><span class=\"line\">420881     钟祥市</span><br><span class=\"line\">420900     孝感市</span><br><span class=\"line\">420902     孝南区</span><br><span class=\"line\">420921     孝昌县</span><br><span class=\"line\">420922     大悟县</span><br><span class=\"line\">420923     云梦县</span><br><span class=\"line\">420981     应城市</span><br><span class=\"line\">420982     安陆市</span><br><span class=\"line\">420984     汉川市</span><br><span class=\"line\">421000     荆州市</span><br><span class=\"line\">421002     沙市区</span><br><span class=\"line\">421003     荆州区</span><br><span class=\"line\">421022     公安县</span><br><span class=\"line\">421023     监利县</span><br><span class=\"line\">421024     江陵县</span><br><span class=\"line\">421071     荆州经济技术开发区</span><br><span class=\"line\">421081     石首市</span><br><span class=\"line\">421083     洪湖市</span><br><span class=\"line\">421087     松滋市</span><br><span class=\"line\">421100     黄冈市</span><br><span class=\"line\">421102     黄州区</span><br><span class=\"line\">421121     团风县</span><br><span class=\"line\">421122     红安县</span><br><span class=\"line\">421123     罗田县</span><br><span class=\"line\">421124     英山县</span><br><span class=\"line\">421125     浠水县</span><br><span class=\"line\">421126     蕲春县</span><br><span class=\"line\">421127     黄梅县</span><br><span class=\"line\">421181     麻城市</span><br><span class=\"line\">421182     武穴市</span><br><span class=\"line\">421200     咸宁市</span><br><span class=\"line\">421202     咸安区</span><br><span class=\"line\">421221     嘉鱼县</span><br><span class=\"line\">421222     通城县</span><br><span class=\"line\">421223     崇阳县</span><br><span class=\"line\">421224     通山县</span><br><span class=\"line\">421281     赤壁市</span><br><span class=\"line\">421300     随州市</span><br><span class=\"line\">421303     曾都区</span><br><span class=\"line\">421321     随县</span><br><span class=\"line\">421381     广水市</span><br><span class=\"line\">422800     恩施州</span><br><span class=\"line\">422801     恩施市</span><br><span class=\"line\">422802     利川市</span><br><span class=\"line\">422822     建始县</span><br><span class=\"line\">422823     巴东县</span><br><span class=\"line\">422825     宣恩县</span><br><span class=\"line\">422826     咸丰县</span><br><span class=\"line\">422827     来凤县</span><br><span class=\"line\">422828     鹤峰县</span><br><span class=\"line\">429004     仙桃市</span><br><span class=\"line\">429005     潜江市</span><br><span class=\"line\">429006     天门市</span><br><span class=\"line\">429021     神农架林区</span><br><span class=\"line\">430000                 湖南省</span><br><span class=\"line\">430100     长沙市</span><br><span class=\"line\">430102     芙蓉区</span><br><span class=\"line\">430103     天心区</span><br><span class=\"line\">430104     岳麓区</span><br><span class=\"line\">430105     开福区</span><br><span class=\"line\">430111     雨花区</span><br><span class=\"line\">430112     望城区</span><br><span class=\"line\">430121     长沙县</span><br><span class=\"line\">430181     浏阳市</span><br><span class=\"line\">430182     宁乡市</span><br><span class=\"line\">430200     株洲市</span><br><span class=\"line\">430202     荷塘区</span><br><span class=\"line\">430203     芦淞区</span><br><span class=\"line\">430204     石峰区</span><br><span class=\"line\">430211     天元区</span><br><span class=\"line\">430212     渌口区</span><br><span class=\"line\">430223     攸县</span><br><span class=\"line\">430224     茶陵县</span><br><span class=\"line\">430225     炎陵县</span><br><span class=\"line\">430271     云龙示范区</span><br><span class=\"line\">430281     醴陵市</span><br><span class=\"line\">430300     湘潭市</span><br><span class=\"line\">430302     雨湖区</span><br><span class=\"line\">430304     岳塘区</span><br><span class=\"line\">430321     湘潭县</span><br><span class=\"line\">430371     高新技术产业园区</span><br><span class=\"line\">430372     昭山示范区</span><br><span class=\"line\">430373     九华示范区</span><br><span class=\"line\">430381     湘乡市</span><br><span class=\"line\">430382     韶山市</span><br><span class=\"line\">430400     衡阳市</span><br><span class=\"line\">430405     珠晖区</span><br><span class=\"line\">430406     雁峰区</span><br><span class=\"line\">430407     石鼓区</span><br><span class=\"line\">430408     蒸湘区</span><br><span class=\"line\">430412     南岳区</span><br><span class=\"line\">430421     衡阳县</span><br><span class=\"line\">430422     衡南县</span><br><span class=\"line\">430423     衡山县</span><br><span class=\"line\">430424     衡东县</span><br><span class=\"line\">430426     祁东县</span><br><span class=\"line\">430481     耒阳市</span><br><span class=\"line\">430482     常宁市</span><br><span class=\"line\">430500     邵阳市</span><br><span class=\"line\">430502     双清区</span><br><span class=\"line\">430503     大祥区</span><br><span class=\"line\">430511     北塔区</span><br><span class=\"line\">430522     新邵县</span><br><span class=\"line\">430523     邵阳县</span><br><span class=\"line\">430524     隆回县</span><br><span class=\"line\">430525     洞口县</span><br><span class=\"line\">430527     绥宁县</span><br><span class=\"line\">430528     新宁县</span><br><span class=\"line\">430529     城步苗族自治县</span><br><span class=\"line\">430581     武冈市</span><br><span class=\"line\">430582     邵东市</span><br><span class=\"line\">430600     岳阳市</span><br><span class=\"line\">430602     岳阳楼区</span><br><span class=\"line\">430603     云溪区</span><br><span class=\"line\">430611     君山区</span><br><span class=\"line\">430621     岳阳县</span><br><span class=\"line\">430623     华容县</span><br><span class=\"line\">430624     湘阴县</span><br><span class=\"line\">430626     平江县</span><br><span class=\"line\">430681     汨罗市</span><br><span class=\"line\">430682     临湘市</span><br><span class=\"line\">430700     常德市</span><br><span class=\"line\">430702     武陵区</span><br><span class=\"line\">430703     鼎城区</span><br><span class=\"line\">430721     安乡县</span><br><span class=\"line\">430722     汉寿县</span><br><span class=\"line\">430723     澧县</span><br><span class=\"line\">430724     临澧县</span><br><span class=\"line\">430725     桃源县</span><br><span class=\"line\">430726     石门县</span><br><span class=\"line\">430781     津市市</span><br><span class=\"line\">430800     张家界市</span><br><span class=\"line\">430802     永定区</span><br><span class=\"line\">430811     武陵源区</span><br><span class=\"line\">430821     慈利县</span><br><span class=\"line\">430822     桑植县</span><br><span class=\"line\">430900     益阳市</span><br><span class=\"line\">430902     资阳区</span><br><span class=\"line\">430903     赫山区</span><br><span class=\"line\">430921     南县</span><br><span class=\"line\">430922     桃江县</span><br><span class=\"line\">430923     安化县</span><br><span class=\"line\">430971     大通湖管理区</span><br><span class=\"line\">430972     高新技术产业园区</span><br><span class=\"line\">430981     沅江市</span><br><span class=\"line\">431000     郴州市</span><br><span class=\"line\">431002     北湖区</span><br><span class=\"line\">431003     苏仙区</span><br><span class=\"line\">431021     桂阳县</span><br><span class=\"line\">431022     宜章县</span><br><span class=\"line\">431023     永兴县</span><br><span class=\"line\">431024     嘉禾县</span><br><span class=\"line\">431025     临武县</span><br><span class=\"line\">431026     汝城县</span><br><span class=\"line\">431027     桂东县</span><br><span class=\"line\">431028     安仁县</span><br><span class=\"line\">431081     资兴市</span><br><span class=\"line\">431100     永州市</span><br><span class=\"line\">431102     零陵区</span><br><span class=\"line\">431103     冷水滩区</span><br><span class=\"line\">431121     祁阳县</span><br><span class=\"line\">431122     东安县</span><br><span class=\"line\">431123     双牌县</span><br><span class=\"line\">431124     道县</span><br><span class=\"line\">431125     江永县</span><br><span class=\"line\">431126     宁远县</span><br><span class=\"line\">431127     蓝山县</span><br><span class=\"line\">431128     新田县</span><br><span class=\"line\">431129     江华县</span><br><span class=\"line\">431200     怀化市</span><br><span class=\"line\">431202     鹤城区</span><br><span class=\"line\">431221     中方县</span><br><span class=\"line\">431222     沅陵县</span><br><span class=\"line\">431223     辰溪县</span><br><span class=\"line\">431224     溆浦县</span><br><span class=\"line\">431225     会同县</span><br><span class=\"line\">431226     麻阳县</span><br><span class=\"line\">431227     新晃县</span><br><span class=\"line\">431228     芷江县</span><br><span class=\"line\">431229     靖州县</span><br><span class=\"line\">431230     通道县</span><br><span class=\"line\">431281     洪江市</span><br><span class=\"line\">431300     娄底市</span><br><span class=\"line\">431302     娄星区</span><br><span class=\"line\">431321     双峰县</span><br><span class=\"line\">431322     新化县</span><br><span class=\"line\">431381     冷水江市</span><br><span class=\"line\">431382     涟源市</span><br><span class=\"line\">433100     湘西州</span><br><span class=\"line\">433101     吉首市</span><br><span class=\"line\">433122     泸溪县</span><br><span class=\"line\">433123     凤凰县</span><br><span class=\"line\">433124     花垣县</span><br><span class=\"line\">433125     保靖县</span><br><span class=\"line\">433126     古丈县</span><br><span class=\"line\">433127     永顺县</span><br><span class=\"line\">433130     龙山县</span><br><span class=\"line\">440000                 广东省</span><br><span class=\"line\">440100     广州市</span><br><span class=\"line\">440103     荔湾区</span><br><span class=\"line\">440104     越秀区</span><br><span class=\"line\">440105     海珠区</span><br><span class=\"line\">440106     天河区</span><br><span class=\"line\">440111     白云区</span><br><span class=\"line\">440112     黄埔区</span><br><span class=\"line\">440113     番禺区</span><br><span class=\"line\">440114     花都区</span><br><span class=\"line\">440115     南沙区</span><br><span class=\"line\">440116     萝岗区</span><br><span class=\"line\">440117     从化区</span><br><span class=\"line\">440118     增城区</span><br><span class=\"line\">440200     韶关市</span><br><span class=\"line\">440203     武江区</span><br><span class=\"line\">440204     浈江区</span><br><span class=\"line\">440205     曲江区</span><br><span class=\"line\">440222     始兴县</span><br><span class=\"line\">440224     仁化县</span><br><span class=\"line\">440229     翁源县</span><br><span class=\"line\">440232     乳源县</span><br><span class=\"line\">440233     新丰县</span><br><span class=\"line\">440281     乐昌市</span><br><span class=\"line\">440282     南雄市</span><br><span class=\"line\">440300     深圳市</span><br><span class=\"line\">440303     罗湖区</span><br><span class=\"line\">440304     福田区</span><br><span class=\"line\">440305     南山区</span><br><span class=\"line\">440306     宝安区</span><br><span class=\"line\">440307     龙岗区</span><br><span class=\"line\">440308     盐田区</span><br><span class=\"line\">440309     龙华区</span><br><span class=\"line\">440310     坪山区</span><br><span class=\"line\">440311     光明区</span><br><span class=\"line\">440400     珠海市</span><br><span class=\"line\">440402     香洲区</span><br><span class=\"line\">440403     斗门区</span><br><span class=\"line\">440404     金湾区</span><br><span class=\"line\">440500     汕头市</span><br><span class=\"line\">440507     龙湖区</span><br><span class=\"line\">440511     金平区</span><br><span class=\"line\">440512     濠江区</span><br><span class=\"line\">440513     潮阳区</span><br><span class=\"line\">440514     潮南区</span><br><span class=\"line\">440515     澄海区</span><br><span class=\"line\">440523     南澳县</span><br><span class=\"line\">440600     佛山市</span><br><span class=\"line\">440604     禅城区</span><br><span class=\"line\">440605     南海区</span><br><span class=\"line\">440606     顺德区</span><br><span class=\"line\">440607     三水区</span><br><span class=\"line\">440608     高明区</span><br><span class=\"line\">440700     江门市</span><br><span class=\"line\">440703     蓬江区</span><br><span class=\"line\">440704     江海区</span><br><span class=\"line\">440705     新会区</span><br><span class=\"line\">440781     台山市</span><br><span class=\"line\">440783     开平市</span><br><span class=\"line\">440784     鹤山市</span><br><span class=\"line\">440785     恩平市</span><br><span class=\"line\">440800     湛江市</span><br><span class=\"line\">440802     赤坎区</span><br><span class=\"line\">440803     霞山区</span><br><span class=\"line\">440804     坡头区</span><br><span class=\"line\">440811     麻章区</span><br><span class=\"line\">440823     遂溪县</span><br><span class=\"line\">440825     徐闻县</span><br><span class=\"line\">440881     廉江市</span><br><span class=\"line\">440882     雷州市</span><br><span class=\"line\">440883     吴川市</span><br><span class=\"line\">440900     茂名市</span><br><span class=\"line\">440902     茂南区</span><br><span class=\"line\">440903     茂港区</span><br><span class=\"line\">440904     电白区</span><br><span class=\"line\">440981     高州市</span><br><span class=\"line\">440982     化州市</span><br><span class=\"line\">440983     信宜市</span><br><span class=\"line\">441200     肇庆市</span><br><span class=\"line\">441202     端州区</span><br><span class=\"line\">441203     鼎湖区</span><br><span class=\"line\">441204     高要区</span><br><span class=\"line\">441223     广宁县</span><br><span class=\"line\">441224     怀集县</span><br><span class=\"line\">441225     封开县</span><br><span class=\"line\">441226     德庆县</span><br><span class=\"line\">441284     四会市</span><br><span class=\"line\">441300     惠州市</span><br><span class=\"line\">441302     惠城区</span><br><span class=\"line\">441303     惠阳区</span><br><span class=\"line\">441322     博罗县</span><br><span class=\"line\">441323     惠东县</span><br><span class=\"line\">441324     龙门县</span><br><span class=\"line\">441400     梅州市</span><br><span class=\"line\">441402     梅江区</span><br><span class=\"line\">441421     梅县区</span><br><span class=\"line\">441422     大埔县</span><br><span class=\"line\">441423     丰顺县</span><br><span class=\"line\">441424     五华县</span><br><span class=\"line\">441426     平远县</span><br><span class=\"line\">441427     蕉岭县</span><br><span class=\"line\">441481     兴宁市</span><br><span class=\"line\">441500     汕尾市</span><br><span class=\"line\">441502     城区</span><br><span class=\"line\">441521     海丰县</span><br><span class=\"line\">441523     陆河县</span><br><span class=\"line\">441581     陆丰市</span><br><span class=\"line\">441600     河源市</span><br><span class=\"line\">441602     源城区</span><br><span class=\"line\">441621     紫金县</span><br><span class=\"line\">441622     龙川县</span><br><span class=\"line\">441623     连平县</span><br><span class=\"line\">441624     和平县</span><br><span class=\"line\">441625     东源县</span><br><span class=\"line\">441700     阳江市</span><br><span class=\"line\">441702     江城区</span><br><span class=\"line\">441704     阳东区</span><br><span class=\"line\">441721     阳西县</span><br><span class=\"line\">441781     阳春市</span><br><span class=\"line\">441800     清远市</span><br><span class=\"line\">441802     清城区</span><br><span class=\"line\">441803     清新区</span><br><span class=\"line\">441821     佛冈县</span><br><span class=\"line\">441823     阳山县</span><br><span class=\"line\">441825     连山县</span><br><span class=\"line\">441826     连南县</span><br><span class=\"line\">441881     英德市</span><br><span class=\"line\">441882     连州市</span><br><span class=\"line\">441900     东莞市</span><br><span class=\"line\">442000     中山市</span><br><span class=\"line\">445100     潮州市</span><br><span class=\"line\">445102     湘桥区</span><br><span class=\"line\">445103     潮安区</span><br><span class=\"line\">445122     饶平县</span><br><span class=\"line\">445200     揭阳市</span><br><span class=\"line\">445202     榕城区</span><br><span class=\"line\">445203     揭东区</span><br><span class=\"line\">445222     揭西县</span><br><span class=\"line\">445224     惠来县</span><br><span class=\"line\">445281     普宁市</span><br><span class=\"line\">445300     云浮市</span><br><span class=\"line\">445302     云城区</span><br><span class=\"line\">445303     云安区</span><br><span class=\"line\">445321     新兴县</span><br><span class=\"line\">445322     郁南县</span><br><span class=\"line\">445381     罗定市</span><br><span class=\"line\">450000                 广西</span><br><span class=\"line\">450100     南宁市</span><br><span class=\"line\">450102     兴宁区</span><br><span class=\"line\">450103     青秀区</span><br><span class=\"line\">450105     江南区</span><br><span class=\"line\">450107     西乡塘区</span><br><span class=\"line\">450108     良庆区</span><br><span class=\"line\">450109     邕宁区</span><br><span class=\"line\">450122     武鸣区</span><br><span class=\"line\">450123     隆安县</span><br><span class=\"line\">450124     马山县</span><br><span class=\"line\">450125     上林县</span><br><span class=\"line\">450126     宾阳县</span><br><span class=\"line\">450127     横县</span><br><span class=\"line\">450200     柳州市</span><br><span class=\"line\">450202     城中区</span><br><span class=\"line\">450203     鱼峰区</span><br><span class=\"line\">450204     柳南区</span><br><span class=\"line\">450205     柳北区</span><br><span class=\"line\">450206     柳江区</span><br><span class=\"line\">450222     柳城县</span><br><span class=\"line\">450223     鹿寨县</span><br><span class=\"line\">450224     融安县</span><br><span class=\"line\">450225     融水县</span><br><span class=\"line\">450226     三江县</span><br><span class=\"line\">450300     桂林市</span><br><span class=\"line\">450302     秀峰区</span><br><span class=\"line\">450303     叠彩区</span><br><span class=\"line\">450304     象山区</span><br><span class=\"line\">450305     七星区</span><br><span class=\"line\">450311     雁山区</span><br><span class=\"line\">450312     临桂区</span><br><span class=\"line\">450321     阳朔县</span><br><span class=\"line\">450323     灵川县</span><br><span class=\"line\">450324     全州县</span><br><span class=\"line\">450325     兴安县</span><br><span class=\"line\">450326     永福县</span><br><span class=\"line\">450327     灌阳县</span><br><span class=\"line\">450328     龙胜县</span><br><span class=\"line\">450329     资源县</span><br><span class=\"line\">450330     平乐县</span><br><span class=\"line\">450331     荔浦县</span><br><span class=\"line\">450332     恭城县</span><br><span class=\"line\">450400     梧州市</span><br><span class=\"line\">450403     万秀区</span><br><span class=\"line\">450404     龙圩区</span><br><span class=\"line\">450405     长洲区</span><br><span class=\"line\">450421     苍梧县</span><br><span class=\"line\">450422     藤县</span><br><span class=\"line\">450423     蒙山县</span><br><span class=\"line\">450481     岑溪市</span><br><span class=\"line\">450500     北海市</span><br><span class=\"line\">450502     海城区</span><br><span class=\"line\">450503     银海区</span><br><span class=\"line\">450512     铁山港区</span><br><span class=\"line\">450521     合浦县</span><br><span class=\"line\">450600     防城港市</span><br><span class=\"line\">450602     港口区</span><br><span class=\"line\">450603     防城区</span><br><span class=\"line\">450621     上思县</span><br><span class=\"line\">450681     东兴市</span><br><span class=\"line\">450700     钦州市</span><br><span class=\"line\">450702     钦南区</span><br><span class=\"line\">450703     钦北区</span><br><span class=\"line\">450721     灵山县</span><br><span class=\"line\">450722     浦北区</span><br><span class=\"line\">450800     贵港市</span><br><span class=\"line\">450802     港北区</span><br><span class=\"line\">450803     港南区</span><br><span class=\"line\">450804     覃塘区</span><br><span class=\"line\">450821     平南县</span><br><span class=\"line\">450881     桂平市</span><br><span class=\"line\">450900     玉林市</span><br><span class=\"line\">450902     玉州区</span><br><span class=\"line\">450921     容县</span><br><span class=\"line\">450922     陆川县</span><br><span class=\"line\">450923     博白县</span><br><span class=\"line\">450924     兴业县</span><br><span class=\"line\">450981     北流市</span><br><span class=\"line\">451000     百色市</span><br><span class=\"line\">451002     右江区</span><br><span class=\"line\">451003     田阳区</span><br><span class=\"line\">451022     田东县</span><br><span class=\"line\">451023     平果县</span><br><span class=\"line\">451024     德保县</span><br><span class=\"line\">451025     靖西市</span><br><span class=\"line\">451026     那坡县</span><br><span class=\"line\">451027     凌云县</span><br><span class=\"line\">451028     乐业县</span><br><span class=\"line\">451029     田林县</span><br><span class=\"line\">451030     西林县</span><br><span class=\"line\">451031     隆林县</span><br><span class=\"line\">451100     贺州市</span><br><span class=\"line\">451102     八步区</span><br><span class=\"line\">451103     平桂区</span><br><span class=\"line\">451121     昭平县</span><br><span class=\"line\">451122     钟山县</span><br><span class=\"line\">451123     富川县</span><br><span class=\"line\">451200     河池市</span><br><span class=\"line\">451202     金城江区</span><br><span class=\"line\">451203     宜州区</span><br><span class=\"line\">451221     南丹县</span><br><span class=\"line\">451222     天蛾县</span><br><span class=\"line\">451223     凤山县</span><br><span class=\"line\">451224     东兰县</span><br><span class=\"line\">451225     罗城县</span><br><span class=\"line\">451226     环江县</span><br><span class=\"line\">451227     巴马县</span><br><span class=\"line\">451228     都安县</span><br><span class=\"line\">451229     大化县</span><br><span class=\"line\">451300     来宾市</span><br><span class=\"line\">451302     兴宾区</span><br><span class=\"line\">451321     忻城县</span><br><span class=\"line\">451322     象州县</span><br><span class=\"line\">451323     武宣县</span><br><span class=\"line\">451324     金秀县</span><br><span class=\"line\">451381     合山市</span><br><span class=\"line\">451400     崇左市</span><br><span class=\"line\">451402     江州区</span><br><span class=\"line\">451421     扶绥县</span><br><span class=\"line\">451422     宁明县</span><br><span class=\"line\">451423     龙州县</span><br><span class=\"line\">451424     大新县</span><br><span class=\"line\">451425     天等县</span><br><span class=\"line\">451481     凭祥市</span><br><span class=\"line\">460000                 海南省</span><br><span class=\"line\">460100     海口市</span><br><span class=\"line\">460105     秀英区</span><br><span class=\"line\">460106     龙华区</span><br><span class=\"line\">460107     琼山区</span><br><span class=\"line\">460108     美兰区</span><br><span class=\"line\">460200     三亚市</span><br><span class=\"line\">469001     五指山市</span><br><span class=\"line\">469002     琼海市</span><br><span class=\"line\">469003     儋州市</span><br><span class=\"line\">469005     文昌市</span><br><span class=\"line\">469006     万宁市</span><br><span class=\"line\">469007     东方市</span><br><span class=\"line\">469021     定安县</span><br><span class=\"line\">469022     屯昌县</span><br><span class=\"line\">469023     澄迈县</span><br><span class=\"line\">469024     临高县</span><br><span class=\"line\">469025     白沙县</span><br><span class=\"line\">469026     昌江县</span><br><span class=\"line\">469027     乐东县</span><br><span class=\"line\">469028     陵水县</span><br><span class=\"line\">469029     保亭县</span><br><span class=\"line\">469030     琼中县</span><br><span class=\"line\">469031     三沙市</span><br><span class=\"line\">469031     西沙群岛</span><br><span class=\"line\">469032     南沙群岛</span><br><span class=\"line\">469033     中沙群岛的岛礁及其海域</span><br><span class=\"line\">500000                 重庆市</span><br><span class=\"line\">500101     万州区</span><br><span class=\"line\">500102     涪陵区</span><br><span class=\"line\">500103     渝中区</span><br><span class=\"line\">500104     大渡口区</span><br><span class=\"line\">500105     江北区</span><br><span class=\"line\">500106     沙坪坝区</span><br><span class=\"line\">500107     九龙坡区</span><br><span class=\"line\">500108     南岸区</span><br><span class=\"line\">500109     北碚区</span><br><span class=\"line\">500110     綦江区</span><br><span class=\"line\">500110     万盛区</span><br><span class=\"line\">500111     大足区</span><br><span class=\"line\">500111     双桥区</span><br><span class=\"line\">500112     渝北区</span><br><span class=\"line\">500113     巴南区</span><br><span class=\"line\">500114     黔江区</span><br><span class=\"line\">500115     长寿区</span><br><span class=\"line\">500116     江津区</span><br><span class=\"line\">500117     合川区</span><br><span class=\"line\">500118     永川区</span><br><span class=\"line\">500119     南川区</span><br><span class=\"line\">500120     璧山区</span><br><span class=\"line\">500151     铜梁区</span><br><span class=\"line\">500152     潼南区</span><br><span class=\"line\">500153     荣昌区</span><br><span class=\"line\">500154     开州区</span><br><span class=\"line\">500155     梁平区</span><br><span class=\"line\">500156     武隆区</span><br><span class=\"line\">500229     城口县</span><br><span class=\"line\">500230     丰都县</span><br><span class=\"line\">500231     垫江县</span><br><span class=\"line\">500233     忠县</span><br><span class=\"line\">500235     云阳县</span><br><span class=\"line\">500236     奉节县</span><br><span class=\"line\">500237     巫山县</span><br><span class=\"line\">500238     巫溪县</span><br><span class=\"line\">500240     石柱县</span><br><span class=\"line\">500241     秀山县</span><br><span class=\"line\">500242     酉阳县</span><br><span class=\"line\">500243     彭水县</span><br><span class=\"line\">510000                 四川省</span><br><span class=\"line\">510100     成都市</span><br><span class=\"line\">510104     锦江区</span><br><span class=\"line\">510105     青羊区</span><br><span class=\"line\">510106     金牛区</span><br><span class=\"line\">510107     武侯区</span><br><span class=\"line\">510108     成华区</span><br><span class=\"line\">510112     龙泉驿区</span><br><span class=\"line\">510113     青白江区</span><br><span class=\"line\">510114     新都区</span><br><span class=\"line\">510115     温江区</span><br><span class=\"line\">510116     双流区</span><br><span class=\"line\">510117     郫都区</span><br><span class=\"line\">510121     金堂县</span><br><span class=\"line\">510129     大邑县</span><br><span class=\"line\">510131     蒲江县</span><br><span class=\"line\">510132     新津县</span><br><span class=\"line\">510181     都江堰市</span><br><span class=\"line\">510182     彭州市</span><br><span class=\"line\">510183     邛崃市</span><br><span class=\"line\">510184     崇州市</span><br><span class=\"line\">510185     简阳市</span><br><span class=\"line\">510300     自贡市</span><br><span class=\"line\">510302     自流井区</span><br><span class=\"line\">510303     贡井区</span><br><span class=\"line\">510304     大安区</span><br><span class=\"line\">510311     沿滩区</span><br><span class=\"line\">510321     荣县</span><br><span class=\"line\">510322     富顺县</span><br><span class=\"line\">510400     攀枝花市</span><br><span class=\"line\">510402     东区</span><br><span class=\"line\">510403     西区</span><br><span class=\"line\">510411     仁和区</span><br><span class=\"line\">510421     米易县</span><br><span class=\"line\">510422     盐边县</span><br><span class=\"line\">510500     泸州市</span><br><span class=\"line\">510502     江阳区</span><br><span class=\"line\">510503     纳溪区</span><br><span class=\"line\">510504     龙马潭区</span><br><span class=\"line\">510521     泸县</span><br><span class=\"line\">510522     合江县</span><br><span class=\"line\">510524     叙永县</span><br><span class=\"line\">510525     古蔺县</span><br><span class=\"line\">510600     德阳市</span><br><span class=\"line\">510603     旌阳区</span><br><span class=\"line\">510604     罗江区</span><br><span class=\"line\">510623     中江县</span><br><span class=\"line\">510681     广汉市</span><br><span class=\"line\">510682     什邡市</span><br><span class=\"line\">510683     绵竹市</span><br><span class=\"line\">510700     绵阳市</span><br><span class=\"line\">510703     涪城区</span><br><span class=\"line\">510704     游仙区</span><br><span class=\"line\">510705     安州区</span><br><span class=\"line\">510722     三台县</span><br><span class=\"line\">510723     盐亭县</span><br><span class=\"line\">510725     梓潼县</span><br><span class=\"line\">510726     北川县</span><br><span class=\"line\">510727     平武县</span><br><span class=\"line\">510781     江油市</span><br><span class=\"line\">510800     广元市</span><br><span class=\"line\">510802     利州区</span><br><span class=\"line\">510811     昭化区</span><br><span class=\"line\">510812     朝天区</span><br><span class=\"line\">510821     旺苍县</span><br><span class=\"line\">510822     青川县</span><br><span class=\"line\">510823     剑阁县</span><br><span class=\"line\">510824     苍溪县</span><br><span class=\"line\">510900     遂宁市</span><br><span class=\"line\">510903     船山区</span><br><span class=\"line\">510904     安居区</span><br><span class=\"line\">510921     蓬溪县</span><br><span class=\"line\">510922     射洪市</span><br><span class=\"line\">510923     大英县</span><br><span class=\"line\">511000     内江市</span><br><span class=\"line\">511002     市中区</span><br><span class=\"line\">511011     东兴区</span><br><span class=\"line\">511024     威远县</span><br><span class=\"line\">511025     资中县</span><br><span class=\"line\">511071     经济开发区</span><br><span class=\"line\">511083     隆昌市</span><br><span class=\"line\">511100     乐山市</span><br><span class=\"line\">511102     市中区</span><br><span class=\"line\">511111     沙湾区</span><br><span class=\"line\">511112     五通桥区</span><br><span class=\"line\">511113     金口河区</span><br><span class=\"line\">511123     犍为县</span><br><span class=\"line\">511124     井研县</span><br><span class=\"line\">511126     夹江县</span><br><span class=\"line\">511129     沐川县</span><br><span class=\"line\">511132     峨边彝族自治县</span><br><span class=\"line\">511133     马边彝族自治县</span><br><span class=\"line\">511181     峨眉山市</span><br><span class=\"line\">511300     南充市</span><br><span class=\"line\">511302     顺庆区</span><br><span class=\"line\">511303     高坪区</span><br><span class=\"line\">511304     嘉陵区</span><br><span class=\"line\">511321     南部县</span><br><span class=\"line\">511322     营山县</span><br><span class=\"line\">511323     蓬安县</span><br><span class=\"line\">511324     仪陇县</span><br><span class=\"line\">511325     西充县</span><br><span class=\"line\">511381     阆中市</span><br><span class=\"line\">511400     眉山市</span><br><span class=\"line\">511402     东坡区</span><br><span class=\"line\">511403     彭山区</span><br><span class=\"line\">511421     仁寿县</span><br><span class=\"line\">511423     洪雅县</span><br><span class=\"line\">511424     丹棱县</span><br><span class=\"line\">511425     青神县</span><br><span class=\"line\">511500     宜宾市</span><br><span class=\"line\">511502     翠屏区</span><br><span class=\"line\">511503     南溪区</span><br><span class=\"line\">511504     叙州区</span><br><span class=\"line\">511523     江安县</span><br><span class=\"line\">511524     长宁县</span><br><span class=\"line\">511525     高县</span><br><span class=\"line\">511526     珙县</span><br><span class=\"line\">511527     筠连县</span><br><span class=\"line\">511528     兴文县</span><br><span class=\"line\">511529     屏山县</span><br><span class=\"line\">511600     广安市</span><br><span class=\"line\">511602     广安区</span><br><span class=\"line\">511603     前锋区</span><br><span class=\"line\">511621     岳池县</span><br><span class=\"line\">511622     武胜县</span><br><span class=\"line\">511623     邻水县</span><br><span class=\"line\">511681     华蓥市</span><br><span class=\"line\">511700     达州市</span><br><span class=\"line\">511702     通川区</span><br><span class=\"line\">511703     达川区</span><br><span class=\"line\">511722     宣汉县</span><br><span class=\"line\">511723     开江县</span><br><span class=\"line\">511724     大竹县</span><br><span class=\"line\">511725     渠县</span><br><span class=\"line\">511781     万源市</span><br><span class=\"line\">511800     雅安市</span><br><span class=\"line\">511802     雨城区</span><br><span class=\"line\">511821     名山区</span><br><span class=\"line\">511822     荥经县</span><br><span class=\"line\">511823     汉源县</span><br><span class=\"line\">511824     石棉县</span><br><span class=\"line\">511825     天全县</span><br><span class=\"line\">511826     芦山县</span><br><span class=\"line\">511827     宝兴县</span><br><span class=\"line\">511900     巴中市</span><br><span class=\"line\">511902     巴州区</span><br><span class=\"line\">511903     恩阳区</span><br><span class=\"line\">511921     通江县</span><br><span class=\"line\">511922     南江县</span><br><span class=\"line\">511923     平昌县</span><br><span class=\"line\">512000     资阳市</span><br><span class=\"line\">512002     雁江区</span><br><span class=\"line\">512021     安岳县</span><br><span class=\"line\">512022     乐至县</span><br><span class=\"line\">513200     阿坝州</span><br><span class=\"line\">513201     马尔康市</span><br><span class=\"line\">513221     汶川县</span><br><span class=\"line\">513222     理县</span><br><span class=\"line\">513223     茂县</span><br><span class=\"line\">513224     松潘县</span><br><span class=\"line\">513225     九寨沟县</span><br><span class=\"line\">513226     金川县</span><br><span class=\"line\">513227     小金县</span><br><span class=\"line\">513228     黑水县</span><br><span class=\"line\">513230     壤塘县</span><br><span class=\"line\">513231     阿坝县</span><br><span class=\"line\">513232     若尔盖县</span><br><span class=\"line\">513233     红原县</span><br><span class=\"line\">513300     甘孜州</span><br><span class=\"line\">513321     康定市</span><br><span class=\"line\">513322     泸定县</span><br><span class=\"line\">513323     丹巴县</span><br><span class=\"line\">513324     九龙县</span><br><span class=\"line\">513325     雅江县</span><br><span class=\"line\">513326     道孚县</span><br><span class=\"line\">513327     炉霍县</span><br><span class=\"line\">513328     甘孜县</span><br><span class=\"line\">513329     新龙县</span><br><span class=\"line\">513330     德格县</span><br><span class=\"line\">513331     白玉县</span><br><span class=\"line\">513332     石渠县</span><br><span class=\"line\">513333     色达县</span><br><span class=\"line\">513334     理塘县</span><br><span class=\"line\">513335     巴塘县</span><br><span class=\"line\">513336     乡城县</span><br><span class=\"line\">513337     稻城县</span><br><span class=\"line\">513338     得荣县</span><br><span class=\"line\">513400     凉山州</span><br><span class=\"line\">513401     西昌市</span><br><span class=\"line\">513422     木里县</span><br><span class=\"line\">513423     盐源县</span><br><span class=\"line\">513424     德昌县</span><br><span class=\"line\">513425     会理县</span><br><span class=\"line\">513426     会东县</span><br><span class=\"line\">513427     宁南县</span><br><span class=\"line\">513428     普格县</span><br><span class=\"line\">513429     布拖县</span><br><span class=\"line\">513430     金阳县</span><br><span class=\"line\">513431     昭觉县</span><br><span class=\"line\">513432     喜德县</span><br><span class=\"line\">513433     冕宁县</span><br><span class=\"line\">513434     越西县</span><br><span class=\"line\">513435     甘洛县</span><br><span class=\"line\">513436     美姑县</span><br><span class=\"line\">513437     雷波县</span><br><span class=\"line\">520000                 贵州省</span><br><span class=\"line\">520100     贵阳市</span><br><span class=\"line\">520102     南明区</span><br><span class=\"line\">520103     云岩区</span><br><span class=\"line\">520111     花溪区</span><br><span class=\"line\">520112     乌当区</span><br><span class=\"line\">520113     白云区</span><br><span class=\"line\">520114     观山湖区</span><br><span class=\"line\">520121     开阳县</span><br><span class=\"line\">520122     息烽县</span><br><span class=\"line\">520123     修文县</span><br><span class=\"line\">520181     清镇市</span><br><span class=\"line\">520200     六盘水市</span><br><span class=\"line\">520201     钟山区</span><br><span class=\"line\">520203     六枝特区</span><br><span class=\"line\">520221     水城县</span><br><span class=\"line\">520222     盘州市</span><br><span class=\"line\">520300     遵义市</span><br><span class=\"line\">520302     红花岗区</span><br><span class=\"line\">520303     汇川区</span><br><span class=\"line\">520321     播州区</span><br><span class=\"line\">520322     桐梓县</span><br><span class=\"line\">520323     绥阳县</span><br><span class=\"line\">520324     正安县</span><br><span class=\"line\">520325     道真县</span><br><span class=\"line\">520326     务川县</span><br><span class=\"line\">520327     凤冈县</span><br><span class=\"line\">520328     湄潭县</span><br><span class=\"line\">520329     余庆县</span><br><span class=\"line\">520330     习水县</span><br><span class=\"line\">520381     赤水市</span><br><span class=\"line\">520382     仁怀市</span><br><span class=\"line\">520400     安顺市</span><br><span class=\"line\">520402     西秀区</span><br><span class=\"line\">520403     平坝区</span><br><span class=\"line\">520422     普定县</span><br><span class=\"line\">520423     镇宁县</span><br><span class=\"line\">520424     关岭县</span><br><span class=\"line\">520425     紫云县</span><br><span class=\"line\">520500     毕节市</span><br><span class=\"line\">520502     七星关区</span><br><span class=\"line\">520521     大方县</span><br><span class=\"line\">520522     黔西县</span><br><span class=\"line\">520523     金沙县</span><br><span class=\"line\">520524     织金县</span><br><span class=\"line\">520525     纳雍县</span><br><span class=\"line\">520526     威宁县</span><br><span class=\"line\">520527     赫章县</span><br><span class=\"line\">520600     铜仁市</span><br><span class=\"line\">520602     碧江区</span><br><span class=\"line\">520603     万山区</span><br><span class=\"line\">520621     江口县</span><br><span class=\"line\">520622     玉屏县</span><br><span class=\"line\">520623     石阡县</span><br><span class=\"line\">520624     思南县</span><br><span class=\"line\">520625     印江县</span><br><span class=\"line\">520626     德江县</span><br><span class=\"line\">520627     沿河县</span><br><span class=\"line\">520628     松桃县</span><br><span class=\"line\">522300     黔西南州</span><br><span class=\"line\">522301     兴义市</span><br><span class=\"line\">522322     兴仁市</span><br><span class=\"line\">522323     普安县</span><br><span class=\"line\">522324     晴隆县</span><br><span class=\"line\">522325     贞丰县</span><br><span class=\"line\">522326     望谟县</span><br><span class=\"line\">522327     册亨县</span><br><span class=\"line\">522328     安龙县</span><br><span class=\"line\">522600     黔东南州</span><br><span class=\"line\">522601     凯里市</span><br><span class=\"line\">522622     黄平县</span><br><span class=\"line\">522623     施秉县</span><br><span class=\"line\">522624     三穗县</span><br><span class=\"line\">522626     岑巩县</span><br><span class=\"line\">522627     天柱县</span><br><span class=\"line\">522628     锦屏县</span><br><span class=\"line\">522629     剑河县</span><br><span class=\"line\">522630     台江县</span><br><span class=\"line\">522631     黎平县</span><br><span class=\"line\">522632     榕江县</span><br><span class=\"line\">522633     从江县</span><br><span class=\"line\">522634     雷山县</span><br><span class=\"line\">522635     麻江县</span><br><span class=\"line\">522636     丹寨县</span><br><span class=\"line\">522700     黔南州</span><br><span class=\"line\">522701     都匀市</span><br><span class=\"line\">522702     福泉市</span><br><span class=\"line\">522722     荔波县</span><br><span class=\"line\">522723     贵定县</span><br><span class=\"line\">522725     瓮安县</span><br><span class=\"line\">522726     独山县</span><br><span class=\"line\">522727     平塘县</span><br><span class=\"line\">522728     罗甸县</span><br><span class=\"line\">522729     长顺县</span><br><span class=\"line\">522730     龙里县</span><br><span class=\"line\">522731     惠水县</span><br><span class=\"line\">522732     三都县</span><br><span class=\"line\">530000                 云南省</span><br><span class=\"line\">530100     昆明市</span><br><span class=\"line\">530102     五华区</span><br><span class=\"line\">530103     盘龙区</span><br><span class=\"line\">530111     官渡区</span><br><span class=\"line\">530112     西山区</span><br><span class=\"line\">530113     东川区</span><br><span class=\"line\">530121     呈贡区</span><br><span class=\"line\">530122     晋宁区</span><br><span class=\"line\">530124     富民县</span><br><span class=\"line\">530125     宜良县</span><br><span class=\"line\">530126     石林彝族自治县</span><br><span class=\"line\">530127     嵩明县</span><br><span class=\"line\">530128     禄劝县</span><br><span class=\"line\">530129     寻甸县</span><br><span class=\"line\">530181     安宁市</span><br><span class=\"line\">530300     曲靖市</span><br><span class=\"line\">530302     麒麟区</span><br><span class=\"line\">530303     沾益区</span><br><span class=\"line\">530304     马龙区</span><br><span class=\"line\">530322     陆良县</span><br><span class=\"line\">530323     师宗县</span><br><span class=\"line\">530324     罗平县</span><br><span class=\"line\">530325     富源县</span><br><span class=\"line\">530326     会泽县</span><br><span class=\"line\">530381     宣威市</span><br><span class=\"line\">530400     玉溪市</span><br><span class=\"line\">530402     红塔区</span><br><span class=\"line\">530403     江川区</span><br><span class=\"line\">530422     澄江县</span><br><span class=\"line\">530423     通海县</span><br><span class=\"line\">530424     华宁县</span><br><span class=\"line\">530425     易门县</span><br><span class=\"line\">530426     峨山县</span><br><span class=\"line\">530427     新平县</span><br><span class=\"line\">530428     元江县</span><br><span class=\"line\">530500     保山市</span><br><span class=\"line\">530502     隆阳区</span><br><span class=\"line\">530521     施甸县</span><br><span class=\"line\">530523     龙陵县</span><br><span class=\"line\">530524     昌宁县</span><br><span class=\"line\">530581     腾冲市</span><br><span class=\"line\">530600     昭通市</span><br><span class=\"line\">530602     昭阳区</span><br><span class=\"line\">530621     鲁甸县</span><br><span class=\"line\">530622     巧家县</span><br><span class=\"line\">530623     盐津县</span><br><span class=\"line\">530624     大关县</span><br><span class=\"line\">530625     永善县</span><br><span class=\"line\">530626     绥江县</span><br><span class=\"line\">530627     镇雄县</span><br><span class=\"line\">530628     彝良县</span><br><span class=\"line\">530629     威信县</span><br><span class=\"line\">530630     水富县</span><br><span class=\"line\">530700     丽江市</span><br><span class=\"line\">530702     古城区</span><br><span class=\"line\">530721     玉龙县</span><br><span class=\"line\">530722     永胜县</span><br><span class=\"line\">530723     华坪县</span><br><span class=\"line\">530724     宁蒗县</span><br><span class=\"line\">530800     普洱市</span><br><span class=\"line\">530802     思茅区</span><br><span class=\"line\">530821     宁洱县</span><br><span class=\"line\">530822     墨江县</span><br><span class=\"line\">530823     景东县</span><br><span class=\"line\">530824     景谷县</span><br><span class=\"line\">530825     镇沅县</span><br><span class=\"line\">530826     江城县</span><br><span class=\"line\">530827     孟连县</span><br><span class=\"line\">530828     澜沧县</span><br><span class=\"line\">530829     西盟县</span><br><span class=\"line\">530900     临沧市</span><br><span class=\"line\">530902     临翔区</span><br><span class=\"line\">530921     凤庆县</span><br><span class=\"line\">530922     云县</span><br><span class=\"line\">530923     永德县</span><br><span class=\"line\">530924     镇康县</span><br><span class=\"line\">530925     双江县</span><br><span class=\"line\">530926     耿马县</span><br><span class=\"line\">530927     沧源县</span><br><span class=\"line\">532300     楚雄州</span><br><span class=\"line\">532301     楚雄市</span><br><span class=\"line\">532322     双柏县</span><br><span class=\"line\">532323     牟定县</span><br><span class=\"line\">532324     南华县</span><br><span class=\"line\">532325     姚安县</span><br><span class=\"line\">532326     大姚县</span><br><span class=\"line\">532327     永仁县</span><br><span class=\"line\">532328     元谋县</span><br><span class=\"line\">532329     武定县</span><br><span class=\"line\">532331     禄丰县</span><br><span class=\"line\">532500     红河州</span><br><span class=\"line\">532501     个旧市</span><br><span class=\"line\">532502     开远市</span><br><span class=\"line\">532503     蒙自市</span><br><span class=\"line\">532523     屏边县</span><br><span class=\"line\">532524     建水县</span><br><span class=\"line\">532525     石屏县</span><br><span class=\"line\">532526     弥勒市</span><br><span class=\"line\">532527     泸西县</span><br><span class=\"line\">532528     元阳县</span><br><span class=\"line\">532529     红河县</span><br><span class=\"line\">532530     金平县</span><br><span class=\"line\">532531     绿春县</span><br><span class=\"line\">532532     河口县</span><br><span class=\"line\">532600     文山州</span><br><span class=\"line\">532601     文山市</span><br><span class=\"line\">532622     砚山县</span><br><span class=\"line\">532623     西畴县</span><br><span class=\"line\">532624     麻栗坡县</span><br><span class=\"line\">532625     马关县</span><br><span class=\"line\">532626     丘北县</span><br><span class=\"line\">532627     广南县</span><br><span class=\"line\">532628     富宁县</span><br><span class=\"line\">532800     西双版纳州</span><br><span class=\"line\">532801     景洪市</span><br><span class=\"line\">532822     勐海县</span><br><span class=\"line\">532823     勐腊县</span><br><span class=\"line\">532900     大理州</span><br><span class=\"line\">532901     大理市</span><br><span class=\"line\">532922     漾濞县</span><br><span class=\"line\">532923     祥云县</span><br><span class=\"line\">532924     宾川县</span><br><span class=\"line\">532925     弥渡县</span><br><span class=\"line\">532926     南涧县</span><br><span class=\"line\">532927     巍山县</span><br><span class=\"line\">532928     永平县</span><br><span class=\"line\">532929     云龙县</span><br><span class=\"line\">532930     洱源县</span><br><span class=\"line\">532931     剑川县</span><br><span class=\"line\">532932     鹤庆县</span><br><span class=\"line\">533100     德宏州</span><br><span class=\"line\">533102     瑞丽市</span><br><span class=\"line\">533103     芒市</span><br><span class=\"line\">533122     梁河县</span><br><span class=\"line\">533123     盈江县</span><br><span class=\"line\">533124     陇川县</span><br><span class=\"line\">533300     怒江州</span><br><span class=\"line\">533321     泸水市</span><br><span class=\"line\">533323     福贡县</span><br><span class=\"line\">533324     贡山县</span><br><span class=\"line\">533325     兰坪县</span><br><span class=\"line\">533400     迪庆州</span><br><span class=\"line\">533421     香格里拉市</span><br><span class=\"line\">533422     德钦县</span><br><span class=\"line\">533423     维西傈僳族自治县</span><br><span class=\"line\">540000                 西藏</span><br><span class=\"line\">540100     拉萨市</span><br><span class=\"line\">540102     城关区</span><br><span class=\"line\">540103     堆龙德庆区</span><br><span class=\"line\">540104     达孜区</span><br><span class=\"line\">540121     林周县</span><br><span class=\"line\">540122     当雄县</span><br><span class=\"line\">540123     尼木县</span><br><span class=\"line\">540124     曲水县</span><br><span class=\"line\">540127     墨竹工卡县</span><br><span class=\"line\">540200     日喀则市</span><br><span class=\"line\">540202     桑珠孜区</span><br><span class=\"line\">540221     南木林县</span><br><span class=\"line\">540222     江孜县</span><br><span class=\"line\">540223     定日县</span><br><span class=\"line\">540224     萨迦县</span><br><span class=\"line\">540225     拉孜县</span><br><span class=\"line\">540226     昂仁县</span><br><span class=\"line\">540227     谢通门县</span><br><span class=\"line\">540228     白朗县</span><br><span class=\"line\">540229     仁布县</span><br><span class=\"line\">540230     康马县</span><br><span class=\"line\">540231     定结县</span><br><span class=\"line\">540232     仲巴县</span><br><span class=\"line\">540233     亚东县</span><br><span class=\"line\">540234     吉隆县</span><br><span class=\"line\">540235     聂拉木县</span><br><span class=\"line\">540236     萨嘎县</span><br><span class=\"line\">540237     岗巴县</span><br><span class=\"line\">540300     昌都市</span><br><span class=\"line\">540302     卡若区</span><br><span class=\"line\">540321     江达县</span><br><span class=\"line\">540322     贡觉县</span><br><span class=\"line\">540323     类乌齐县</span><br><span class=\"line\">540324     丁青县</span><br><span class=\"line\">540325     察雅县</span><br><span class=\"line\">540326     八宿县</span><br><span class=\"line\">540327     左贡县</span><br><span class=\"line\">540328     芒康县</span><br><span class=\"line\">540329     洛隆县</span><br><span class=\"line\">540330     边坝县</span><br><span class=\"line\">540400     林芝市</span><br><span class=\"line\">540402     巴宜区</span><br><span class=\"line\">540421     工布江达县</span><br><span class=\"line\">540422     米林县</span><br><span class=\"line\">540423     墨脱县</span><br><span class=\"line\">540424     波密县</span><br><span class=\"line\">540425     察隅县</span><br><span class=\"line\">540426     朗县</span><br><span class=\"line\">540500     山南市</span><br><span class=\"line\">540502     乃东区</span><br><span class=\"line\">540521     扎囊县</span><br><span class=\"line\">540522     贡嘎县</span><br><span class=\"line\">540523     桑日县</span><br><span class=\"line\">540524     琼结县</span><br><span class=\"line\">540525     曲松县</span><br><span class=\"line\">540526     措美县</span><br><span class=\"line\">540527     洛扎县</span><br><span class=\"line\">540528     加查县</span><br><span class=\"line\">540529     隆子县</span><br><span class=\"line\">540530     错那县</span><br><span class=\"line\">540531     浪卡子县</span><br><span class=\"line\">540600     那曲市</span><br><span class=\"line\">540602     色尼区</span><br><span class=\"line\">540621     嘉黎县</span><br><span class=\"line\">540622     比如县</span><br><span class=\"line\">540623     聂荣县</span><br><span class=\"line\">540624     安多县</span><br><span class=\"line\">540625     申扎县</span><br><span class=\"line\">540626     索县</span><br><span class=\"line\">540627     班戈县</span><br><span class=\"line\">540628     巴青县</span><br><span class=\"line\">540629     尼玛县</span><br><span class=\"line\">540630     双湖县</span><br><span class=\"line\">542500     阿里地区</span><br><span class=\"line\">542521     普兰县</span><br><span class=\"line\">542522     札达县</span><br><span class=\"line\">542523     噶尔县</span><br><span class=\"line\">542524     日土县</span><br><span class=\"line\">542525     革吉县</span><br><span class=\"line\">542526     改则县</span><br><span class=\"line\">542527     措勤县</span><br><span class=\"line\">610000                 陕西省</span><br><span class=\"line\">610100     西安市</span><br><span class=\"line\">610102     新城区</span><br><span class=\"line\">610103     碑林区</span><br><span class=\"line\">610104     莲湖区</span><br><span class=\"line\">610111     灞桥区</span><br><span class=\"line\">610112     未央区</span><br><span class=\"line\">610113     雁塔区</span><br><span class=\"line\">610114     阎良区</span><br><span class=\"line\">610115     临潼区</span><br><span class=\"line\">610116     长安区</span><br><span class=\"line\">610117     高陵区</span><br><span class=\"line\">610118     鄠邑区</span><br><span class=\"line\">610122     蓝田县</span><br><span class=\"line\">610124     周至县</span><br><span class=\"line\">610200     铜川市</span><br><span class=\"line\">610202     王益区</span><br><span class=\"line\">610203     印台区</span><br><span class=\"line\">610204     耀州区</span><br><span class=\"line\">610222     宜君县</span><br><span class=\"line\">610300     宝鸡市</span><br><span class=\"line\">610302     渭滨区</span><br><span class=\"line\">610303     金台区</span><br><span class=\"line\">610304     陈仓区</span><br><span class=\"line\">610322     凤翔县</span><br><span class=\"line\">610323     岐山县</span><br><span class=\"line\">610324     扶风县</span><br><span class=\"line\">610326     眉县</span><br><span class=\"line\">610327     陇县</span><br><span class=\"line\">610328     千阳县</span><br><span class=\"line\">610329     麟游县</span><br><span class=\"line\">610330     凤县</span><br><span class=\"line\">610331     太白县</span><br><span class=\"line\">610400     咸阳市</span><br><span class=\"line\">610402     秦都区</span><br><span class=\"line\">610403     杨陵区</span><br><span class=\"line\">610404     渭城区</span><br><span class=\"line\">610422     三原县</span><br><span class=\"line\">610423     泾阳县</span><br><span class=\"line\">610424     乾县</span><br><span class=\"line\">610425     礼泉县</span><br><span class=\"line\">610426     永寿县</span><br><span class=\"line\">610428     长武县</span><br><span class=\"line\">610429     旬邑县</span><br><span class=\"line\">610430     淳化县</span><br><span class=\"line\">610431     武功县</span><br><span class=\"line\">610481     兴平市</span><br><span class=\"line\">610482     彬州市</span><br><span class=\"line\">610500     渭南市</span><br><span class=\"line\">610502     临渭区</span><br><span class=\"line\">610522     潼关县</span><br><span class=\"line\">610523     大荔县</span><br><span class=\"line\">610523     华州区</span><br><span class=\"line\">610524     合阳县</span><br><span class=\"line\">610525     澄城县</span><br><span class=\"line\">610526     蒲城县</span><br><span class=\"line\">610527     白水县</span><br><span class=\"line\">610528     富平县</span><br><span class=\"line\">610581     韩城市</span><br><span class=\"line\">610582     华阴市</span><br><span class=\"line\">610600     延安市</span><br><span class=\"line\">610602     宝塔区</span><br><span class=\"line\">610603     安塞区</span><br><span class=\"line\">610621     延长县</span><br><span class=\"line\">610622     延川县</span><br><span class=\"line\">610623     子长市</span><br><span class=\"line\">610625     志丹县</span><br><span class=\"line\">610626     吴起县</span><br><span class=\"line\">610627     甘泉县</span><br><span class=\"line\">610628     富县</span><br><span class=\"line\">610629     洛川县</span><br><span class=\"line\">610630     宜川县</span><br><span class=\"line\">610631     黄龙县</span><br><span class=\"line\">610632     黄陵县</span><br><span class=\"line\">610700     汉中市</span><br><span class=\"line\">610702     汉台区</span><br><span class=\"line\">610703     南郑区</span><br><span class=\"line\">610722     城固县</span><br><span class=\"line\">610723     洋县</span><br><span class=\"line\">610724     西乡县</span><br><span class=\"line\">610725     勉县</span><br><span class=\"line\">610726     宁强县</span><br><span class=\"line\">610727     略阳县</span><br><span class=\"line\">610728     镇巴县</span><br><span class=\"line\">610729     留坝县</span><br><span class=\"line\">610730     佛坪县</span><br><span class=\"line\">610800     榆林市</span><br><span class=\"line\">610802     榆阳区</span><br><span class=\"line\">610803     横山区</span><br><span class=\"line\">610822     府谷县</span><br><span class=\"line\">610824     靖边县</span><br><span class=\"line\">610825     定边县</span><br><span class=\"line\">610826     绥德县</span><br><span class=\"line\">610827     米脂县</span><br><span class=\"line\">610828     佳县</span><br><span class=\"line\">610829     吴堡县</span><br><span class=\"line\">610830     清涧县</span><br><span class=\"line\">610831     子洲县</span><br><span class=\"line\">610881     神木市</span><br><span class=\"line\">610900     安康市</span><br><span class=\"line\">610902     汉滨区</span><br><span class=\"line\">610921     汉阴县</span><br><span class=\"line\">610922     石泉县</span><br><span class=\"line\">610923     宁陕县</span><br><span class=\"line\">610924     紫阳县</span><br><span class=\"line\">610925     岚皋县</span><br><span class=\"line\">610926     平利县</span><br><span class=\"line\">610927     镇坪县</span><br><span class=\"line\">610928     旬阳县</span><br><span class=\"line\">610929     白河县</span><br><span class=\"line\">611000     商洛市</span><br><span class=\"line\">611002     商州区</span><br><span class=\"line\">611021     洛南县</span><br><span class=\"line\">611022     丹凤县</span><br><span class=\"line\">611023     商南县</span><br><span class=\"line\">611024     山阳县</span><br><span class=\"line\">611025     镇安县</span><br><span class=\"line\">611026     柞水县</span><br><span class=\"line\">620000                 甘肃省</span><br><span class=\"line\">620100     兰州市</span><br><span class=\"line\">620102     城关区</span><br><span class=\"line\">620103     七里河区</span><br><span class=\"line\">620104     西固区</span><br><span class=\"line\">620105     安宁区</span><br><span class=\"line\">620111     红古区</span><br><span class=\"line\">620121     永登县</span><br><span class=\"line\">620122     皋兰县</span><br><span class=\"line\">620123     榆中县</span><br><span class=\"line\">620171     兰州新区</span><br><span class=\"line\">620200     嘉峪关市</span><br><span class=\"line\">620300     金昌市</span><br><span class=\"line\">620302     金川区</span><br><span class=\"line\">620321     永昌县</span><br><span class=\"line\">620400     白银市</span><br><span class=\"line\">620402     白银区</span><br><span class=\"line\">620403     平川区</span><br><span class=\"line\">620421     靖远县</span><br><span class=\"line\">620422     会宁县</span><br><span class=\"line\">620423     景泰县</span><br><span class=\"line\">620500     天水市</span><br><span class=\"line\">620502     秦州区</span><br><span class=\"line\">620503     麦积区</span><br><span class=\"line\">620521     清水县</span><br><span class=\"line\">620522     秦安县</span><br><span class=\"line\">620523     甘谷县</span><br><span class=\"line\">620524     武山县</span><br><span class=\"line\">620525     张家川回族自治县</span><br><span class=\"line\">620600     武威市</span><br><span class=\"line\">620602     凉州区</span><br><span class=\"line\">620621     民勤县</span><br><span class=\"line\">620622     古浪县</span><br><span class=\"line\">620623     天祝藏族自治县</span><br><span class=\"line\">620700     张掖市</span><br><span class=\"line\">620702     甘州区</span><br><span class=\"line\">620721     肃南县</span><br><span class=\"line\">620722     民乐县</span><br><span class=\"line\">620723     临泽县</span><br><span class=\"line\">620724     高台县</span><br><span class=\"line\">620725     山丹县</span><br><span class=\"line\">620800     平凉市</span><br><span class=\"line\">620802     崆峒区</span><br><span class=\"line\">620821     泾川县</span><br><span class=\"line\">620822     灵台县</span><br><span class=\"line\">620823     崇信县</span><br><span class=\"line\">620824     华亭市</span><br><span class=\"line\">620825     庄浪县</span><br><span class=\"line\">620826     静宁县</span><br><span class=\"line\">620900     酒泉市</span><br><span class=\"line\">620902     肃州区</span><br><span class=\"line\">620921     金塔县</span><br><span class=\"line\">620922     瓜州县</span><br><span class=\"line\">620923     肃北县</span><br><span class=\"line\">620924     阿克塞县</span><br><span class=\"line\">620981     玉门市</span><br><span class=\"line\">620982     敦煌市</span><br><span class=\"line\">621000     庆阳市</span><br><span class=\"line\">621002     西峰区</span><br><span class=\"line\">621021     庆城县</span><br><span class=\"line\">621022     环县</span><br><span class=\"line\">621023     华池县</span><br><span class=\"line\">621024     合水县</span><br><span class=\"line\">621025     正宁县</span><br><span class=\"line\">621026     宁县</span><br><span class=\"line\">621027     镇原县</span><br><span class=\"line\">621100     定西市</span><br><span class=\"line\">621102     安定区</span><br><span class=\"line\">621121     通渭县</span><br><span class=\"line\">621122     陇西县</span><br><span class=\"line\">621123     渭源县</span><br><span class=\"line\">621124     临洮县</span><br><span class=\"line\">621125     漳县</span><br><span class=\"line\">621126     岷县</span><br><span class=\"line\">621200     陇南市</span><br><span class=\"line\">621202     武都区</span><br><span class=\"line\">621221     成县</span><br><span class=\"line\">621222     文县</span><br><span class=\"line\">621223     宕昌县</span><br><span class=\"line\">621224     康县</span><br><span class=\"line\">621225     西和县</span><br><span class=\"line\">621226     礼县</span><br><span class=\"line\">621227     徽县</span><br><span class=\"line\">621228     两当县</span><br><span class=\"line\">622900     临夏州</span><br><span class=\"line\">622901     临夏市</span><br><span class=\"line\">622921     临夏县</span><br><span class=\"line\">622922     康乐县</span><br><span class=\"line\">622923     永靖县</span><br><span class=\"line\">622924     广河县</span><br><span class=\"line\">622925     和政县</span><br><span class=\"line\">622926     东乡族自治县</span><br><span class=\"line\">622927     积石山县</span><br><span class=\"line\">623000     甘南州</span><br><span class=\"line\">623001     合作市</span><br><span class=\"line\">623021     临潭县</span><br><span class=\"line\">623022     卓尼县</span><br><span class=\"line\">623023     舟曲县</span><br><span class=\"line\">623024     迭部县</span><br><span class=\"line\">623025     玛曲县</span><br><span class=\"line\">623026     碌曲县</span><br><span class=\"line\">623027     夏河县</span><br><span class=\"line\">630000                 青海省</span><br><span class=\"line\">630100     西宁市</span><br><span class=\"line\">630102     城东区</span><br><span class=\"line\">630103     城中区</span><br><span class=\"line\">630104     城西区</span><br><span class=\"line\">630105     城北区</span><br><span class=\"line\">630121     大通县</span><br><span class=\"line\">630122     湟中县</span><br><span class=\"line\">630123     湟源县</span><br><span class=\"line\">632001     乐都区</span><br><span class=\"line\">632100     海东市</span><br><span class=\"line\">632121     平安区</span><br><span class=\"line\">632122     民和县</span><br><span class=\"line\">632126     互助县</span><br><span class=\"line\">632127     化隆回族自治县</span><br><span class=\"line\">632128     循化撒拉族自治县</span><br><span class=\"line\">632200     海北州</span><br><span class=\"line\">632221     门源回族自治县</span><br><span class=\"line\">632222     祁连县</span><br><span class=\"line\">632223     海晏县</span><br><span class=\"line\">632224     刚察县</span><br><span class=\"line\">632300     黄南州</span><br><span class=\"line\">632321     同仁县</span><br><span class=\"line\">632322     尖扎县</span><br><span class=\"line\">632323     泽库县</span><br><span class=\"line\">632324     河南蒙古族自治县</span><br><span class=\"line\">632500     海南州</span><br><span class=\"line\">632521     共和县</span><br><span class=\"line\">632522     同德县</span><br><span class=\"line\">632523     贵德县</span><br><span class=\"line\">632524     兴海县</span><br><span class=\"line\">632525     贵南县</span><br><span class=\"line\">632600     果洛州</span><br><span class=\"line\">632621     玛沁县</span><br><span class=\"line\">632622     班玛县</span><br><span class=\"line\">632623     甘德县</span><br><span class=\"line\">632624     达日县</span><br><span class=\"line\">632625     久治县</span><br><span class=\"line\">632626     玛多县</span><br><span class=\"line\">632700     玉树州</span><br><span class=\"line\">632701     玉树市</span><br><span class=\"line\">632722     杂多县</span><br><span class=\"line\">632723     称多县</span><br><span class=\"line\">632724     治多县</span><br><span class=\"line\">632725     囊谦县</span><br><span class=\"line\">632726     曲麻莱县</span><br><span class=\"line\">632800     海西州</span><br><span class=\"line\">632801     格尔木市</span><br><span class=\"line\">632802     德令哈市</span><br><span class=\"line\">632821     乌兰县</span><br><span class=\"line\">632822     都兰县</span><br><span class=\"line\">632823     天峻县</span><br><span class=\"line\">632824     冷湖行委</span><br><span class=\"line\">632825     大柴旦行委</span><br><span class=\"line\">632826     茫崖行委</span><br><span class=\"line\">640000                 宁夏</span><br><span class=\"line\">640100     银川市</span><br><span class=\"line\">640104     兴庆区</span><br><span class=\"line\">640105     西夏区</span><br><span class=\"line\">640106     金凤区</span><br><span class=\"line\">640121     永宁县</span><br><span class=\"line\">640122     贺兰县</span><br><span class=\"line\">640181     灵武市</span><br><span class=\"line\">640200     石嘴山市</span><br><span class=\"line\">640202     大武口区</span><br><span class=\"line\">640205     惠农区</span><br><span class=\"line\">640221     平罗县</span><br><span class=\"line\">640300     吴忠市</span><br><span class=\"line\">640302     利通区</span><br><span class=\"line\">640303     红寺堡区</span><br><span class=\"line\">640323     盐池县</span><br><span class=\"line\">640324     同心县</span><br><span class=\"line\">640381     青铜峡市</span><br><span class=\"line\">640400     固原市</span><br><span class=\"line\">640402     原州区</span><br><span class=\"line\">640422     西吉县</span><br><span class=\"line\">640423     隆德县</span><br><span class=\"line\">640424     泾源县</span><br><span class=\"line\">640425     彭阳县</span><br><span class=\"line\">640500     中卫市</span><br><span class=\"line\">640502     沙坡头区</span><br><span class=\"line\">640521     中宁县</span><br><span class=\"line\">640522     海原县</span><br></pre></td></tr></table></figure>\r\n<p>读取这个文件，将每个省里所有的编号存放于一个 <code>vector</code> 中，方便后续查询。具体代码如下。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\">std::fstream fin;</span><br><span class=\"line\"><span class=\"function\">std::string <span class=\"title\">file_name</span><span class=\"params\">(id.txt)</span></span>;</span><br><span class=\"line\">fin.<span class=\"built_in\">open</span>(file_name, std::ios::in);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (!fin.<span class=\"built_in\">is_open</span>()) &#123;</span><br><span class=\"line\">  std::cerr &lt;&lt; <span class=\"string\">&quot;ERROR occured: id.txt opened failed!!!&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">std::cout &lt;&lt; <span class=\"string\">&quot;id.txt opened succeed...&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">std::string name;</span><br><span class=\"line\">std::string id;</span><br><span class=\"line\"><span class=\"comment\">// std::string cities[50][200];</span></span><br><span class=\"line\">std::vector&lt;std::vector&lt;std::string&gt;&gt; cities;</span><br><span class=\"line\">std::vector&lt;std::string&gt; prov;</span><br><span class=\"line\">std::vector&lt;std::string&gt; province_name;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">while</span> (!fin.<span class=\"built_in\">eof</span>()) &#123;</span><br><span class=\"line\">  fin &gt;&gt; id &gt;&gt; name;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (id[<span class=\"number\">2</span>] == id[<span class=\"number\">3</span>] &amp;&amp; id[<span class=\"number\">3</span>] == id[<span class=\"number\">4</span>] &amp;&amp; id[<span class=\"number\">4</span>] == id[<span class=\"number\">5</span>] &amp;&amp; id[<span class=\"number\">2</span>] == <span class=\"string\">&#x27;0&#x27;</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (prov.<span class=\"built_in\">size</span>()) &#123;</span><br><span class=\"line\">      cities.<span class=\"built_in\">emplace_back</span>(prov);</span><br><span class=\"line\">      prov.<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    province_name.<span class=\"built_in\">emplace_back</span>(name);</span><br><span class=\"line\">    <span class=\"comment\">// std::cout &lt;&lt; &quot;name: &quot; &lt;&lt; name &lt;&lt; &quot;, id: &quot; &lt;&lt; id &lt;&lt; std::endl;</span></span><br><span class=\"line\">    <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  prov.<span class=\"built_in\">emplace_back</span>(id);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">cities.<span class=\"built_in\">emplace_back</span>(prov);</span><br><span class=\"line\"></span><br><span class=\"line\">fin.<span class=\"built_in\">close</span>();</span><br><span class=\"line\">std::cout &lt;&lt; <span class=\"string\">&quot;id.txt closed...&quot;</span> &lt;&lt; std::endl;</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"生日确定\">生日确定</h1>\r\n<p>这个比较简单，就是随机生成出生日期然后转为字符串就行了。我这里是随机生成年龄大小，因为我希望生成的身份证号属于 <code>18 - 35</code> 岁的人。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ...</span></span><br><span class=\"line\"><span class=\"comment\">// ret 已包含前6位</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> age_year = <span class=\"number\">2021</span> - (<span class=\"number\">18</span> + <span class=\"built_in\">rand</span>() % <span class=\"number\">18</span>);</span><br><span class=\"line\"><span class=\"keyword\">int</span> age_month = <span class=\"number\">1</span> + <span class=\"built_in\">rand</span>() % <span class=\"number\">12</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> age_day = <span class=\"number\">1</span> + <span class=\"built_in\">rand</span>() % <span class=\"number\">28</span>;</span><br><span class=\"line\">ret += std::<span class=\"built_in\">to_string</span>(age_year);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (age_month &lt; <span class=\"number\">10</span>) &#123;</span><br><span class=\"line\">  ret += <span class=\"string\">&quot;0&quot;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ret += std::<span class=\"built_in\">to_string</span>(age_month);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (age_day &lt; <span class=\"number\">10</span>) &#123;</span><br><span class=\"line\">  ret += <span class=\"string\">&quot;0&quot;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ret += std::<span class=\"built_in\">to_string</span>(age_day);</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"剩下的随机数\">剩下的随机数</h1>\r\n<p>直接生成就行了。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> rnd = <span class=\"built_in\">rand</span>() % <span class=\"number\">1000</span>;</span><br><span class=\"line\">std::string rnd_str = std::<span class=\"built_in\">to_string</span>(rnd);</span><br><span class=\"line\"><span class=\"keyword\">int</span> zero_cnt = <span class=\"number\">3</span> - rnd_str.<span class=\"built_in\">size</span>();</span><br><span class=\"line\"><span class=\"keyword\">while</span> (zero_cnt--) &#123;</span><br><span class=\"line\">  ret += <span class=\"string\">&quot;0&quot;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ret += rnd_str;</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"计算校验码\">计算校验码</h1>\r\n<p>身份证的前<code>17</code> 位数的权值分别为：</p>\r\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">7, 9, 10, 5, 8,</span><br><span class=\"line\">4, 2, 1 , 6, 3,</span><br><span class=\"line\">7, 9, 10, 5, 8,</span><br><span class=\"line\">4, 2</span><br></pre></td></tr></table></figure>\r\n<p>计算加权后对 <code>11</code> 取模，模的结果为 <code>0 - 10</code> 分别对应最后一位为：</p>\r\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#x27;1&#x27;, &#x27;0&#x27;, &#x27;X&#x27;, &#x27;9&#x27;, &#x27;8&#x27;,</span><br><span class=\"line\">&#x27;7&#x27;, &#x27;6&#x27;, &#x27;5&#x27;, &#x27;4&#x27;, &#x27;3&#x27;,</span><br><span class=\"line\">&#x27;2&#x27;</span><br></pre></td></tr></table></figure>\r\n<p>代码：</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">char</span> check[] = &#123;</span><br><span class=\"line\">  <span class=\"string\">&#x27;1&#x27;</span>, <span class=\"string\">&#x27;0&#x27;</span>, <span class=\"string\">&#x27;X&#x27;</span>, <span class=\"string\">&#x27;9&#x27;</span>, <span class=\"string\">&#x27;8&#x27;</span>,</span><br><span class=\"line\">  <span class=\"string\">&#x27;7&#x27;</span>, <span class=\"string\">&#x27;6&#x27;</span>, <span class=\"string\">&#x27;5&#x27;</span>, <span class=\"string\">&#x27;4&#x27;</span>, <span class=\"string\">&#x27;3&#x27;</span>,</span><br><span class=\"line\">  <span class=\"string\">&#x27;2&#x27;</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> weight[] = &#123;</span><br><span class=\"line\">  <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>, <span class=\"number\">5</span>, <span class=\"number\">8</span>,</span><br><span class=\"line\">  <span class=\"number\">4</span>, <span class=\"number\">2</span>, <span class=\"number\">1</span> , <span class=\"number\">6</span>, <span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>, <span class=\"number\">5</span>, <span class=\"number\">8</span>,</span><br><span class=\"line\">  <span class=\"number\">4</span>, <span class=\"number\">2</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">char</span> <span class=\"title\">GetCheckCode</span><span class=\"params\">(<span class=\"keyword\">const</span> std::string&amp; id)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> total = <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">17</span>; ++i) &#123;</span><br><span class=\"line\">    total += weight[i] * (id[i] - <span class=\"string\">&#x27;0&#x27;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> check[total % <span class=\"number\">11</span>];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"生成更随机的随机数\">生成更随机的随机数</h1>\r\n<p>因为 <code>rand()</code> 在相同的情况下多次运行结果是完全一样的，而 <code>srand(seed)</code> 在 <code>seed</code> 不同时 <code>rand()</code> 的结果也不同，因此可以设置一个 <code>seed</code> 以使得 <code>rand()</code> 输出不同的结果。</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\">std::cout &lt;&lt; <span class=\"string\">&quot;For generate more random IDs, please input a seed first: &quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">unsigned</span> <span class=\"keyword\">int</span> seed;</span><br><span class=\"line\">std::cin &gt;&gt; seed;</span><br><span class=\"line\"><span class=\"built_in\">srand</span>(seed);</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"全部代码\">全部代码</h1>\r\n<p>在上述基础上添加一些异常处理的代码和更智能化生成 <code>ID</code> 的代码后，全部代码如下：</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/********************************************************************************</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * @author: Cao Xingyu</span></span><br><span class=\"line\"><span class=\"comment\"> * @date: 2022-03-11 20:23:04</span></span><br><span class=\"line\"><span class=\"comment\"> * @description: Generage legal ID</span></span><br><span class=\"line\"><span class=\"comment\"> * @version: 1.0</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> ********************************************************************************/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&quot;header.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">char</span> check[] = &#123;</span><br><span class=\"line\">  <span class=\"string\">&#x27;1&#x27;</span>, <span class=\"string\">&#x27;0&#x27;</span>, <span class=\"string\">&#x27;X&#x27;</span>, <span class=\"string\">&#x27;9&#x27;</span>, <span class=\"string\">&#x27;8&#x27;</span>,</span><br><span class=\"line\">  <span class=\"string\">&#x27;7&#x27;</span>, <span class=\"string\">&#x27;6&#x27;</span>, <span class=\"string\">&#x27;5&#x27;</span>, <span class=\"string\">&#x27;4&#x27;</span>, <span class=\"string\">&#x27;3&#x27;</span>,</span><br><span class=\"line\">  <span class=\"string\">&#x27;2&#x27;</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> weight[] = &#123;</span><br><span class=\"line\">  <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>, <span class=\"number\">5</span>, <span class=\"number\">8</span>,</span><br><span class=\"line\">  <span class=\"number\">4</span>, <span class=\"number\">2</span>, <span class=\"number\">1</span> , <span class=\"number\">6</span>, <span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>, <span class=\"number\">5</span>, <span class=\"number\">8</span>,</span><br><span class=\"line\">  <span class=\"number\">4</span>, <span class=\"number\">2</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">char</span> <span class=\"title\">GetCheckCode</span><span class=\"params\">(<span class=\"keyword\">const</span> std::string&amp; id)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> total = <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">17</span>; ++i) &#123;</span><br><span class=\"line\">    total += weight[i] * (id[i] - <span class=\"string\">&#x27;0&#x27;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> check[total % <span class=\"number\">11</span>];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;For generate more random IDs, please input a seed first: &quot;</span>;</span><br><span class=\"line\">  <span class=\"keyword\">unsigned</span> <span class=\"keyword\">int</span> seed;</span><br><span class=\"line\">  std::cin &gt;&gt; seed;</span><br><span class=\"line\">  <span class=\"built_in\">srand</span>(seed);</span><br><span class=\"line\">  std::fstream fin;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;1. Test; 2. Generate&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> choose;</span><br><span class=\"line\">  std::string file_name;</span><br><span class=\"line\">  <span class=\"keyword\">while</span> (<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;choose);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (choose == <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">      file_name = <span class=\"string\">&quot;id.txt&quot;</span>;</span><br><span class=\"line\">      <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (choose == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">      file_name = <span class=\"string\">&quot;id_for_print.txt&quot;</span>;</span><br><span class=\"line\">      <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      std::cout &lt;&lt; <span class=\"string\">&quot;Input error. Please try again.&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  fin.<span class=\"built_in\">open</span>(file_name, std::ios::in);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!fin.<span class=\"built_in\">is_open</span>()) &#123;</span><br><span class=\"line\">    std::cerr &lt;&lt; <span class=\"string\">&quot;ERROR occured: id.txt opened failed!!!&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;id.txt opened succeed...&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">  std::string name;</span><br><span class=\"line\">  std::string id;</span><br><span class=\"line\">  <span class=\"comment\">// std::string cities[50][200];</span></span><br><span class=\"line\">  std::vector&lt;std::vector&lt;std::string&gt;&gt; cities;</span><br><span class=\"line\">  std::vector&lt;std::string&gt; prov;</span><br><span class=\"line\"></span><br><span class=\"line\">  std::vector&lt;std::string&gt; province_name;</span><br><span class=\"line\">  <span class=\"keyword\">while</span> (!fin.<span class=\"built_in\">eof</span>()) &#123;</span><br><span class=\"line\">    fin &gt;&gt; id &gt;&gt; name;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (id[<span class=\"number\">2</span>] == id[<span class=\"number\">3</span>] &amp;&amp; id[<span class=\"number\">3</span>] == id[<span class=\"number\">4</span>] &amp;&amp; id[<span class=\"number\">4</span>] == id[<span class=\"number\">5</span>] &amp;&amp; id[<span class=\"number\">2</span>] == <span class=\"string\">&#x27;0&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (prov.<span class=\"built_in\">size</span>()) &#123;</span><br><span class=\"line\">        cities.<span class=\"built_in\">emplace_back</span>(prov);</span><br><span class=\"line\">        prov.<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      province_name.<span class=\"built_in\">emplace_back</span>(name);</span><br><span class=\"line\">      <span class=\"comment\">// std::cout &lt;&lt; &quot;name: &quot; &lt;&lt; name &lt;&lt; &quot;, id: &quot; &lt;&lt; id &lt;&lt; std::endl;</span></span><br><span class=\"line\">      <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    prov.<span class=\"built_in\">emplace_back</span>(id);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  cities.<span class=\"built_in\">emplace_back</span>(prov);</span><br><span class=\"line\"></span><br><span class=\"line\">  fin.<span class=\"built_in\">close</span>();</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;id.txt closed...&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">  <span class=\"comment\">// for (auto&amp; cs : cities) &#123;</span></span><br><span class=\"line\">  <span class=\"comment\">//   for (std::string&amp; ids : cs) &#123;</span></span><br><span class=\"line\">  <span class=\"comment\">//     std::cout &lt;&lt; ids &lt;&lt; &#x27; &#x27;;</span></span><br><span class=\"line\">  <span class=\"comment\">//   &#125;</span></span><br><span class=\"line\">  <span class=\"comment\">//   std::cout &lt;&lt; std::endl;</span></span><br><span class=\"line\">  <span class=\"comment\">// &#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">int</span> loops;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;How many IDs do you want to generate?\\n&quot;</span>;</span><br><span class=\"line\">  std::cin &gt;&gt; loops;</span><br><span class=\"line\"></span><br><span class=\"line\">  fin.<span class=\"built_in\">open</span>(<span class=\"string\">&quot;out.txt&quot;</span>, std::ios_base::out);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!fin.<span class=\"built_in\">is_open</span>()) &#123;</span><br><span class=\"line\">    std::cerr &lt;&lt; <span class=\"string\">&quot;open file error!&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (loops &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    std::cerr &lt;&lt; <span class=\"string\">&quot;ERROR occured: ID count error! (constraint: count &gt; 0)&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">int</span> overwrite;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (choose == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    std::cout &lt;&lt; <span class=\"string\">&quot;Do you want to overwrite out.txt now? 0 for no and others for yes.&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">    std::cout &lt;&lt; <span class=\"string\">&quot;Your choose(suggestion: 0): &quot;</span>;</span><br><span class=\"line\">    std::cin &gt;&gt; overwrite;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    overwrite = <span class=\"number\">1</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">int</span> print_;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (choose == <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">    std::cout &lt;&lt; <span class=\"string\">&quot;Do you want to print all the result right now? 0 for no and others for yes.&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">    std::cout &lt;&lt; <span class=\"string\">&quot;WARNING: The text may be garbled and the process will be shut down!!!&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">    std::cout &lt;&lt; <span class=\"string\">&quot;Your choose(Suggestion: 0): &quot;</span>;</span><br><span class=\"line\">    std::cin &gt;&gt; print_;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    print_ = <span class=\"number\">1</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">int</span> cnt = <span class=\"number\">1</span>;</span><br><span class=\"line\">  <span class=\"keyword\">while</span> (loops--) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> maxCnt_prov = cities.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"keyword\">int</span> idx_outer = <span class=\"built_in\">rand</span>() % maxCnt_prov;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> maxCnt_city = cities[idx_outer].<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"keyword\">int</span> idx_inner = <span class=\"built_in\">rand</span>() % maxCnt_city;</span><br><span class=\"line\">    std::string ret = cities[idx_outer][idx_inner];</span><br><span class=\"line\">    <span class=\"keyword\">int</span> age_year = <span class=\"number\">2021</span> - (<span class=\"number\">18</span> + <span class=\"built_in\">rand</span>() % <span class=\"number\">18</span>);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> age_month = <span class=\"number\">1</span> + <span class=\"built_in\">rand</span>() % <span class=\"number\">12</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> age_day = <span class=\"number\">1</span> + <span class=\"built_in\">rand</span>() % <span class=\"number\">28</span>;</span><br><span class=\"line\">    ret += std::<span class=\"built_in\">to_string</span>(age_year);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (age_month &lt; <span class=\"number\">10</span>) &#123;</span><br><span class=\"line\">      ret += <span class=\"string\">&quot;0&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ret += std::<span class=\"built_in\">to_string</span>(age_month);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (age_day &lt; <span class=\"number\">10</span>) &#123;</span><br><span class=\"line\">      ret += <span class=\"string\">&quot;0&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ret += std::<span class=\"built_in\">to_string</span>(age_day);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> rnd = <span class=\"built_in\">rand</span>() % <span class=\"number\">1000</span>;</span><br><span class=\"line\">    std::string rnd_str = std::<span class=\"built_in\">to_string</span>(rnd);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> zero_cnt = <span class=\"number\">3</span> - rnd_str.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (zero_cnt--) &#123;</span><br><span class=\"line\">      ret += <span class=\"string\">&quot;0&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ret += rnd_str;</span><br><span class=\"line\">    <span class=\"comment\">// if (ret.size() != 17) &#123;</span></span><br><span class=\"line\">    <span class=\"comment\">//   std::cerr &lt;&lt; ret.size() &lt;&lt; &#x27; &#x27; &lt;&lt; ret &lt;&lt; std::endl;</span></span><br><span class=\"line\">    <span class=\"comment\">//   return 0;</span></span><br><span class=\"line\">    <span class=\"comment\">// &#125;</span></span><br><span class=\"line\">    ret.<span class=\"built_in\">push_back</span>(<span class=\"built_in\">GetCheckCode</span>(ret));</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (overwrite) &#123;</span><br><span class=\"line\">      fin &lt;&lt; cnt++ &lt;&lt; <span class=\"string\">&quot;: &quot;</span> &lt;&lt; ret &lt;&lt; <span class=\"string\">&quot;(&quot;</span> &lt;&lt; province_name[idx_outer] &lt;&lt; <span class=\"string\">&quot;)&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// std::cout &lt;&lt; cnt++ &lt;&lt; &quot;: &quot; &lt;&lt; ret &lt;&lt; &quot;(&quot; &lt;&lt; province_name[idx_outer] &lt;&lt; &quot;)&quot; &lt;&lt; std::endl;</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (print_) &#123;</span><br><span class=\"line\">      std::cout &lt;&lt; cnt++ &lt;&lt; <span class=\"string\">&quot;: &quot;</span> &lt;&lt; ret &lt;&lt; <span class=\"string\">&quot;(&quot;</span> &lt;&lt; province_name[idx_outer] &lt;&lt; <span class=\"string\">&quot;)&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  fin.<span class=\"built_in\">close</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p><code>id.txt</code> 和 <code>id_for_frint.txt</code> 的区别就是把省级行政区的名称用英文表示，以防输出乱码。</p>\r\n<p>整理后代码如下：</p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/********************************************************************************</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * @author: Cao Xingyu</span></span><br><span class=\"line\"><span class=\"comment\"> * @date: 2022-03-12 11:12:34</span></span><br><span class=\"line\"><span class=\"comment\"> * @description: Generage legal ID</span></span><br><span class=\"line\"><span class=\"comment\"> * @version: 1.0</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> ********************************************************************************/</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&quot;header.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">char</span> check[] = &#123;</span><br><span class=\"line\">  <span class=\"string\">&#x27;1&#x27;</span>, <span class=\"string\">&#x27;0&#x27;</span>, <span class=\"string\">&#x27;X&#x27;</span>, <span class=\"string\">&#x27;9&#x27;</span>, <span class=\"string\">&#x27;8&#x27;</span>,</span><br><span class=\"line\">  <span class=\"string\">&#x27;7&#x27;</span>, <span class=\"string\">&#x27;6&#x27;</span>, <span class=\"string\">&#x27;5&#x27;</span>, <span class=\"string\">&#x27;4&#x27;</span>, <span class=\"string\">&#x27;3&#x27;</span>,</span><br><span class=\"line\">  <span class=\"string\">&#x27;2&#x27;</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> weight[] = &#123;</span><br><span class=\"line\">  <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>, <span class=\"number\">5</span>, <span class=\"number\">8</span>,</span><br><span class=\"line\">  <span class=\"number\">4</span>, <span class=\"number\">2</span>, <span class=\"number\">1</span> , <span class=\"number\">6</span>, <span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>, <span class=\"number\">5</span>, <span class=\"number\">8</span>,</span><br><span class=\"line\">  <span class=\"number\">4</span>, <span class=\"number\">2</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">std::vector&lt;std::vector&lt;std::string&gt;&gt; cities;</span><br><span class=\"line\">std::vector&lt;std::string&gt; prov;</span><br><span class=\"line\">std::vector&lt;std::string&gt; province_name;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">bool</span> is_init = <span class=\"literal\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">usage</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;argument input error!!!&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;Usage: ./bash_version &lt;seed&gt; &lt;ID_file&gt; &lt;choose_to_print&gt; &lt;choose_to_write&gt; [gen_count]\\n&quot;</span>;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;       seed:            to generate random IDs;\\n&quot;</span>;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;       choose_to_print: 0 for not print and others for print;\\n&quot;</span>;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;       choose_to_write: 0 for not write and others for write.\\n&quot;</span>;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;       gen_count:       How many IDs to generate, if not given, it will be 1(default).\\n&quot;</span>;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;WARNING: If choose_to_print is opened, The text may be garbled and the process will be shut down!!!&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;         If there are Chinese words in ID_file, choose_to_print is suggested to be 0.&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">initTable</span><span class=\"params\">(std::fstream&amp; fin)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (is_init) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  std::string name;</span><br><span class=\"line\">  std::string id;</span><br><span class=\"line\">  <span class=\"keyword\">while</span> (!fin.<span class=\"built_in\">eof</span>()) &#123;</span><br><span class=\"line\">    fin &gt;&gt; id &gt;&gt; name;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (id[<span class=\"number\">2</span>] == id[<span class=\"number\">3</span>] &amp;&amp; id[<span class=\"number\">3</span>] == id[<span class=\"number\">4</span>] &amp;&amp; id[<span class=\"number\">4</span>] == id[<span class=\"number\">5</span>] &amp;&amp; id[<span class=\"number\">2</span>] == <span class=\"string\">&#x27;0&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (prov.<span class=\"built_in\">size</span>()) &#123;</span><br><span class=\"line\">        cities.<span class=\"built_in\">emplace_back</span>(prov);</span><br><span class=\"line\">        prov.<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      province_name.<span class=\"built_in\">emplace_back</span>(name);</span><br><span class=\"line\">      <span class=\"comment\">// std::cout &lt;&lt; &quot;name: &quot; &lt;&lt; name &lt;&lt; &quot;, id: &quot; &lt;&lt; id &lt;&lt; std::endl;</span></span><br><span class=\"line\">      <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    prov.<span class=\"built_in\">emplace_back</span>(id);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  cities.<span class=\"built_in\">emplace_back</span>(prov);</span><br><span class=\"line\">  is_init = <span class=\"literal\">true</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">printTable</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span>&amp; cit : cities) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> i = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (std::string&amp; c : cit) &#123;</span><br><span class=\"line\">      std::cout &lt;&lt; c &lt;&lt; <span class=\"string\">&#x27; &#x27;</span>;</span><br><span class=\"line\">      ++i;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (i % <span class=\"number\">5</span> == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        std::cout &lt;&lt; std::endl;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  std::cout &lt;&lt; std::endl;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">INFO</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>** argv)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">// ./bash_version &lt;seed&gt; &lt;ID_file&gt; &lt;choose_to_print&gt; &lt;choose_to_write&gt; [gen_count]</span></span><br><span class=\"line\">  std::string exe = argv[<span class=\"number\">0</span>];</span><br><span class=\"line\">  <span class=\"keyword\">unsigned</span> seed = <span class=\"built_in\">atoi</span>(argv[<span class=\"number\">1</span>]);</span><br><span class=\"line\">  std::string file = argv[<span class=\"number\">2</span>];</span><br><span class=\"line\">  <span class=\"keyword\">int</span> print_ = <span class=\"built_in\">atoi</span>(argv[<span class=\"number\">3</span>]);</span><br><span class=\"line\">  <span class=\"keyword\">int</span> write_ = <span class=\"built_in\">atoi</span>(argv[<span class=\"number\">4</span>]);</span><br><span class=\"line\">  <span class=\"keyword\">int</span> cnt = argc == <span class=\"number\">5</span> ? <span class=\"number\">1</span> : <span class=\"built_in\">atoi</span>(argv[<span class=\"number\">5</span>]);</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;\\n\\n*****************************************************************************\\n&quot;</span>;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;** INFO: .exe file is       : &quot;</span> &lt;&lt; exe &lt;&lt; std::endl;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;** INFO: seed is            : &quot;</span> &lt;&lt; seed &lt;&lt; std::endl;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;** INFO: id file is         : &quot;</span> &lt;&lt; file &lt;&lt; std::endl;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;** INFO: print/write or not : &quot;</span> &lt;&lt; (print_ ? <span class=\"string\">&quot;To print&quot;</span> : <span class=\"string\">&quot;Not to print&quot;</span>)</span><br><span class=\"line\">            &lt;&lt; <span class=\"string\">&quot;; &quot;</span></span><br><span class=\"line\">            &lt;&lt; (write_ ? <span class=\"string\">&quot;To write&quot;</span> : <span class=\"string\">&quot;Not to write&quot;</span>) &lt;&lt; std::endl;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;** INFO: The process will generate &quot;</span> &lt;&lt; cnt &lt;&lt; <span class=\"string\">&quot; ID(s). The output file is bash_out.txt.&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;*****************************************************************************\\n\\n&quot;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">char</span> <span class=\"title\">GetCheckCode</span><span class=\"params\">(<span class=\"keyword\">const</span> std::string &amp;id)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> total = <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">17</span>; ++i)</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    total += weight[i] * (id[i] - <span class=\"string\">&#x27;0&#x27;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> check[total % <span class=\"number\">11</span>];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">std::string <span class=\"title\">generate_id</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> maxCnt_prov = cities.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">  <span class=\"keyword\">int</span> idx_outer = <span class=\"built_in\">rand</span>() % maxCnt_prov;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> maxCnt_city = cities[idx_outer].<span class=\"built_in\">size</span>();</span><br><span class=\"line\">  <span class=\"keyword\">int</span> idx_inner = <span class=\"built_in\">rand</span>() % maxCnt_city;</span><br><span class=\"line\">  std::string ret = cities[idx_outer][idx_inner];</span><br><span class=\"line\">  <span class=\"keyword\">int</span> age_year = <span class=\"number\">2021</span> - (<span class=\"number\">18</span> + <span class=\"built_in\">rand</span>() % <span class=\"number\">18</span>);</span><br><span class=\"line\">  <span class=\"keyword\">int</span> age_month = <span class=\"number\">1</span> + <span class=\"built_in\">rand</span>() % <span class=\"number\">12</span>;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> age_day = <span class=\"number\">1</span> + <span class=\"built_in\">rand</span>() % <span class=\"number\">28</span>;</span><br><span class=\"line\">  ret += std::<span class=\"built_in\">to_string</span>(age_year);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (age_month &lt; <span class=\"number\">10</span>) &#123;</span><br><span class=\"line\">    ret += <span class=\"string\">&quot;0&quot;</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  ret += std::<span class=\"built_in\">to_string</span>(age_month);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (age_day &lt; <span class=\"number\">10</span>) &#123;</span><br><span class=\"line\">    ret += <span class=\"string\">&quot;0&quot;</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  ret += std::<span class=\"built_in\">to_string</span>(age_day);</span><br><span class=\"line\">  <span class=\"keyword\">int</span> rnd = <span class=\"built_in\">rand</span>() % <span class=\"number\">1000</span>;</span><br><span class=\"line\">  std::string rnd_str = std::<span class=\"built_in\">to_string</span>(rnd);</span><br><span class=\"line\">  <span class=\"keyword\">int</span> zero_cnt = <span class=\"number\">3</span> - rnd_str.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">  <span class=\"keyword\">while</span> (zero_cnt--) &#123;</span><br><span class=\"line\">    ret += <span class=\"string\">&quot;0&quot;</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  ret += rnd_str;</span><br><span class=\"line\">  ret.<span class=\"built_in\">push_back</span>(<span class=\"built_in\">GetCheckCode</span>(ret));</span><br><span class=\"line\"></span><br><span class=\"line\">  ret += <span class=\"string\">&quot;(&quot;</span> + province_name[idx_outer] + <span class=\"string\">&quot;)&quot;</span>;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> ret;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">generateIDs</span><span class=\"params\">(std::fstream&amp; fin, <span class=\"keyword\">int</span> print_, <span class=\"keyword\">int</span> overwrite, <span class=\"keyword\">int</span> loops)</span> </span>&#123;</span><br><span class=\"line\">  fin.<span class=\"built_in\">open</span>(<span class=\"string\">&quot;bash_out.txt&quot;</span>, std::ios::out);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!fin.<span class=\"built_in\">is_open</span>()) &#123;</span><br><span class=\"line\">    std::cerr &lt;&lt; <span class=\"string\">&quot;open file error!&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;bash_out.txt opened succeed...&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (loops &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    std::cerr &lt;&lt; <span class=\"string\">&quot;ERROR occured: ID count error! (constraint: count &gt; 0)&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">int</span> cnt = <span class=\"number\">1</span>;</span><br><span class=\"line\">  <span class=\"keyword\">while</span> (loops--) &#123;</span><br><span class=\"line\">    std::string ret = <span class=\"built_in\">generate_id</span>();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (overwrite) &#123;</span><br><span class=\"line\">      fin &lt;&lt; cnt++ &lt;&lt; <span class=\"string\">&quot;: &quot;</span> &lt;&lt; ret <span class=\"comment\">/* &lt;&lt; &quot;(&quot; &lt;&lt; province_name[idx_outer] &lt;&lt; &quot;)&quot; */</span> &lt;&lt; std::endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// std::cout &lt;&lt; cnt++ &lt;&lt; &quot;: &quot; &lt;&lt; ret &lt;&lt; &quot;(&quot; &lt;&lt; province_name[idx_outer] &lt;&lt; &quot;)&quot; &lt;&lt; std::endl;</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (print_) &#123;</span><br><span class=\"line\">      std::cout &lt;&lt; cnt++ &lt;&lt; <span class=\"string\">&quot;: &quot;</span> &lt;&lt; ret <span class=\"comment\">/* &lt;&lt; &quot;(&quot; &lt;&lt; province_name[idx_outer] &lt;&lt; &quot;)&quot; */</span> &lt;&lt; std::endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  fin.<span class=\"built_in\">close</span>();</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;bash_out.txt closed...&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>** argv)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (argc != <span class=\"number\">5</span> &amp;&amp; argc != <span class=\"number\">6</span>) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">usage</span>();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">time_t</span> <span class=\"keyword\">begin_t</span> = <span class=\"built_in\">clock</span>();</span><br><span class=\"line\">  <span class=\"keyword\">int</span> cnt = <span class=\"number\">1</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (argc == <span class=\"number\">6</span>) &#123;</span><br><span class=\"line\">    cnt = <span class=\"built_in\">atoi</span>(argv[<span class=\"number\">5</span>]);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">unsigned</span> <span class=\"keyword\">int</span> seed = <span class=\"built_in\">atoi</span>(argv[<span class=\"number\">1</span>]);</span><br><span class=\"line\">  <span class=\"built_in\">srand</span>(seed);</span><br><span class=\"line\">  std::fstream fin;</span><br><span class=\"line\">  <span class=\"comment\">// std::cout &lt;&lt; &quot;1. Test; 2. Generate&quot; &lt;&lt; std::endl;</span></span><br><span class=\"line\">  <span class=\"keyword\">int</span> print_ = <span class=\"built_in\">atoi</span>(argv[<span class=\"number\">3</span>]);</span><br><span class=\"line\">  <span class=\"keyword\">int</span> overwrite = <span class=\"built_in\">atoi</span>(argv[<span class=\"number\">4</span>]);</span><br><span class=\"line\">  std::string file_name = argv[<span class=\"number\">2</span>];</span><br><span class=\"line\">  <span class=\"built_in\">INFO</span>(argc, argv);</span><br><span class=\"line\">  <span class=\"comment\">// while (1) &#123;</span></span><br><span class=\"line\">  <span class=\"comment\">//   scanf(&quot;%d&quot;, &amp;choose);</span></span><br><span class=\"line\">  <span class=\"comment\">//   if (choose == 2) &#123;</span></span><br><span class=\"line\">  <span class=\"comment\">//     file_name = &quot;id.txt&quot;;</span></span><br><span class=\"line\">  <span class=\"comment\">//     break;</span></span><br><span class=\"line\">  <span class=\"comment\">//   &#125; else if (choose == 1) &#123;</span></span><br><span class=\"line\">  <span class=\"comment\">//     file_name = &quot;id_for_print.txt&quot;;</span></span><br><span class=\"line\">  <span class=\"comment\">//     break;</span></span><br><span class=\"line\">  <span class=\"comment\">//   &#125; else &#123;</span></span><br><span class=\"line\">  <span class=\"comment\">//     std::cout &lt;&lt; &quot;Input error. Please try again.&quot; &lt;&lt; std::endl;</span></span><br><span class=\"line\">  <span class=\"comment\">//   &#125;</span></span><br><span class=\"line\">  <span class=\"comment\">// &#125;</span></span><br><span class=\"line\">  fin.<span class=\"built_in\">open</span>(file_name, std::ios::in);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!fin.<span class=\"built_in\">is_open</span>()) &#123;</span><br><span class=\"line\">    std::cerr &lt;&lt; <span class=\"string\">&quot;ERROR occured: id.txt opened failed!!!&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;id.txt opened succeed...&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"built_in\">initTable</span>(fin);</span><br><span class=\"line\">  <span class=\"comment\">// printTable();</span></span><br><span class=\"line\">  fin.<span class=\"built_in\">close</span>();</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;id.txt closed...&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">  <span class=\"keyword\">time_t</span> gen_begin = <span class=\"built_in\">clock</span>();</span><br><span class=\"line\">  <span class=\"built_in\">generateIDs</span>(fin, print_, overwrite, cnt);</span><br><span class=\"line\">  <span class=\"keyword\">time_t</span> process_end = <span class=\"built_in\">clock</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// #define CLOCKS_PER_SEC 1000</span></span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;ID generate cost: &quot;</span> &lt;&lt; ((<span class=\"keyword\">double</span>)(process_end - gen_begin) * <span class=\"number\">1000</span> / CLOCKS_PER_SEC) &lt;&lt; <span class=\"string\">&quot; ms;\\n&quot;</span>;</span><br><span class=\"line\">  std::cout &lt;&lt; <span class=\"string\">&quot;The whole process cost: &quot;</span> &lt;&lt; ((<span class=\"keyword\">double</span>)(process_end - <span class=\"keyword\">begin_t</span>) * <span class=\"number\">1000</span> / CLOCKS_PER_SEC) &lt;&lt; <span class=\"string\">&quot; ms.\\n&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"测试结果\">测试结果</h1>\r\n<p>编译运行 <code>bash_version.cc</code> ，运行</p>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">./bash_version 100 id.txt 0 1 100</span><br><span class=\"line\"><span class=\"comment\"># 100是指seed；id.txt是ID存储文件在id.txt中，0代表不打印，1代表写入文件，100代表生成1000个ID</span></span><br><span class=\"line\"><span class=\"comment\"># 输出文件默认为bash_out.txt，可以改变，也可以通过命令行传参的方式自定义输出文件路径。</span></span><br></pre></td></tr></table></figure>\r\n<p>结果为：</p>\r\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">*****************************************************************************</span><br><span class=\"line\">** INFO: .exe file is       : D:\\cppLearning\\IDCard\\bash_version.exe</span><br><span class=\"line\">** INFO: seed is            : 123</span><br><span class=\"line\">** INFO: id file is         : id.txt</span><br><span class=\"line\">** INFO: print/write or not : Not to print; To write</span><br><span class=\"line\">** INFO: The process will generate 100 ID(s). The output file is bash_out.txt.</span><br><span class=\"line\">*****************************************************************************</span><br><span class=\"line\"></span><br><span class=\"line\">id.txt opened succeed...</span><br><span class=\"line\">id.txt closed...</span><br><span class=\"line\">bash_out.txt opened succeed...</span><br><span class=\"line\">bash_out.txt closed...</span><br><span class=\"line\">ID generate cost: 7 ms;</span><br><span class=\"line\">The whole process cost: 10 ms.</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\r\n<p><code>bash_out.txt</code> 的内容为：</p>\r\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">1: 469030198601242653(海南省)</span><br><span class=\"line\">2: 640202199909187502(宁夏)</span><br><span class=\"line\">3: 33030019941115595X(浙江省)</span><br><span class=\"line\">4: 230882200011049668(黑龙江)</span><br><span class=\"line\">5: 520302199711125056(贵州省)</span><br><span class=\"line\">6: 371422198602121741(山东省)</span><br><span class=\"line\">7: 370704199605142158(山东省)</span><br><span class=\"line\">8: 530723199201027224(云南省)</span><br><span class=\"line\">9: 130225199502221494(河北省)</span><br><span class=\"line\">10: 211481198901054353(辽宁省)</span><br><span class=\"line\">11: 360829198811115480(江西省)</span><br><span class=\"line\">12: 500115198801202599(重庆市)</span><br><span class=\"line\">13: 441600199107138795(广东省)</span><br><span class=\"line\">14: 420526198605168048(湖北省)</span><br><span class=\"line\">15: 450300200306279101(广西)</span><br><span class=\"line\">16: 620802199511064261(甘肃省)</span><br><span class=\"line\">17: 120115200107158152(天津市)</span><br><span class=\"line\">18: 445321200209252462(广东省)</span><br><span class=\"line\">19: 120106200101251499(天津市)</span><br><span class=\"line\">20: 230205199705148846(黑龙江)</span><br><span class=\"line\">21: 32132320030411190X(江苏省)</span><br><span class=\"line\">22: 341021198810105603(安徽省)</span><br><span class=\"line\">23: 350428199708168482(福建省)</span><br><span class=\"line\">24: 361002199307285335(江西省)</span><br><span class=\"line\">25: 52052419931127684X(贵州省)</span><br><span class=\"line\">26: 340521200106124065(安徽省)</span><br><span class=\"line\">27: 430405198603135271(湖南省)</span><br><span class=\"line\">28: 220581199410161139(吉林省)</span><br><span class=\"line\">29: 220303198811253654(吉林省)</span><br><span class=\"line\">30: 433124200312019452(湖南省)</span><br><span class=\"line\">31: 340104199707198787(安徽省)</span><br><span class=\"line\">32: 420303199611052913(湖北省)</span><br><span class=\"line\">33: 310107199105245092(上海市)</span><br><span class=\"line\">34: 522326199807109803(贵州省)</span><br><span class=\"line\">35: 540528200110257196(西藏)</span><br><span class=\"line\">36: 371300200304059931(山东省)</span><br><span class=\"line\">37: 140224199412266029(山西省)</span><br><span class=\"line\">38: 440309199710040223(广东省)</span><br><span class=\"line\">39: 540237199409175595(西藏)</span><br><span class=\"line\">40: 370200199011259073(山东省)</span><br><span class=\"line\">41: 341022198612146494(安徽省)</span><br><span class=\"line\">42: 140824200004092371(山西省)</span><br><span class=\"line\">43: 522626198711125106(贵州省)</span><br><span class=\"line\">44: 350629199109052493(福建省)</span><br><span class=\"line\">45: 360124199306026692(江西省)</span><br><span class=\"line\">46: 540523199012277831(西藏)</span><br><span class=\"line\">47: 522700200206236018(贵州省)</span><br><span class=\"line\">48: 620300200202106849(甘肃省)</span><br><span class=\"line\">49: 532523198912193663(云南省)</span><br><span class=\"line\">50: 513424200007018644(四川省)</span><br><span class=\"line\">51: 610703200207180983(陕西省)</span><br><span class=\"line\">52: 231226200104095863(黑龙江)</span><br><span class=\"line\">53: 360281200107068775(江西省)</span><br><span class=\"line\">54: 450881199403193537(广西)</span><br><span class=\"line\">55: 36010320000821164X(江西省)</span><br><span class=\"line\">56: 430703200107011572(湖南省)</span><br><span class=\"line\">57: 640302199106155705(宁夏)</span><br><span class=\"line\">58: 231123200108041024(黑龙江)</span><br><span class=\"line\">59: 533323199211173058(云南省)</span><br><span class=\"line\">60: 610322199112102677(陕西省)</span><br><span class=\"line\">61: 510821199811187531(四川省)</span><br><span class=\"line\">62: 46010019880716061X(海南省)</span><br><span class=\"line\">63: 22010320000626830X(吉林省)</span><br><span class=\"line\">64: 532524198705108370(云南省)</span><br><span class=\"line\">65: 430511199511044230(湖南省)</span><br><span class=\"line\">66: 41152719970126411X(河南省)</span><br><span class=\"line\">67: 469003199011211801(海南省)</span><br><span class=\"line\">68: 532526199909268744(云南省)</span><br><span class=\"line\">69: 621021199704106399(甘肃省)</span><br><span class=\"line\">70: 350624199903259457(福建省)</span><br><span class=\"line\">71: 13053219940816047X(河北省)</span><br><span class=\"line\">72: 469002199802285077(海南省)</span><br><span class=\"line\">73: 410222198805190019(河南省)</span><br><span class=\"line\">74: 341821200202018497(安徽省)</span><br><span class=\"line\">75: 152523199606074328(内蒙古)</span><br><span class=\"line\">76: 610603200208282863(陕西省)</span><br><span class=\"line\">77: 440114199506159032(广东省)</span><br><span class=\"line\">78: 640400199503258209(宁夏)</span><br><span class=\"line\">79: 140602199708081895(山西省)</span><br><span class=\"line\">80: 520522200102217336(贵州省)</span><br><span class=\"line\">81: 450202199703249776(广西)</span><br><span class=\"line\">82: 445102199506217334(广东省)</span><br><span class=\"line\">83: 52033019971108806X(贵州省)</span><br><span class=\"line\">84: 360826199907272793(江西省)</span><br><span class=\"line\">85: 500103200208063043(重庆市)</span><br><span class=\"line\">86: 42102319860426485X(湖北省)</span><br><span class=\"line\">87: 640100198801153041(宁夏)</span><br><span class=\"line\">88: 610629200004259323(陕西省)</span><br><span class=\"line\">89: 22040019910420749X(吉林省)</span><br><span class=\"line\">90: 52030019990204087X(贵州省)</span><br><span class=\"line\">91: 230208198901195169(黑龙江)</span><br><span class=\"line\">92: 150421198602078036(内蒙古)</span><br><span class=\"line\">93: 320581199304056654(江苏省)</span><br><span class=\"line\">94: 440306199802251635(广东省)</span><br><span class=\"line\">95: 15072720001117942X(内蒙古)</span><br><span class=\"line\">96: 320305200003195739(江苏省)</span><br><span class=\"line\">97: 410185199912181163(河南省)</span><br><span class=\"line\">98: 469030199308137736(海南省)</span><br><span class=\"line\">99: 220211199006179200(吉林省)</span><br><span class=\"line\">100: 330502199002022092(浙江省)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\r\n","categories":["others"],"tags":["cpp"]}]